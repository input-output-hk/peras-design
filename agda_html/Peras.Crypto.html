<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Peras.Crypto</title><link rel="stylesheet" href="Agda.css"></head><body><pre class="Agda"><a id="1" class="Comment">-- | Cryptographic primitives types and functions used to implement /Peras/ protocol.</a>
<a id="87" class="Comment">--</a>
<a id="90" class="Comment">-- We don&#39;t use real cryptography here, just a bunch of newtypes and</a>
<a id="159" class="Comment">-- simple functions that represent various cryptographic operations</a>
<a id="227" class="Comment">-- one can do when running the protocol</a>
<a id="267" class="Keyword">module</a> <a id="274" href="Peras.Crypto.html" class="Module">Peras.Crypto</a> <a id="287" class="Keyword">where</a>

<a id="294" class="Keyword">open</a> <a id="299" class="Keyword">import</a> <a id="306" href="Agda.Builtin.Equality.html" class="Module">Agda.Builtin.Equality</a> <a id="328" class="Keyword">using</a> <a id="334" class="Symbol">(</a><a id="335" href="Agda.Builtin.Equality.html#150" class="Datatype Operator">_≡_</a><a id="338" class="Symbol">;</a> <a id="340" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a><a id="344" class="Symbol">)</a>
<a id="346" class="Keyword">open</a> <a id="351" class="Keyword">import</a> <a id="358" href="Data.Bool.html" class="Module">Data.Bool</a> <a id="368" class="Keyword">using</a> <a id="374" class="Symbol">(</a><a id="375" href="Agda.Builtin.Bool.html#173" class="Datatype">Bool</a><a id="379" class="Symbol">;</a> <a id="381" href="Agda.Builtin.Bool.html#198" class="InductiveConstructor">true</a><a id="385" class="Symbol">)</a>
<a id="387" class="Keyword">open</a> <a id="392" class="Keyword">import</a> <a id="399" href="Haskell.Prelude.html" class="Module">Haskell.Prelude</a> <a id="415" class="Keyword">using</a> <a id="421" class="Symbol">(</a><a id="422" href="Haskell.Prim.Eq.html#401" class="Record">Eq</a><a id="424" class="Symbol">;</a> <a id="426" href="Haskell.Prim.Int.html#367" class="Datatype">Int</a><a id="429" class="Symbol">;</a> <a id="431" href="Haskell.Prim.Eq.html#453" class="Field Operator">_==_</a><a id="435" class="Symbol">;</a> <a id="437" href="Haskell.Prim.Ord.html#1003" class="Record">Ord</a><a id="440" class="Symbol">;</a> <a id="442" href="Haskell.Prim.Ord.html#1041" class="Field">compare</a> <a id="450" class="Symbol">;</a> <a id="452" href="Haskell.Prim.Ord.html#466" class="Datatype">Ordering</a> <a id="461" class="Symbol">;</a> <a id="463" href="Haskell.Prim.Ord.html#1332" class="Function">ordFromCompare</a><a id="477" class="Symbol">)</a>
<a id="479" class="Keyword">open</a> <a id="484" class="Keyword">import</a> <a id="491" href="Relation.Binary.html" class="Module">Relation.Binary</a> <a id="507" class="Keyword">using</a> <a id="513" class="Symbol">(</a><a id="514" href="Relation.Binary.Definitions.html#6469" class="Function">DecidableEquality</a><a id="531" class="Symbol">)</a>
<a id="533" class="Keyword">open</a> <a id="538" class="Keyword">import</a> <a id="545" href="Relation.Binary.html" class="Module">Relation.Binary</a> <a id="561" class="Keyword">using</a> <a id="567" class="Symbol">(</a><a id="568" href="Relation.Binary.Bundles.html#8031" class="Record">StrictTotalOrder</a><a id="584" class="Symbol">)</a>

<a id="587" class="Comment">-- The following implementations are supplied in Haskell.</a>
<a id="645" class="Keyword">postulate</a>
  <a id="ByteString"></a><a id="657" href="Peras.Crypto.html#657" class="Postulate">ByteString</a> <a id="668" class="Symbol">:</a> <a id="670" href="Agda.Primitive.html#388" class="Primitive">Set</a>
  <a id="emptyBS"></a><a id="676" href="Peras.Crypto.html#676" class="Postulate">emptyBS</a> <a id="684" class="Symbol">:</a> <a id="686" href="Peras.Crypto.html#657" class="Postulate">ByteString</a>
  <a id="eqBS"></a><a id="699" href="Peras.Crypto.html#699" class="Postulate">eqBS</a> <a id="704" class="Symbol">:</a> <a id="706" href="Peras.Crypto.html#657" class="Postulate">ByteString</a> <a id="717" class="Symbol">→</a> <a id="719" href="Peras.Crypto.html#657" class="Postulate">ByteString</a> <a id="730" class="Symbol">→</a> <a id="732" href="Agda.Builtin.Bool.html#173" class="Datatype">Bool</a>
  <a id="_isInfixOf_"></a><a id="739" href="Peras.Crypto.html#739" class="Postulate Operator">_isInfixOf_</a> <a id="751" class="Symbol">:</a> <a id="753" href="Peras.Crypto.html#657" class="Postulate">ByteString</a> <a id="764" class="Symbol">→</a> <a id="766" href="Peras.Crypto.html#657" class="Postulate">ByteString</a> <a id="777" class="Symbol">→</a> <a id="779" href="Agda.Builtin.Bool.html#173" class="Datatype">Bool</a>
  <a id="replicateBS"></a><a id="786" href="Peras.Crypto.html#786" class="Postulate">replicateBS</a> <a id="798" class="Symbol">:</a> <a id="800" href="Haskell.Prim.Int.html#367" class="Datatype">Int</a> <a id="804" class="Symbol">→</a> <a id="806" href="Haskell.Prim.Int.html#367" class="Datatype">Int</a> <a id="810" class="Symbol">→</a> <a id="812" href="Peras.Crypto.html#657" class="Postulate">ByteString</a>
  <a id="_≟-BS_"></a><a id="825" href="Peras.Crypto.html#825" class="Postulate Operator">_≟-BS_</a> <a id="832" class="Symbol">:</a> <a id="834" href="Relation.Binary.Definitions.html#6469" class="Function">DecidableEquality</a> <a id="852" href="Peras.Crypto.html#657" class="Postulate">ByteString</a>
  <a id="compare-BS"></a><a id="865" href="Peras.Crypto.html#865" class="Postulate">compare-BS</a> <a id="876" class="Symbol">:</a> <a id="878" href="Peras.Crypto.html#657" class="Postulate">ByteString</a> <a id="889" class="Symbol">→</a> <a id="891" href="Peras.Crypto.html#657" class="Postulate">ByteString</a> <a id="902" class="Symbol">→</a> <a id="904" href="Haskell.Prim.Ord.html#466" class="Datatype">Ordering</a>

  <a id="lem-eqBS"></a><a id="916" href="Peras.Crypto.html#916" class="Postulate">lem-eqBS</a> <a id="925" class="Symbol">:</a> <a id="927" class="Symbol">∀</a> <a id="929" class="Symbol">{</a><a id="930" href="Peras.Crypto.html#930" class="Bound">b₁</a> <a id="933" href="Peras.Crypto.html#933" class="Bound">b₂</a><a id="935" class="Symbol">}</a> <a id="937" class="Symbol">→</a> <a id="939" href="Peras.Crypto.html#699" class="Postulate">eqBS</a> <a id="944" href="Peras.Crypto.html#930" class="Bound">b₁</a> <a id="947" href="Peras.Crypto.html#933" class="Bound">b₂</a> <a id="950" href="Agda.Builtin.Equality.html#150" class="Datatype Operator">≡</a> <a id="952" href="Agda.Builtin.Bool.html#198" class="InductiveConstructor">true</a> <a id="957" class="Symbol">→</a> <a id="959" href="Peras.Crypto.html#930" class="Bound">b₁</a> <a id="962" href="Agda.Builtin.Equality.html#150" class="Datatype Operator">≡</a> <a id="964" href="Peras.Crypto.html#933" class="Bound">b₂</a>

<a id="968" class="Symbol">{-#</a> <a id="972" class="Keyword">FOREIGN</a> <a id="980" class="Pragma">AGDA2HS</a>
<a id="988" class="Symbol">{-#</a> <a id="992" class="Pragma">LANGUAGE</a> <a id="1001" class="Pragma">DeriveGeneric</a> <a id="1015" class="Symbol">#-}</a>
<a id="1019" class="Symbol">{-#</a> <a id="1023" class="Pragma">OPTIONS_GHC</a> <a id="1035" class="Pragma">-fno-warn-missing-pattern-synonym-signatures</a> <a id="1080" class="Symbol">#-}</a>
<a id="1084" class="Symbol">{-#</a> <a id="1088" class="Pragma">OPTIONS_GHC</a> <a id="1100" class="Pragma">-fno-warn-missing-signatures</a> <a id="1129" class="Symbol">#-}</a>
<a id="1133" class="Symbol">{-#</a> <a id="1137" class="Pragma">OPTIONS_GHC</a> <a id="1149" class="Pragma">-fno-warn-name-shadowing</a> <a id="1174" class="Symbol">#-}</a>
<a id="1178" class="Symbol">{-#</a> <a id="1182" class="Pragma">OPTIONS_GHC</a> <a id="1194" class="Pragma">-fno-warn-type-defaults</a> <a id="1218" class="Symbol">#-}</a>
<a id="1222" class="Symbol">{-#</a> <a id="1226" class="Pragma">OPTIONS_GHC</a> <a id="1238" class="Pragma">-fno-warn-unused-imports</a> <a id="1263" class="Symbol">#-}</a>
<a id="1267" class="Symbol">{-#</a> <a id="1271" class="Pragma">OPTIONS_GHC</a> <a id="1283" class="Pragma">-fno-warn-unused-matches</a> <a id="1308" class="Symbol">#-}</a>
<a id="1312" class="Pragma">import</a> <a id="1319" class="Pragma">Data.ByteString</a> <a id="1335" class="Pragma">as</a> <a id="1338" class="Pragma">BS</a>
<a id="1341" class="Pragma">import</a> <a id="1348" class="Pragma">Data.Word</a> <a id="1358" class="Pragma">(Word8)</a>
<a id="1366" class="Pragma">import</a> <a id="1373" class="Pragma">GHC.Generics</a> <a id="1386" class="Pragma">(Generic)</a>
<a id="1396" class="Pragma">eqBS</a> <a id="1401" class="Pragma">::</a> <a id="1404" class="Pragma">ByteString</a> <a id="1415" class="Pragma">-&gt;</a> <a id="1418" class="Pragma">ByteString</a> <a id="1429" class="Pragma">-&gt;</a> <a id="1432" class="Pragma">Bool</a>
<a id="1437" class="Pragma">eqBS</a> <a id="1442" class="Pragma">=</a> <a id="1444" class="Pragma">(==)</a>
<a id="1449" class="Pragma">replicateBS</a> <a id="1461" class="Pragma">::</a> <a id="1464" class="Pragma">Int</a> <a id="1468" class="Pragma">-&gt;</a> <a id="1471" class="Pragma">Word8</a> <a id="1477" class="Pragma">-&gt;</a> <a id="1480" class="Pragma">ByteString</a>
<a id="1491" class="Pragma">replicateBS</a> <a id="1503" class="Pragma">=</a> <a id="1505" class="Pragma">BS.replicate</a>
<a id="1518" class="Pragma">emptyBS</a> <a id="1526" class="Pragma">::</a> <a id="1529" class="Pragma">ByteString</a>
<a id="1540" class="Pragma">emptyBS</a> <a id="1548" class="Pragma">=</a> <a id="1550" class="Pragma">mempty</a>
<a id="1557" class="Symbol">#-}</a>

<a id="1562" class="Symbol">{-#</a> <a id="1566" class="Keyword">FOREIGN</a> <a id="1574" class="Pragma">GHC</a>
<a id="1578" class="Pragma">import</a> <a id="1585" class="Pragma">qualified</a> <a id="1595" class="Pragma">Data.ByteString</a> <a id="1611" class="Pragma">as</a> <a id="1614" class="Pragma">BS</a>
<a id="1617" class="Pragma">import</a> <a id="1624" class="Pragma">qualified</a> <a id="1634" class="Pragma">Peras.Crypto</a> <a id="1647" class="Pragma">as</a> <a id="1650" class="Pragma">G</a>
<a id="1652" class="Symbol">#-}</a>

<a id="1657" class="Symbol">{-#</a> <a id="1661" class="Keyword">COMPILE</a> <a id="1669" class="Keyword">GHC</a> <a id="1673" href="Peras.Crypto.html#657" class="Postulate">ByteString</a> <a id="1684" class="Pragma">=</a> <a id="1686" class="Pragma">type</a> <a id="1691" class="Pragma">BS.ByteString</a> <a id="1705" class="Symbol">#-}</a>
<a id="1709" class="Symbol">{-#</a> <a id="1713" class="Keyword">COMPILE</a> <a id="1721" class="Keyword">GHC</a> <a id="1725" href="Peras.Crypto.html#676" class="Postulate">emptyBS</a> <a id="1733" class="Pragma">=</a> <a id="1735" class="Pragma">BS.empty</a> <a id="1744" class="Symbol">#-}</a>
<a id="1748" class="Symbol">{-#</a> <a id="1752" class="Keyword">COMPILE</a> <a id="1760" class="Keyword">GHC</a> <a id="1764" href="Peras.Crypto.html#699" class="Postulate">eqBS</a> <a id="1769" class="Pragma">=</a> <a id="1771" class="Pragma">(==)</a> <a id="1776" class="Symbol">#-}</a>
<a id="1780" class="Symbol">{-#</a> <a id="1784" class="Keyword">COMPILE</a> <a id="1792" class="Keyword">GHC</a> <a id="1796" href="Peras.Crypto.html#739" class="Postulate Operator">_isInfixOf_</a> <a id="1808" class="Pragma">=</a> <a id="1810" class="Pragma">BS.isInfixOf</a> <a id="1823" class="Symbol">#-}</a>

<a id="1828" class="Keyword">record</a> <a id="Hash"></a><a id="1835" href="Peras.Crypto.html#1835" class="Record">Hash</a> <a id="1840" class="Symbol">(</a><a id="1841" href="Peras.Crypto.html#1841" class="Bound">a</a> <a id="1843" class="Symbol">:</a> <a id="1845" href="Agda.Primitive.html#388" class="Primitive">Set</a><a id="1848" class="Symbol">)</a> <a id="1850" class="Symbol">:</a> <a id="1852" href="Agda.Primitive.html#388" class="Primitive">Set</a> <a id="1856" class="Keyword">where</a>
  <a id="1864" class="Keyword">constructor</a> <a id="MkHash"></a><a id="1876" href="Peras.Crypto.html#1876" class="InductiveConstructor">MkHash</a>
  <a id="1885" class="Keyword">field</a> <a id="Hash.hashBytes"></a><a id="1891" href="Peras.Crypto.html#1891" class="Field">hashBytes</a> <a id="1901" class="Symbol">:</a> <a id="1903" href="Peras.Crypto.html#657" class="Postulate">ByteString</a>

<a id="1915" class="Keyword">open</a> <a id="1920" href="Peras.Crypto.html#1835" class="Module">Hash</a> <a id="1925" class="Keyword">public</a>

<a id="1933" class="Symbol">{-#</a> <a id="1937" class="Keyword">COMPILE</a> <a id="1945" class="Keyword">AGDA2HS</a> <a id="1953" href="Peras.Crypto.html#1835" class="Record">Hash</a> <a id="1958" class="Pragma">newtype</a> <a id="1966" class="Pragma">deriving</a> <a id="1975" class="Pragma">(Generic)</a> <a id="1985" class="Symbol">#-}</a>
<a id="1989" class="Symbol">{-#</a> <a id="1993" class="Keyword">COMPILE</a> <a id="2001" class="Keyword">GHC</a> <a id="2005" href="Peras.Crypto.html#1835" class="Record">Hash</a> <a id="2010" class="Pragma">=</a> <a id="2012" class="Pragma">data</a> <a id="2017" class="Pragma">G.Hash</a> <a id="2024" class="Pragma">(G.MkHash)</a> <a id="2035" class="Symbol">#-}</a>

<a id="MkHash-inj"></a><a id="2040" href="Peras.Crypto.html#2040" class="Function">MkHash-inj</a> <a id="2051" class="Symbol">:</a> <a id="2053" class="Symbol">∀</a> <a id="2055" class="Symbol">{</a><a id="2056" href="Peras.Crypto.html#2056" class="Bound">a</a> <a id="2058" class="Symbol">:</a> <a id="2060" href="Agda.Primitive.html#388" class="Primitive">Set</a><a id="2063" class="Symbol">}</a> <a id="2065" class="Symbol">{</a><a id="2066" href="Peras.Crypto.html#2066" class="Bound">b₁</a> <a id="2069" href="Peras.Crypto.html#2069" class="Bound">b₂</a> <a id="2072" class="Symbol">:</a> <a id="2074" href="Peras.Crypto.html#1835" class="Record">Hash</a> <a id="2079" href="Peras.Crypto.html#2056" class="Bound">a</a><a id="2080" class="Symbol">}</a> <a id="2082" class="Symbol">→</a> <a id="2084" href="Peras.Crypto.html#1891" class="Field">hashBytes</a> <a id="2094" href="Peras.Crypto.html#2066" class="Bound">b₁</a> <a id="2097" href="Agda.Builtin.Equality.html#150" class="Datatype Operator">≡</a> <a id="2099" href="Peras.Crypto.html#1891" class="Field">hashBytes</a> <a id="2109" href="Peras.Crypto.html#2069" class="Bound">b₂</a> <a id="2112" class="Symbol">→</a> <a id="2114" href="Peras.Crypto.html#2066" class="Bound">b₁</a> <a id="2117" href="Agda.Builtin.Equality.html#150" class="Datatype Operator">≡</a> <a id="2119" href="Peras.Crypto.html#2069" class="Bound">b₂</a>
<a id="2122" href="Peras.Crypto.html#2040" class="Function">MkHash-inj</a> <a id="2133" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a> <a id="2138" class="Symbol">=</a> <a id="2140" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a>

<a id="2146" class="Keyword">instance</a>
  <a id="iHashEq"></a><a id="2157" href="Peras.Crypto.html#2157" class="Function">iHashEq</a> <a id="2165" class="Symbol">:</a> <a id="2167" class="Symbol">{</a><a id="2168" href="Peras.Crypto.html#2168" class="Bound">a</a> <a id="2170" class="Symbol">:</a> <a id="2172" href="Agda.Primitive.html#388" class="Primitive">Set</a><a id="2175" class="Symbol">}</a> <a id="2177" class="Symbol">→</a> <a id="2179" href="Haskell.Prim.Eq.html#401" class="Record">Eq</a> <a id="2182" class="Symbol">(</a><a id="2183" href="Peras.Crypto.html#1835" class="Record">Hash</a> <a id="2188" href="Peras.Crypto.html#2168" class="Bound">a</a><a id="2189" class="Symbol">)</a>
  <a id="2193" href="Peras.Crypto.html#2157" class="Function">iHashEq</a> <a id="2201" class="Symbol">.</a><a id="2202" href="Haskell.Prim.Eq.html#453" class="Field Operator">_==_</a> <a id="2207" href="Peras.Crypto.html#2207" class="Bound">x</a> <a id="2209" href="Peras.Crypto.html#2209" class="Bound">y</a> <a id="2211" class="Symbol">=</a> <a id="2213" href="Peras.Crypto.html#699" class="Postulate">eqBS</a> <a id="2218" class="Symbol">(</a><a id="2219" href="Peras.Crypto.html#1891" class="Field">hashBytes</a> <a id="2229" href="Peras.Crypto.html#2207" class="Bound">x</a><a id="2230" class="Symbol">)</a> <a id="2232" class="Symbol">(</a><a id="2233" href="Peras.Crypto.html#1891" class="Field">hashBytes</a> <a id="2243" href="Peras.Crypto.html#2209" class="Bound">y</a><a id="2244" class="Symbol">)</a>

<a id="2247" class="Symbol">{-#</a> <a id="2251" class="Keyword">COMPILE</a> <a id="2259" class="Keyword">AGDA2HS</a> <a id="2267" href="Peras.Crypto.html#2157" class="Function">iHashEq</a> <a id="2275" class="Symbol">#-}</a>

<a id="2280" class="Keyword">record</a> <a id="Hashable"></a><a id="2287" href="Peras.Crypto.html#2287" class="Record">Hashable</a> <a id="2296" class="Symbol">(</a><a id="2297" href="Peras.Crypto.html#2297" class="Bound">a</a> <a id="2299" class="Symbol">:</a> <a id="2301" href="Agda.Primitive.html#388" class="Primitive">Set</a><a id="2304" class="Symbol">)</a> <a id="2306" class="Symbol">:</a> <a id="2308" href="Agda.Primitive.html#388" class="Primitive">Set</a> <a id="2312" class="Keyword">where</a>
  <a id="2320" class="Keyword">field</a> <a id="Hashable.hash"></a><a id="2326" href="Peras.Crypto.html#2326" class="Field">hash</a> <a id="2331" class="Symbol">:</a> <a id="2333" href="Peras.Crypto.html#2297" class="Bound">a</a> <a id="2335" class="Symbol">→</a> <a id="2337" href="Peras.Crypto.html#1835" class="Record">Hash</a> <a id="2342" href="Peras.Crypto.html#2297" class="Bound">a</a>

<a id="2345" class="Symbol">{-#</a> <a id="2349" class="Keyword">COMPILE</a> <a id="2357" class="Keyword">AGDA2HS</a> <a id="2365" href="Peras.Crypto.html#2287" class="Record">Hashable</a> <a id="2374" class="Pragma">class</a> <a id="2380" class="Symbol">#-}</a>

<a id="2385" class="Comment">-- should use normal VRF algorithm like leadership membership</a>
<a id="2447" class="Keyword">record</a> <a id="MembershipProof"></a><a id="2454" href="Peras.Crypto.html#2454" class="Record">MembershipProof</a> <a id="2470" class="Symbol">:</a> <a id="2472" href="Agda.Primitive.html#388" class="Primitive">Set</a> <a id="2476" class="Keyword">where</a>
  <a id="2484" class="Keyword">constructor</a> <a id="MkMembershipProof"></a><a id="2496" href="Peras.Crypto.html#2496" class="InductiveConstructor">MkMembershipProof</a>
  <a id="2516" class="Keyword">field</a> <a id="MembershipProof.proofM"></a><a id="2522" href="Peras.Crypto.html#2522" class="Field">proofM</a> <a id="2529" class="Symbol">:</a> <a id="2531" href="Peras.Crypto.html#657" class="Postulate">ByteString</a>

<a id="2543" class="Keyword">open</a> <a id="2548" href="Peras.Crypto.html#2454" class="Module">MembershipProof</a> <a id="2564" class="Keyword">public</a>

<a id="2572" class="Symbol">{-#</a> <a id="2576" class="Keyword">COMPILE</a> <a id="2584" class="Keyword">AGDA2HS</a> <a id="2592" href="Peras.Crypto.html#2454" class="Record">MembershipProof</a> <a id="2608" class="Pragma">newtype</a> <a id="2616" class="Pragma">deriving</a> <a id="2625" class="Pragma">(Generic)</a> <a id="2635" class="Symbol">#-}</a>
<a id="2639" class="Symbol">{-#</a> <a id="2643" class="Keyword">COMPILE</a> <a id="2651" class="Keyword">GHC</a> <a id="2655" href="Peras.Crypto.html#2454" class="Record">MembershipProof</a> <a id="2671" class="Pragma">=</a> <a id="2673" class="Pragma">data</a> <a id="2678" class="Pragma">G.MembershipProof</a> <a id="2696" class="Pragma">(G.MkMembershipProof)</a> <a id="2718" class="Symbol">#-}</a>

<a id="2723" class="Keyword">instance</a>
  <a id="iMembershipProofEq"></a><a id="2734" href="Peras.Crypto.html#2734" class="Function">iMembershipProofEq</a> <a id="2753" class="Symbol">:</a> <a id="2755" href="Haskell.Prim.Eq.html#401" class="Record">Eq</a> <a id="2758" href="Peras.Crypto.html#2454" class="Record">MembershipProof</a>
  <a id="2776" href="Peras.Crypto.html#2734" class="Function">iMembershipProofEq</a> <a id="2795" class="Symbol">.</a><a id="2796" href="Haskell.Prim.Eq.html#453" class="Field Operator">_==_</a> <a id="2801" href="Peras.Crypto.html#2801" class="Bound">x</a> <a id="2803" href="Peras.Crypto.html#2803" class="Bound">y</a> <a id="2805" class="Symbol">=</a> <a id="2807" href="Peras.Crypto.html#699" class="Postulate">eqBS</a> <a id="2812" class="Symbol">(</a><a id="2813" href="Peras.Crypto.html#2522" class="Field">proofM</a> <a id="2820" href="Peras.Crypto.html#2801" class="Bound">x</a><a id="2821" class="Symbol">)</a> <a id="2823" class="Symbol">(</a><a id="2824" href="Peras.Crypto.html#2522" class="Field">proofM</a> <a id="2831" href="Peras.Crypto.html#2803" class="Bound">y</a><a id="2832" class="Symbol">)</a>

<a id="2835" class="Symbol">{-#</a> <a id="2839" class="Keyword">COMPILE</a> <a id="2847" class="Keyword">AGDA2HS</a> <a id="2855" href="Peras.Crypto.html#2734" class="Function">iMembershipProofEq</a> <a id="2874" class="Symbol">#-}</a>

<a id="2879" class="Keyword">record</a> <a id="LeadershipProof"></a><a id="2886" href="Peras.Crypto.html#2886" class="Record">LeadershipProof</a> <a id="2902" class="Symbol">:</a> <a id="2904" href="Agda.Primitive.html#388" class="Primitive">Set</a> <a id="2908" class="Keyword">where</a>
  <a id="2916" class="Keyword">constructor</a> <a id="MkLeadershipProof"></a><a id="2928" href="Peras.Crypto.html#2928" class="InductiveConstructor">MkLeadershipProof</a>
  <a id="2948" class="Keyword">field</a> <a id="LeadershipProof.proofL"></a><a id="2954" href="Peras.Crypto.html#2954" class="Field">proofL</a> <a id="2961" class="Symbol">:</a> <a id="2963" href="Peras.Crypto.html#657" class="Postulate">ByteString</a>

<a id="2975" class="Keyword">open</a> <a id="2980" href="Peras.Crypto.html#2886" class="Module">LeadershipProof</a> <a id="2996" class="Keyword">public</a>

<a id="3004" class="Symbol">{-#</a> <a id="3008" class="Keyword">COMPILE</a> <a id="3016" class="Keyword">AGDA2HS</a> <a id="3024" href="Peras.Crypto.html#2886" class="Record">LeadershipProof</a> <a id="3040" class="Pragma">newtype</a> <a id="3048" class="Pragma">deriving</a> <a id="3057" class="Pragma">(Generic)</a> <a id="3067" class="Symbol">#-}</a>
<a id="3071" class="Symbol">{-#</a> <a id="3075" class="Keyword">COMPILE</a> <a id="3083" class="Keyword">GHC</a> <a id="3087" href="Peras.Crypto.html#2886" class="Record">LeadershipProof</a> <a id="3103" class="Pragma">=</a> <a id="3105" class="Pragma">data</a> <a id="3110" class="Pragma">G.LeadershipProof</a> <a id="3128" class="Pragma">(G.MkLeadershipProof)</a> <a id="3150" class="Symbol">#-}</a>

<a id="3155" class="Keyword">instance</a>
  <a id="iLeadershipProofEq"></a><a id="3166" href="Peras.Crypto.html#3166" class="Function">iLeadershipProofEq</a> <a id="3185" class="Symbol">:</a> <a id="3187" href="Haskell.Prim.Eq.html#401" class="Record">Eq</a> <a id="3190" href="Peras.Crypto.html#2886" class="Record">LeadershipProof</a>
  <a id="3208" href="Peras.Crypto.html#3166" class="Function">iLeadershipProofEq</a> <a id="3227" class="Symbol">.</a><a id="3228" href="Haskell.Prim.Eq.html#453" class="Field Operator">_==_</a> <a id="3233" href="Peras.Crypto.html#3233" class="Bound">x</a> <a id="3235" href="Peras.Crypto.html#3235" class="Bound">y</a> <a id="3237" class="Symbol">=</a> <a id="3239" href="Peras.Crypto.html#699" class="Postulate">eqBS</a> <a id="3244" class="Symbol">(</a><a id="3245" href="Peras.Crypto.html#2954" class="Field">proofL</a> <a id="3252" href="Peras.Crypto.html#3233" class="Bound">x</a><a id="3253" class="Symbol">)</a> <a id="3255" class="Symbol">(</a><a id="3256" href="Peras.Crypto.html#2954" class="Field">proofL</a> <a id="3263" href="Peras.Crypto.html#3235" class="Bound">y</a><a id="3264" class="Symbol">)</a>

<a id="3267" class="Symbol">{-#</a> <a id="3271" class="Keyword">COMPILE</a> <a id="3279" class="Keyword">AGDA2HS</a> <a id="3287" href="Peras.Crypto.html#3166" class="Function">iLeadershipProofEq</a> <a id="3306" class="Symbol">#-}</a>

<a id="3311" class="Comment">{-
-- use KES-based signatures which weighs about 600 bytes (could be
-- down to 400)
-}</a>

<a id="3401" class="Keyword">record</a> <a id="Signature"></a><a id="3408" href="Peras.Crypto.html#3408" class="Record">Signature</a> <a id="3418" class="Symbol">:</a> <a id="3420" href="Agda.Primitive.html#388" class="Primitive">Set</a> <a id="3424" class="Keyword">where</a>
  <a id="3432" class="Keyword">constructor</a> <a id="MkSignature"></a><a id="3444" href="Peras.Crypto.html#3444" class="InductiveConstructor">MkSignature</a>
  <a id="3458" class="Keyword">field</a> <a id="Signature.bytesS"></a><a id="3464" href="Peras.Crypto.html#3464" class="Field">bytesS</a> <a id="3471" class="Symbol">:</a> <a id="3473" href="Peras.Crypto.html#657" class="Postulate">ByteString</a>

<a id="3485" class="Keyword">open</a> <a id="3490" href="Peras.Crypto.html#3408" class="Module">Signature</a> <a id="3500" class="Keyword">public</a>

<a id="3508" class="Symbol">{-#</a> <a id="3512" class="Keyword">COMPILE</a> <a id="3520" class="Keyword">AGDA2HS</a> <a id="3528" href="Peras.Crypto.html#3408" class="Record">Signature</a> <a id="3538" class="Pragma">newtype</a> <a id="3546" class="Pragma">deriving</a> <a id="3555" class="Pragma">(Generic)</a> <a id="3565" class="Symbol">#-}</a>
<a id="3569" class="Symbol">{-#</a> <a id="3573" class="Keyword">COMPILE</a> <a id="3581" class="Keyword">GHC</a> <a id="3585" href="Peras.Crypto.html#3408" class="Record">Signature</a> <a id="3595" class="Pragma">=</a> <a id="3597" class="Pragma">data</a> <a id="3602" class="Pragma">G.Signature</a> <a id="3614" class="Pragma">(G.MkSignature)</a> <a id="3630" class="Symbol">#-}</a>

<a id="compareSignature"></a><a id="3635" href="Peras.Crypto.html#3635" class="Function">compareSignature</a> <a id="3652" class="Symbol">:</a> <a id="3654" href="Peras.Crypto.html#3408" class="Record">Signature</a> <a id="3664" class="Symbol">-&gt;</a> <a id="3667" href="Peras.Crypto.html#3408" class="Record">Signature</a> <a id="3677" class="Symbol">-&gt;</a> <a id="3680" href="Haskell.Prim.Ord.html#466" class="Datatype">Ordering</a>
<a id="3689" href="Peras.Crypto.html#3635" class="Function">compareSignature</a> <a id="3706" href="Peras.Crypto.html#3706" class="Bound">x</a> <a id="3708" href="Peras.Crypto.html#3708" class="Bound">y</a> <a id="3710" class="Symbol">=</a> <a id="3712" href="Peras.Crypto.html#865" class="Postulate">compare-BS</a> <a id="3723" class="Symbol">(</a><a id="3724" href="Peras.Crypto.html#3464" class="Field">bytesS</a> <a id="3731" href="Peras.Crypto.html#3706" class="Bound">x</a><a id="3732" class="Symbol">)</a> <a id="3734" class="Symbol">(</a><a id="3735" href="Peras.Crypto.html#3464" class="Field">bytesS</a> <a id="3742" href="Peras.Crypto.html#3708" class="Bound">y</a><a id="3743" class="Symbol">)</a>

<a id="3746" class="Keyword">instance</a>
  <a id="iSignatureEq"></a><a id="3757" href="Peras.Crypto.html#3757" class="Function">iSignatureEq</a> <a id="3770" class="Symbol">:</a> <a id="3772" href="Haskell.Prim.Eq.html#401" class="Record">Eq</a> <a id="3775" href="Peras.Crypto.html#3408" class="Record">Signature</a>
  <a id="3787" href="Peras.Crypto.html#3757" class="Function">iSignatureEq</a> <a id="3800" class="Symbol">.</a><a id="3801" href="Haskell.Prim.Eq.html#453" class="Field Operator">_==_</a> <a id="3806" href="Peras.Crypto.html#3806" class="Bound">x</a> <a id="3808" href="Peras.Crypto.html#3808" class="Bound">y</a> <a id="3810" class="Symbol">=</a> <a id="3812" href="Peras.Crypto.html#699" class="Postulate">eqBS</a> <a id="3817" class="Symbol">(</a><a id="3818" href="Peras.Crypto.html#3464" class="Field">bytesS</a> <a id="3825" href="Peras.Crypto.html#3806" class="Bound">x</a><a id="3826" class="Symbol">)</a> <a id="3828" class="Symbol">(</a><a id="3829" href="Peras.Crypto.html#3464" class="Field">bytesS</a> <a id="3836" href="Peras.Crypto.html#3808" class="Bound">y</a><a id="3837" class="Symbol">)</a>

  <a id="iSignatureOrd"></a><a id="3842" href="Peras.Crypto.html#3842" class="Function">iSignatureOrd</a> <a id="3856" class="Symbol">:</a> <a id="3858" href="Haskell.Prim.Ord.html#1003" class="Record">Ord</a> <a id="3862" href="Peras.Crypto.html#3408" class="Record">Signature</a>
  <a id="3874" href="Peras.Crypto.html#3842" class="Function">iSignatureOrd</a> <a id="3888" class="Symbol">=</a> <a id="3890" href="Haskell.Prim.Ord.html#1332" class="Function">ordFromCompare</a> <a id="3905" href="Peras.Crypto.html#3635" class="Function">compareSignature</a>

<a id="3923" class="Symbol">{-#</a> <a id="3927" class="Keyword">COMPILE</a> <a id="3935" class="Keyword">AGDA2HS</a> <a id="3943" href="Peras.Crypto.html#3757" class="Function">iSignatureEq</a> <a id="3956" class="Symbol">#-}</a>

<a id="3961" class="Keyword">record</a> <a id="VerificationKey"></a><a id="3968" href="Peras.Crypto.html#3968" class="Record">VerificationKey</a> <a id="3984" class="Symbol">:</a> <a id="3986" href="Agda.Primitive.html#388" class="Primitive">Set</a> <a id="3990" class="Keyword">where</a>
  <a id="3998" class="Keyword">constructor</a> <a id="MkVerificationKey"></a><a id="4010" href="Peras.Crypto.html#4010" class="InductiveConstructor">MkVerificationKey</a>
  <a id="4030" class="Keyword">field</a> <a id="VerificationKey.keyV"></a><a id="4036" href="Peras.Crypto.html#4036" class="Field">keyV</a> <a id="4041" class="Symbol">:</a> <a id="4043" href="Peras.Crypto.html#657" class="Postulate">ByteString</a>

<a id="4055" class="Keyword">open</a> <a id="4060" href="Peras.Crypto.html#3968" class="Module">VerificationKey</a> <a id="4076" class="Keyword">public</a>

<a id="4084" class="Symbol">{-#</a> <a id="4088" class="Keyword">COMPILE</a> <a id="4096" class="Keyword">AGDA2HS</a> <a id="4104" href="Peras.Crypto.html#3968" class="Record">VerificationKey</a> <a id="4120" class="Pragma">newtype</a> <a id="4128" class="Pragma">deriving</a> <a id="4137" class="Pragma">(Generic)</a> <a id="4147" class="Symbol">#-}</a>
<a id="4151" class="Symbol">{-#</a> <a id="4155" class="Keyword">COMPILE</a> <a id="4163" class="Keyword">GHC</a> <a id="4167" href="Peras.Crypto.html#3968" class="Record">VerificationKey</a> <a id="4183" class="Pragma">=</a> <a id="4185" class="Pragma">data</a> <a id="4190" class="Pragma">G.VerificationKey</a> <a id="4208" class="Pragma">(G.MkVerificationKey)</a> <a id="4230" class="Symbol">#-}</a>

<a id="4235" class="Keyword">instance</a>
  <a id="iVerificationKeyEq"></a><a id="4246" href="Peras.Crypto.html#4246" class="Function">iVerificationKeyEq</a> <a id="4265" class="Symbol">:</a> <a id="4267" href="Haskell.Prim.Eq.html#401" class="Record">Eq</a> <a id="4270" href="Peras.Crypto.html#3968" class="Record">VerificationKey</a>
  <a id="4288" href="Peras.Crypto.html#4246" class="Function">iVerificationKeyEq</a> <a id="4307" class="Symbol">.</a><a id="4308" href="Haskell.Prim.Eq.html#453" class="Field Operator">_==_</a> <a id="4313" href="Peras.Crypto.html#4313" class="Bound">x</a> <a id="4315" href="Peras.Crypto.html#4315" class="Bound">y</a> <a id="4317" class="Symbol">=</a> <a id="4319" href="Peras.Crypto.html#699" class="Postulate">eqBS</a> <a id="4324" class="Symbol">(</a><a id="4325" href="Peras.Crypto.html#4036" class="Field">keyV</a> <a id="4330" href="Peras.Crypto.html#4313" class="Bound">x</a><a id="4331" class="Symbol">)</a> <a id="4333" class="Symbol">(</a><a id="4334" href="Peras.Crypto.html#4036" class="Field">keyV</a> <a id="4339" href="Peras.Crypto.html#4315" class="Bound">y</a><a id="4340" class="Symbol">)</a>

<a id="4343" class="Symbol">{-#</a> <a id="4347" class="Keyword">COMPILE</a> <a id="4355" class="Keyword">AGDA2HS</a> <a id="4363" href="Peras.Crypto.html#4246" class="Function">iVerificationKeyEq</a> <a id="4382" class="Symbol">#-}</a>

<a id="4387" class="Comment">-- | a fake membership &quot;proof&quot; is simply a concatenation of all the</a>
<a id="4455" class="Comment">-- members&#39; verification keys.</a>
<a id="isCommitteeMember"></a><a id="4486" href="Peras.Crypto.html#4486" class="Function">isCommitteeMember</a> <a id="4504" class="Symbol">:</a> <a id="4506" href="Peras.Crypto.html#3968" class="Record">VerificationKey</a> <a id="4522" class="Symbol">-&gt;</a> <a id="4525" href="Peras.Crypto.html#2454" class="Record">MembershipProof</a> <a id="4541" class="Symbol">-&gt;</a> <a id="4544" href="Agda.Builtin.Bool.html#173" class="Datatype">Bool</a>
<a id="4549" href="Peras.Crypto.html#4486" class="Function">isCommitteeMember</a> <a id="4567" class="Symbol">(</a><a id="4568" class="Keyword">record</a> <a id="4575" class="Symbol">{</a><a id="4576" href="Peras.Crypto.html#4036" class="Field">keyV</a> <a id="4581" class="Symbol">=</a> <a id="4583" href="Peras.Crypto.html#4583" class="Bound">verKey</a><a id="4589" class="Symbol">})</a> <a id="4592" class="Symbol">(</a><a id="4593" class="Keyword">record</a> <a id="4600" class="Symbol">{</a> <a id="4602" href="Peras.Crypto.html#2522" class="Field">proofM</a> <a id="4609" class="Symbol">=</a> <a id="4611" href="Peras.Crypto.html#4611" class="Bound">proof</a> <a id="4617" class="Symbol">})</a> <a id="4620" class="Symbol">=</a>
  <a id="4624" href="Peras.Crypto.html#4583" class="Bound">verKey</a> <a id="4631" href="Peras.Crypto.html#739" class="Postulate Operator">isInfixOf</a> <a id="4641" href="Peras.Crypto.html#4611" class="Bound">proof</a>

<a id="4648" class="Keyword">postulate</a> <a id="verify"></a><a id="4658" href="Peras.Crypto.html#4658" class="Postulate">verify</a> <a id="4665" class="Symbol">:</a> <a id="4667" href="Peras.Crypto.html#3968" class="Record">VerificationKey</a> <a id="4683" class="Symbol">-&gt;</a> <a id="4686" href="Peras.Crypto.html#3408" class="Record">Signature</a> <a id="4696" class="Symbol">-&gt;</a> <a id="4699" href="Peras.Crypto.html#657" class="Postulate">ByteString</a> <a id="4710" class="Symbol">-&gt;</a> <a id="4713" href="Agda.Builtin.Bool.html#173" class="Datatype">Bool</a>
</pre></body></html>