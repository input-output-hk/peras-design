<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Peras.Crypto</title><link rel="stylesheet" href="Agda.css"></head><body><pre class="Agda"><a id="1" class="Comment">-- | Cryptographic primitives types and functions used to implement /Peras/ protocol.</a>
<a id="87" class="Comment">--</a>
<a id="90" class="Comment">-- We don&#39;t use real cryptography here, just a bunch of newtypes and</a>
<a id="159" class="Comment">-- simple functions that represent various cryptographic operations</a>
<a id="227" class="Comment">-- one can do when running the protocol</a>
<a id="267" class="Keyword">module</a> <a id="274" href="Peras.Crypto.html" class="Module">Peras.Crypto</a> <a id="287" class="Keyword">where</a>

<a id="294" class="Keyword">open</a> <a id="299" class="Keyword">import</a> <a id="306" href="Agda.Builtin.Equality.html" class="Module">Agda.Builtin.Equality</a> <a id="328" class="Keyword">using</a> <a id="334" class="Symbol">(</a><a id="335" href="Agda.Builtin.Equality.html#150" class="Datatype Operator">_≡_</a><a id="338" class="Symbol">;</a> <a id="340" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a><a id="344" class="Symbol">)</a>
<a id="346" class="Keyword">open</a> <a id="351" class="Keyword">import</a> <a id="358" href="Data.Bool.html" class="Module">Data.Bool</a> <a id="368" class="Keyword">using</a> <a id="374" class="Symbol">(</a><a id="375" href="Agda.Builtin.Bool.html#173" class="Datatype">Bool</a><a id="379" class="Symbol">;</a> <a id="381" href="Agda.Builtin.Bool.html#198" class="InductiveConstructor">true</a><a id="385" class="Symbol">)</a>
<a id="387" class="Keyword">open</a> <a id="392" class="Keyword">import</a> <a id="399" href="Haskell.Prelude.html" class="Module">Haskell.Prelude</a> <a id="415" class="Keyword">using</a> <a id="421" class="Symbol">(</a><a id="422" href="Haskell.Prim.Eq.html#401" class="Record">Eq</a><a id="424" class="Symbol">;</a> <a id="426" href="Haskell.Prim.Int.html#367" class="Datatype">Int</a><a id="429" class="Symbol">;</a> <a id="431" href="Haskell.Prim.Eq.html#453" class="Field Operator">_==_</a><a id="435" class="Symbol">;</a> <a id="437" href="Haskell.Prim.Ord.html#1003" class="Record">Ord</a><a id="440" class="Symbol">;</a> <a id="442" href="Haskell.Prim.Ord.html#1041" class="Field">compare</a> <a id="450" class="Symbol">;</a> <a id="452" href="Haskell.Prim.Ord.html#466" class="Datatype">Ordering</a> <a id="461" class="Symbol">;</a> <a id="463" href="Haskell.Prim.Ord.html#1332" class="Function">ordFromCompare</a><a id="477" class="Symbol">)</a>
<a id="479" class="Keyword">open</a> <a id="484" class="Keyword">import</a> <a id="491" href="Relation.Binary.html" class="Module">Relation.Binary</a> <a id="507" class="Keyword">using</a> <a id="513" class="Symbol">(</a><a id="514" href="Relation.Binary.Definitions.html#6469" class="Function">DecidableEquality</a><a id="531" class="Symbol">)</a>
<a id="533" class="Keyword">open</a> <a id="538" class="Keyword">import</a> <a id="545" href="Relation.Binary.html" class="Module">Relation.Binary</a> <a id="561" class="Keyword">using</a> <a id="567" class="Symbol">(</a><a id="568" href="Relation.Binary.Bundles.html#8031" class="Record">StrictTotalOrder</a><a id="584" class="Symbol">)</a>

<a id="587" class="Comment">-- The following implementations are supplied in Haskell.</a>
<a id="645" class="Keyword">postulate</a>
  <a id="ByteString"></a><a id="657" href="Peras.Crypto.html#657" class="Postulate">ByteString</a> <a id="668" class="Symbol">:</a> <a id="670" href="Agda.Primitive.html#388" class="Primitive">Set</a>
  <a id="emptyBS"></a><a id="676" href="Peras.Crypto.html#676" class="Postulate">emptyBS</a> <a id="684" class="Symbol">:</a> <a id="686" href="Peras.Crypto.html#657" class="Postulate">ByteString</a>
  <a id="eqBS"></a><a id="699" href="Peras.Crypto.html#699" class="Postulate">eqBS</a> <a id="704" class="Symbol">:</a> <a id="706" href="Peras.Crypto.html#657" class="Postulate">ByteString</a> <a id="717" class="Symbol">→</a> <a id="719" href="Peras.Crypto.html#657" class="Postulate">ByteString</a> <a id="730" class="Symbol">→</a> <a id="732" href="Agda.Builtin.Bool.html#173" class="Datatype">Bool</a>
  <a id="_isInfixOf_"></a><a id="739" href="Peras.Crypto.html#739" class="Postulate Operator">_isInfixOf_</a> <a id="751" class="Symbol">:</a> <a id="753" href="Peras.Crypto.html#657" class="Postulate">ByteString</a> <a id="764" class="Symbol">→</a> <a id="766" href="Peras.Crypto.html#657" class="Postulate">ByteString</a> <a id="777" class="Symbol">→</a> <a id="779" href="Agda.Builtin.Bool.html#173" class="Datatype">Bool</a>
  <a id="replicateBS"></a><a id="786" href="Peras.Crypto.html#786" class="Postulate">replicateBS</a> <a id="798" class="Symbol">:</a> <a id="800" href="Haskell.Prim.Int.html#367" class="Datatype">Int</a> <a id="804" class="Symbol">→</a> <a id="806" href="Haskell.Prim.Int.html#367" class="Datatype">Int</a> <a id="810" class="Symbol">→</a> <a id="812" href="Peras.Crypto.html#657" class="Postulate">ByteString</a>
  <a id="_≟-BS_"></a><a id="825" href="Peras.Crypto.html#825" class="Postulate Operator">_≟-BS_</a> <a id="832" class="Symbol">:</a> <a id="834" href="Relation.Binary.Definitions.html#6469" class="Function">DecidableEquality</a> <a id="852" href="Peras.Crypto.html#657" class="Postulate">ByteString</a>
  <a id="compare-BS"></a><a id="865" href="Peras.Crypto.html#865" class="Postulate">compare-BS</a> <a id="876" class="Symbol">:</a> <a id="878" href="Peras.Crypto.html#657" class="Postulate">ByteString</a> <a id="889" class="Symbol">→</a> <a id="891" href="Peras.Crypto.html#657" class="Postulate">ByteString</a> <a id="902" class="Symbol">→</a> <a id="904" href="Haskell.Prim.Ord.html#466" class="Datatype">Ordering</a>

  <a id="lem-eqBS"></a><a id="916" href="Peras.Crypto.html#916" class="Postulate">lem-eqBS</a> <a id="925" class="Symbol">:</a> <a id="927" class="Symbol">∀</a> <a id="929" class="Symbol">{</a><a id="930" href="Peras.Crypto.html#930" class="Bound">b₁</a> <a id="933" href="Peras.Crypto.html#933" class="Bound">b₂</a><a id="935" class="Symbol">}</a> <a id="937" class="Symbol">→</a> <a id="939" href="Peras.Crypto.html#699" class="Postulate">eqBS</a> <a id="944" href="Peras.Crypto.html#930" class="Bound">b₁</a> <a id="947" href="Peras.Crypto.html#933" class="Bound">b₂</a> <a id="950" href="Agda.Builtin.Equality.html#150" class="Datatype Operator">≡</a> <a id="952" href="Agda.Builtin.Bool.html#198" class="InductiveConstructor">true</a> <a id="957" class="Symbol">→</a> <a id="959" href="Peras.Crypto.html#930" class="Bound">b₁</a> <a id="962" href="Agda.Builtin.Equality.html#150" class="Datatype Operator">≡</a> <a id="964" href="Peras.Crypto.html#933" class="Bound">b₂</a>

<a id="968" class="Symbol">{-#</a> <a id="972" class="Keyword">FOREIGN</a> <a id="980" class="Pragma">AGDA2HS</a>
<a id="988" class="Symbol">{-#</a> <a id="992" class="Pragma">LANGUAGE</a> <a id="1001" class="Pragma">DeriveGeneric</a> <a id="1015" class="Symbol">#-}</a>
<a id="1019" class="Pragma">import</a> <a id="1026" class="Pragma">Data.ByteString</a> <a id="1042" class="Pragma">as</a> <a id="1045" class="Pragma">BS</a>
<a id="1048" class="Pragma">import</a> <a id="1055" class="Pragma">Data.Word</a> <a id="1065" class="Pragma">(Word8)</a>
<a id="1073" class="Pragma">import</a> <a id="1080" class="Pragma">GHC.Generics</a> <a id="1093" class="Pragma">(Generic)</a>
<a id="1103" class="Pragma">eqBS</a> <a id="1108" class="Pragma">::</a> <a id="1111" class="Pragma">ByteString</a> <a id="1122" class="Pragma">-&gt;</a> <a id="1125" class="Pragma">ByteString</a> <a id="1136" class="Pragma">-&gt;</a> <a id="1139" class="Pragma">Bool</a>
<a id="1144" class="Pragma">eqBS</a> <a id="1149" class="Pragma">=</a> <a id="1151" class="Pragma">(==)</a>
<a id="1156" class="Pragma">replicateBS</a> <a id="1168" class="Pragma">::</a> <a id="1171" class="Pragma">Int</a> <a id="1175" class="Pragma">-&gt;</a> <a id="1178" class="Pragma">Word8</a> <a id="1184" class="Pragma">-&gt;</a> <a id="1187" class="Pragma">ByteString</a>
<a id="1198" class="Pragma">replicateBS</a> <a id="1210" class="Pragma">=</a> <a id="1212" class="Pragma">BS.replicate</a>
<a id="1225" class="Pragma">emptyBS</a> <a id="1233" class="Pragma">::</a> <a id="1236" class="Pragma">ByteString</a>
<a id="1247" class="Pragma">emptyBS</a> <a id="1255" class="Pragma">=</a> <a id="1257" class="Pragma">mempty</a>
<a id="1264" class="Symbol">#-}</a>

<a id="1269" class="Symbol">{-#</a> <a id="1273" class="Keyword">FOREIGN</a> <a id="1281" class="Pragma">GHC</a>
<a id="1285" class="Pragma">import</a> <a id="1292" class="Pragma">qualified</a> <a id="1302" class="Pragma">Data.ByteString</a> <a id="1318" class="Pragma">as</a> <a id="1321" class="Pragma">BS</a>
<a id="1324" class="Pragma">import</a> <a id="1331" class="Pragma">qualified</a> <a id="1341" class="Pragma">Peras.Crypto</a> <a id="1354" class="Pragma">as</a> <a id="1357" class="Pragma">G</a>
<a id="1359" class="Symbol">#-}</a>

<a id="1364" class="Symbol">{-#</a> <a id="1368" class="Keyword">COMPILE</a> <a id="1376" class="Keyword">GHC</a> <a id="1380" href="Peras.Crypto.html#657" class="Postulate">ByteString</a> <a id="1391" class="Pragma">=</a> <a id="1393" class="Pragma">type</a> <a id="1398" class="Pragma">BS.ByteString</a> <a id="1412" class="Symbol">#-}</a>
<a id="1416" class="Symbol">{-#</a> <a id="1420" class="Keyword">COMPILE</a> <a id="1428" class="Keyword">GHC</a> <a id="1432" href="Peras.Crypto.html#676" class="Postulate">emptyBS</a> <a id="1440" class="Pragma">=</a> <a id="1442" class="Pragma">BS.empty</a> <a id="1451" class="Symbol">#-}</a>
<a id="1455" class="Symbol">{-#</a> <a id="1459" class="Keyword">COMPILE</a> <a id="1467" class="Keyword">GHC</a> <a id="1471" href="Peras.Crypto.html#699" class="Postulate">eqBS</a> <a id="1476" class="Pragma">=</a> <a id="1478" class="Pragma">(==)</a> <a id="1483" class="Symbol">#-}</a>
<a id="1487" class="Symbol">{-#</a> <a id="1491" class="Keyword">COMPILE</a> <a id="1499" class="Keyword">GHC</a> <a id="1503" href="Peras.Crypto.html#739" class="Postulate Operator">_isInfixOf_</a> <a id="1515" class="Pragma">=</a> <a id="1517" class="Pragma">BS.isInfixOf</a> <a id="1530" class="Symbol">#-}</a>

<a id="1535" class="Keyword">record</a> <a id="Hash"></a><a id="1542" href="Peras.Crypto.html#1542" class="Record">Hash</a> <a id="1547" class="Symbol">(</a><a id="1548" href="Peras.Crypto.html#1548" class="Bound">a</a> <a id="1550" class="Symbol">:</a> <a id="1552" href="Agda.Primitive.html#388" class="Primitive">Set</a><a id="1555" class="Symbol">)</a> <a id="1557" class="Symbol">:</a> <a id="1559" href="Agda.Primitive.html#388" class="Primitive">Set</a> <a id="1563" class="Keyword">where</a>
  <a id="1571" class="Keyword">constructor</a> <a id="MkHash"></a><a id="1583" href="Peras.Crypto.html#1583" class="InductiveConstructor">MkHash</a>
  <a id="1592" class="Keyword">field</a> <a id="Hash.hashBytes"></a><a id="1598" href="Peras.Crypto.html#1598" class="Field">hashBytes</a> <a id="1608" class="Symbol">:</a> <a id="1610" href="Peras.Crypto.html#657" class="Postulate">ByteString</a>

<a id="1622" class="Keyword">open</a> <a id="1627" href="Peras.Crypto.html#1542" class="Module">Hash</a> <a id="1632" class="Keyword">public</a>

<a id="1640" class="Symbol">{-#</a> <a id="1644" class="Keyword">COMPILE</a> <a id="1652" class="Keyword">AGDA2HS</a> <a id="1660" href="Peras.Crypto.html#1542" class="Record">Hash</a> <a id="1665" class="Pragma">newtype</a> <a id="1673" class="Pragma">deriving</a> <a id="1682" class="Pragma">(Generic)</a> <a id="1692" class="Symbol">#-}</a>
<a id="1696" class="Symbol">{-#</a> <a id="1700" class="Keyword">COMPILE</a> <a id="1708" class="Keyword">GHC</a> <a id="1712" href="Peras.Crypto.html#1542" class="Record">Hash</a> <a id="1717" class="Pragma">=</a> <a id="1719" class="Pragma">data</a> <a id="1724" class="Pragma">G.Hash</a> <a id="1731" class="Pragma">(G.MkHash)</a> <a id="1742" class="Symbol">#-}</a>

<a id="MkHash-inj"></a><a id="1747" href="Peras.Crypto.html#1747" class="Function">MkHash-inj</a> <a id="1758" class="Symbol">:</a> <a id="1760" class="Symbol">∀</a> <a id="1762" class="Symbol">{</a><a id="1763" href="Peras.Crypto.html#1763" class="Bound">a</a> <a id="1765" class="Symbol">:</a> <a id="1767" href="Agda.Primitive.html#388" class="Primitive">Set</a><a id="1770" class="Symbol">}</a> <a id="1772" class="Symbol">{</a><a id="1773" href="Peras.Crypto.html#1773" class="Bound">b₁</a> <a id="1776" href="Peras.Crypto.html#1776" class="Bound">b₂</a> <a id="1779" class="Symbol">:</a> <a id="1781" href="Peras.Crypto.html#1542" class="Record">Hash</a> <a id="1786" href="Peras.Crypto.html#1763" class="Bound">a</a><a id="1787" class="Symbol">}</a> <a id="1789" class="Symbol">→</a> <a id="1791" href="Peras.Crypto.html#1598" class="Field">hashBytes</a> <a id="1801" href="Peras.Crypto.html#1773" class="Bound">b₁</a> <a id="1804" href="Agda.Builtin.Equality.html#150" class="Datatype Operator">≡</a> <a id="1806" href="Peras.Crypto.html#1598" class="Field">hashBytes</a> <a id="1816" href="Peras.Crypto.html#1776" class="Bound">b₂</a> <a id="1819" class="Symbol">→</a> <a id="1821" href="Peras.Crypto.html#1773" class="Bound">b₁</a> <a id="1824" href="Agda.Builtin.Equality.html#150" class="Datatype Operator">≡</a> <a id="1826" href="Peras.Crypto.html#1776" class="Bound">b₂</a>
<a id="1829" href="Peras.Crypto.html#1747" class="Function">MkHash-inj</a> <a id="1840" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a> <a id="1845" class="Symbol">=</a> <a id="1847" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a>

<a id="1853" class="Keyword">instance</a>
  <a id="iHashEq"></a><a id="1864" href="Peras.Crypto.html#1864" class="Function">iHashEq</a> <a id="1872" class="Symbol">:</a> <a id="1874" class="Symbol">{</a><a id="1875" href="Peras.Crypto.html#1875" class="Bound">a</a> <a id="1877" class="Symbol">:</a> <a id="1879" href="Agda.Primitive.html#388" class="Primitive">Set</a><a id="1882" class="Symbol">}</a> <a id="1884" class="Symbol">→</a> <a id="1886" href="Haskell.Prim.Eq.html#401" class="Record">Eq</a> <a id="1889" class="Symbol">(</a><a id="1890" href="Peras.Crypto.html#1542" class="Record">Hash</a> <a id="1895" href="Peras.Crypto.html#1875" class="Bound">a</a><a id="1896" class="Symbol">)</a>
  <a id="1900" href="Peras.Crypto.html#1864" class="Function">iHashEq</a> <a id="1908" class="Symbol">.</a><a id="1909" href="Haskell.Prim.Eq.html#453" class="Field Operator">_==_</a> <a id="1914" href="Peras.Crypto.html#1914" class="Bound">x</a> <a id="1916" href="Peras.Crypto.html#1916" class="Bound">y</a> <a id="1918" class="Symbol">=</a> <a id="1920" href="Peras.Crypto.html#699" class="Postulate">eqBS</a> <a id="1925" class="Symbol">(</a><a id="1926" href="Peras.Crypto.html#1598" class="Field">hashBytes</a> <a id="1936" href="Peras.Crypto.html#1914" class="Bound">x</a><a id="1937" class="Symbol">)</a> <a id="1939" class="Symbol">(</a><a id="1940" href="Peras.Crypto.html#1598" class="Field">hashBytes</a> <a id="1950" href="Peras.Crypto.html#1916" class="Bound">y</a><a id="1951" class="Symbol">)</a>

<a id="1954" class="Symbol">{-#</a> <a id="1958" class="Keyword">COMPILE</a> <a id="1966" class="Keyword">AGDA2HS</a> <a id="1974" href="Peras.Crypto.html#1864" class="Function">iHashEq</a> <a id="1982" class="Symbol">#-}</a>

<a id="1987" class="Keyword">record</a> <a id="Hashable"></a><a id="1994" href="Peras.Crypto.html#1994" class="Record">Hashable</a> <a id="2003" class="Symbol">(</a><a id="2004" href="Peras.Crypto.html#2004" class="Bound">a</a> <a id="2006" class="Symbol">:</a> <a id="2008" href="Agda.Primitive.html#388" class="Primitive">Set</a><a id="2011" class="Symbol">)</a> <a id="2013" class="Symbol">:</a> <a id="2015" href="Agda.Primitive.html#388" class="Primitive">Set</a> <a id="2019" class="Keyword">where</a>
  <a id="2027" class="Keyword">field</a> <a id="Hashable.hash"></a><a id="2033" href="Peras.Crypto.html#2033" class="Field">hash</a> <a id="2038" class="Symbol">:</a> <a id="2040" href="Peras.Crypto.html#2004" class="Bound">a</a> <a id="2042" class="Symbol">→</a> <a id="2044" href="Peras.Crypto.html#1542" class="Record">Hash</a> <a id="2049" href="Peras.Crypto.html#2004" class="Bound">a</a>

<a id="2052" class="Symbol">{-#</a> <a id="2056" class="Keyword">COMPILE</a> <a id="2064" class="Keyword">AGDA2HS</a> <a id="2072" href="Peras.Crypto.html#1994" class="Record">Hashable</a> <a id="2081" class="Pragma">class</a> <a id="2087" class="Symbol">#-}</a>

<a id="2092" class="Comment">-- should use normal VRF algorithm like leadership membership</a>
<a id="2154" class="Keyword">record</a> <a id="MembershipProof"></a><a id="2161" href="Peras.Crypto.html#2161" class="Record">MembershipProof</a> <a id="2177" class="Symbol">:</a> <a id="2179" href="Agda.Primitive.html#388" class="Primitive">Set</a> <a id="2183" class="Keyword">where</a>
  <a id="2191" class="Keyword">constructor</a> <a id="MkMembershipProof"></a><a id="2203" href="Peras.Crypto.html#2203" class="InductiveConstructor">MkMembershipProof</a>
  <a id="2223" class="Keyword">field</a> <a id="MembershipProof.proofM"></a><a id="2229" href="Peras.Crypto.html#2229" class="Field">proofM</a> <a id="2236" class="Symbol">:</a> <a id="2238" href="Peras.Crypto.html#657" class="Postulate">ByteString</a>

<a id="2250" class="Keyword">open</a> <a id="2255" href="Peras.Crypto.html#2161" class="Module">MembershipProof</a> <a id="2271" class="Keyword">public</a>

<a id="2279" class="Symbol">{-#</a> <a id="2283" class="Keyword">COMPILE</a> <a id="2291" class="Keyword">AGDA2HS</a> <a id="2299" href="Peras.Crypto.html#2161" class="Record">MembershipProof</a> <a id="2315" class="Pragma">newtype</a> <a id="2323" class="Pragma">deriving</a> <a id="2332" class="Pragma">(Generic)</a> <a id="2342" class="Symbol">#-}</a>
<a id="2346" class="Symbol">{-#</a> <a id="2350" class="Keyword">COMPILE</a> <a id="2358" class="Keyword">GHC</a> <a id="2362" href="Peras.Crypto.html#2161" class="Record">MembershipProof</a> <a id="2378" class="Pragma">=</a> <a id="2380" class="Pragma">data</a> <a id="2385" class="Pragma">G.MembershipProof</a> <a id="2403" class="Pragma">(G.MkMembershipProof)</a> <a id="2425" class="Symbol">#-}</a>

<a id="2430" class="Keyword">instance</a>
  <a id="iMembershipProofEq"></a><a id="2441" href="Peras.Crypto.html#2441" class="Function">iMembershipProofEq</a> <a id="2460" class="Symbol">:</a> <a id="2462" href="Haskell.Prim.Eq.html#401" class="Record">Eq</a> <a id="2465" href="Peras.Crypto.html#2161" class="Record">MembershipProof</a>
  <a id="2483" href="Peras.Crypto.html#2441" class="Function">iMembershipProofEq</a> <a id="2502" class="Symbol">.</a><a id="2503" href="Haskell.Prim.Eq.html#453" class="Field Operator">_==_</a> <a id="2508" href="Peras.Crypto.html#2508" class="Bound">x</a> <a id="2510" href="Peras.Crypto.html#2510" class="Bound">y</a> <a id="2512" class="Symbol">=</a> <a id="2514" href="Peras.Crypto.html#699" class="Postulate">eqBS</a> <a id="2519" class="Symbol">(</a><a id="2520" href="Peras.Crypto.html#2229" class="Field">proofM</a> <a id="2527" href="Peras.Crypto.html#2508" class="Bound">x</a><a id="2528" class="Symbol">)</a> <a id="2530" class="Symbol">(</a><a id="2531" href="Peras.Crypto.html#2229" class="Field">proofM</a> <a id="2538" href="Peras.Crypto.html#2510" class="Bound">y</a><a id="2539" class="Symbol">)</a>

<a id="2542" class="Symbol">{-#</a> <a id="2546" class="Keyword">COMPILE</a> <a id="2554" class="Keyword">AGDA2HS</a> <a id="2562" href="Peras.Crypto.html#2441" class="Function">iMembershipProofEq</a> <a id="2581" class="Symbol">#-}</a>

<a id="2586" class="Keyword">record</a> <a id="LeadershipProof"></a><a id="2593" href="Peras.Crypto.html#2593" class="Record">LeadershipProof</a> <a id="2609" class="Symbol">:</a> <a id="2611" href="Agda.Primitive.html#388" class="Primitive">Set</a> <a id="2615" class="Keyword">where</a>
  <a id="2623" class="Keyword">constructor</a> <a id="MkLeadershipProof"></a><a id="2635" href="Peras.Crypto.html#2635" class="InductiveConstructor">MkLeadershipProof</a>
  <a id="2655" class="Keyword">field</a> <a id="LeadershipProof.proofL"></a><a id="2661" href="Peras.Crypto.html#2661" class="Field">proofL</a> <a id="2668" class="Symbol">:</a> <a id="2670" href="Peras.Crypto.html#657" class="Postulate">ByteString</a>

<a id="2682" class="Keyword">open</a> <a id="2687" href="Peras.Crypto.html#2593" class="Module">LeadershipProof</a> <a id="2703" class="Keyword">public</a>

<a id="2711" class="Symbol">{-#</a> <a id="2715" class="Keyword">COMPILE</a> <a id="2723" class="Keyword">AGDA2HS</a> <a id="2731" href="Peras.Crypto.html#2593" class="Record">LeadershipProof</a> <a id="2747" class="Pragma">newtype</a> <a id="2755" class="Pragma">deriving</a> <a id="2764" class="Pragma">(Generic)</a> <a id="2774" class="Symbol">#-}</a>
<a id="2778" class="Symbol">{-#</a> <a id="2782" class="Keyword">COMPILE</a> <a id="2790" class="Keyword">GHC</a> <a id="2794" href="Peras.Crypto.html#2593" class="Record">LeadershipProof</a> <a id="2810" class="Pragma">=</a> <a id="2812" class="Pragma">data</a> <a id="2817" class="Pragma">G.LeadershipProof</a> <a id="2835" class="Pragma">(G.MkLeadershipProof)</a> <a id="2857" class="Symbol">#-}</a>

<a id="2862" class="Keyword">instance</a>
  <a id="iLeadershipProofEq"></a><a id="2873" href="Peras.Crypto.html#2873" class="Function">iLeadershipProofEq</a> <a id="2892" class="Symbol">:</a> <a id="2894" href="Haskell.Prim.Eq.html#401" class="Record">Eq</a> <a id="2897" href="Peras.Crypto.html#2593" class="Record">LeadershipProof</a>
  <a id="2915" href="Peras.Crypto.html#2873" class="Function">iLeadershipProofEq</a> <a id="2934" class="Symbol">.</a><a id="2935" href="Haskell.Prim.Eq.html#453" class="Field Operator">_==_</a> <a id="2940" href="Peras.Crypto.html#2940" class="Bound">x</a> <a id="2942" href="Peras.Crypto.html#2942" class="Bound">y</a> <a id="2944" class="Symbol">=</a> <a id="2946" href="Peras.Crypto.html#699" class="Postulate">eqBS</a> <a id="2951" class="Symbol">(</a><a id="2952" href="Peras.Crypto.html#2661" class="Field">proofL</a> <a id="2959" href="Peras.Crypto.html#2940" class="Bound">x</a><a id="2960" class="Symbol">)</a> <a id="2962" class="Symbol">(</a><a id="2963" href="Peras.Crypto.html#2661" class="Field">proofL</a> <a id="2970" href="Peras.Crypto.html#2942" class="Bound">y</a><a id="2971" class="Symbol">)</a>

<a id="2974" class="Symbol">{-#</a> <a id="2978" class="Keyword">COMPILE</a> <a id="2986" class="Keyword">AGDA2HS</a> <a id="2994" href="Peras.Crypto.html#2873" class="Function">iLeadershipProofEq</a> <a id="3013" class="Symbol">#-}</a>

<a id="3018" class="Comment">{-
-- use KES-based signatures which weighs about 600 bytes (could be
-- down to 400)
-}</a>

<a id="3108" class="Keyword">record</a> <a id="Signature"></a><a id="3115" href="Peras.Crypto.html#3115" class="Record">Signature</a> <a id="3125" class="Symbol">:</a> <a id="3127" href="Agda.Primitive.html#388" class="Primitive">Set</a> <a id="3131" class="Keyword">where</a>
  <a id="3139" class="Keyword">constructor</a> <a id="MkSignature"></a><a id="3151" href="Peras.Crypto.html#3151" class="InductiveConstructor">MkSignature</a>
  <a id="3165" class="Keyword">field</a> <a id="Signature.bytesS"></a><a id="3171" href="Peras.Crypto.html#3171" class="Field">bytesS</a> <a id="3178" class="Symbol">:</a> <a id="3180" href="Peras.Crypto.html#657" class="Postulate">ByteString</a>

<a id="3192" class="Keyword">open</a> <a id="3197" href="Peras.Crypto.html#3115" class="Module">Signature</a> <a id="3207" class="Keyword">public</a>

<a id="3215" class="Symbol">{-#</a> <a id="3219" class="Keyword">COMPILE</a> <a id="3227" class="Keyword">AGDA2HS</a> <a id="3235" href="Peras.Crypto.html#3115" class="Record">Signature</a> <a id="3245" class="Pragma">newtype</a> <a id="3253" class="Pragma">deriving</a> <a id="3262" class="Pragma">(Generic)</a> <a id="3272" class="Symbol">#-}</a>
<a id="3276" class="Symbol">{-#</a> <a id="3280" class="Keyword">COMPILE</a> <a id="3288" class="Keyword">GHC</a> <a id="3292" href="Peras.Crypto.html#3115" class="Record">Signature</a> <a id="3302" class="Pragma">=</a> <a id="3304" class="Pragma">data</a> <a id="3309" class="Pragma">G.Signature</a> <a id="3321" class="Pragma">(G.MkSignature)</a> <a id="3337" class="Symbol">#-}</a>

<a id="compareSignature"></a><a id="3342" href="Peras.Crypto.html#3342" class="Function">compareSignature</a> <a id="3359" class="Symbol">:</a> <a id="3361" href="Peras.Crypto.html#3115" class="Record">Signature</a> <a id="3371" class="Symbol">-&gt;</a> <a id="3374" href="Peras.Crypto.html#3115" class="Record">Signature</a> <a id="3384" class="Symbol">-&gt;</a> <a id="3387" href="Haskell.Prim.Ord.html#466" class="Datatype">Ordering</a>
<a id="3396" href="Peras.Crypto.html#3342" class="Function">compareSignature</a> <a id="3413" href="Peras.Crypto.html#3413" class="Bound">x</a> <a id="3415" href="Peras.Crypto.html#3415" class="Bound">y</a> <a id="3417" class="Symbol">=</a> <a id="3419" href="Peras.Crypto.html#865" class="Postulate">compare-BS</a> <a id="3430" class="Symbol">(</a><a id="3431" href="Peras.Crypto.html#3171" class="Field">bytesS</a> <a id="3438" href="Peras.Crypto.html#3413" class="Bound">x</a><a id="3439" class="Symbol">)</a> <a id="3441" class="Symbol">(</a><a id="3442" href="Peras.Crypto.html#3171" class="Field">bytesS</a> <a id="3449" href="Peras.Crypto.html#3415" class="Bound">y</a><a id="3450" class="Symbol">)</a>

<a id="3453" class="Keyword">instance</a>
  <a id="iSignatureEq"></a><a id="3464" href="Peras.Crypto.html#3464" class="Function">iSignatureEq</a> <a id="3477" class="Symbol">:</a> <a id="3479" href="Haskell.Prim.Eq.html#401" class="Record">Eq</a> <a id="3482" href="Peras.Crypto.html#3115" class="Record">Signature</a>
  <a id="3494" href="Peras.Crypto.html#3464" class="Function">iSignatureEq</a> <a id="3507" class="Symbol">.</a><a id="3508" href="Haskell.Prim.Eq.html#453" class="Field Operator">_==_</a> <a id="3513" href="Peras.Crypto.html#3513" class="Bound">x</a> <a id="3515" href="Peras.Crypto.html#3515" class="Bound">y</a> <a id="3517" class="Symbol">=</a> <a id="3519" href="Peras.Crypto.html#699" class="Postulate">eqBS</a> <a id="3524" class="Symbol">(</a><a id="3525" href="Peras.Crypto.html#3171" class="Field">bytesS</a> <a id="3532" href="Peras.Crypto.html#3513" class="Bound">x</a><a id="3533" class="Symbol">)</a> <a id="3535" class="Symbol">(</a><a id="3536" href="Peras.Crypto.html#3171" class="Field">bytesS</a> <a id="3543" href="Peras.Crypto.html#3515" class="Bound">y</a><a id="3544" class="Symbol">)</a>

  <a id="iSignatureOrd"></a><a id="3549" href="Peras.Crypto.html#3549" class="Function">iSignatureOrd</a> <a id="3563" class="Symbol">:</a> <a id="3565" href="Haskell.Prim.Ord.html#1003" class="Record">Ord</a> <a id="3569" href="Peras.Crypto.html#3115" class="Record">Signature</a>
  <a id="3581" href="Peras.Crypto.html#3549" class="Function">iSignatureOrd</a> <a id="3595" class="Symbol">=</a> <a id="3597" href="Haskell.Prim.Ord.html#1332" class="Function">ordFromCompare</a> <a id="3612" href="Peras.Crypto.html#3342" class="Function">compareSignature</a>

<a id="3630" class="Symbol">{-#</a> <a id="3634" class="Keyword">COMPILE</a> <a id="3642" class="Keyword">AGDA2HS</a> <a id="3650" href="Peras.Crypto.html#3464" class="Function">iSignatureEq</a> <a id="3663" class="Symbol">#-}</a>

<a id="3668" class="Keyword">record</a> <a id="VerificationKey"></a><a id="3675" href="Peras.Crypto.html#3675" class="Record">VerificationKey</a> <a id="3691" class="Symbol">:</a> <a id="3693" href="Agda.Primitive.html#388" class="Primitive">Set</a> <a id="3697" class="Keyword">where</a>
  <a id="3705" class="Keyword">constructor</a> <a id="MkVerificationKey"></a><a id="3717" href="Peras.Crypto.html#3717" class="InductiveConstructor">MkVerificationKey</a>
  <a id="3737" class="Keyword">field</a> <a id="VerificationKey.keyV"></a><a id="3743" href="Peras.Crypto.html#3743" class="Field">keyV</a> <a id="3748" class="Symbol">:</a> <a id="3750" href="Peras.Crypto.html#657" class="Postulate">ByteString</a>

<a id="3762" class="Keyword">open</a> <a id="3767" href="Peras.Crypto.html#3675" class="Module">VerificationKey</a> <a id="3783" class="Keyword">public</a>

<a id="3791" class="Symbol">{-#</a> <a id="3795" class="Keyword">COMPILE</a> <a id="3803" class="Keyword">AGDA2HS</a> <a id="3811" href="Peras.Crypto.html#3675" class="Record">VerificationKey</a> <a id="3827" class="Pragma">newtype</a> <a id="3835" class="Pragma">deriving</a> <a id="3844" class="Pragma">(Generic)</a> <a id="3854" class="Symbol">#-}</a>
<a id="3858" class="Symbol">{-#</a> <a id="3862" class="Keyword">COMPILE</a> <a id="3870" class="Keyword">GHC</a> <a id="3874" href="Peras.Crypto.html#3675" class="Record">VerificationKey</a> <a id="3890" class="Pragma">=</a> <a id="3892" class="Pragma">data</a> <a id="3897" class="Pragma">G.VerificationKey</a> <a id="3915" class="Pragma">(G.MkVerificationKey)</a> <a id="3937" class="Symbol">#-}</a>

<a id="3942" class="Keyword">instance</a>
  <a id="iVerificationKeyEq"></a><a id="3953" href="Peras.Crypto.html#3953" class="Function">iVerificationKeyEq</a> <a id="3972" class="Symbol">:</a> <a id="3974" href="Haskell.Prim.Eq.html#401" class="Record">Eq</a> <a id="3977" href="Peras.Crypto.html#3675" class="Record">VerificationKey</a>
  <a id="3995" href="Peras.Crypto.html#3953" class="Function">iVerificationKeyEq</a> <a id="4014" class="Symbol">.</a><a id="4015" href="Haskell.Prim.Eq.html#453" class="Field Operator">_==_</a> <a id="4020" href="Peras.Crypto.html#4020" class="Bound">x</a> <a id="4022" href="Peras.Crypto.html#4022" class="Bound">y</a> <a id="4024" class="Symbol">=</a> <a id="4026" href="Peras.Crypto.html#699" class="Postulate">eqBS</a> <a id="4031" class="Symbol">(</a><a id="4032" href="Peras.Crypto.html#3743" class="Field">keyV</a> <a id="4037" href="Peras.Crypto.html#4020" class="Bound">x</a><a id="4038" class="Symbol">)</a> <a id="4040" class="Symbol">(</a><a id="4041" href="Peras.Crypto.html#3743" class="Field">keyV</a> <a id="4046" href="Peras.Crypto.html#4022" class="Bound">y</a><a id="4047" class="Symbol">)</a>

<a id="4050" class="Symbol">{-#</a> <a id="4054" class="Keyword">COMPILE</a> <a id="4062" class="Keyword">AGDA2HS</a> <a id="4070" href="Peras.Crypto.html#3953" class="Function">iVerificationKeyEq</a> <a id="4089" class="Symbol">#-}</a>

<a id="4094" class="Comment">-- | a fake membership &quot;proof&quot; is simply a concatenation of all the</a>
<a id="4162" class="Comment">-- members&#39; verification keys.</a>
<a id="isCommitteeMember"></a><a id="4193" href="Peras.Crypto.html#4193" class="Function">isCommitteeMember</a> <a id="4211" class="Symbol">:</a> <a id="4213" href="Peras.Crypto.html#3675" class="Record">VerificationKey</a> <a id="4229" class="Symbol">-&gt;</a> <a id="4232" href="Peras.Crypto.html#2161" class="Record">MembershipProof</a> <a id="4248" class="Symbol">-&gt;</a> <a id="4251" href="Agda.Builtin.Bool.html#173" class="Datatype">Bool</a>
<a id="4256" href="Peras.Crypto.html#4193" class="Function">isCommitteeMember</a> <a id="4274" class="Symbol">(</a><a id="4275" class="Keyword">record</a> <a id="4282" class="Symbol">{</a><a id="4283" href="Peras.Crypto.html#3743" class="Field">keyV</a> <a id="4288" class="Symbol">=</a> <a id="4290" href="Peras.Crypto.html#4290" class="Bound">verKey</a><a id="4296" class="Symbol">})</a> <a id="4299" class="Symbol">(</a><a id="4300" class="Keyword">record</a> <a id="4307" class="Symbol">{</a> <a id="4309" href="Peras.Crypto.html#2229" class="Field">proofM</a> <a id="4316" class="Symbol">=</a> <a id="4318" href="Peras.Crypto.html#4318" class="Bound">proof</a> <a id="4324" class="Symbol">})</a> <a id="4327" class="Symbol">=</a>
  <a id="4331" href="Peras.Crypto.html#4290" class="Bound">verKey</a> <a id="4338" href="Peras.Crypto.html#739" class="Postulate Operator">isInfixOf</a> <a id="4348" href="Peras.Crypto.html#4318" class="Bound">proof</a>

<a id="4355" class="Keyword">postulate</a> <a id="verify"></a><a id="4365" href="Peras.Crypto.html#4365" class="Postulate">verify</a> <a id="4372" class="Symbol">:</a> <a id="4374" href="Peras.Crypto.html#3675" class="Record">VerificationKey</a> <a id="4390" class="Symbol">-&gt;</a> <a id="4393" href="Peras.Crypto.html#3115" class="Record">Signature</a> <a id="4403" class="Symbol">-&gt;</a> <a id="4406" href="Peras.Crypto.html#657" class="Postulate">ByteString</a> <a id="4417" class="Symbol">-&gt;</a> <a id="4420" href="Agda.Builtin.Bool.html#173" class="Datatype">Bool</a>
</pre></body></html>