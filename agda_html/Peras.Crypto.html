<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Peras.Crypto</title><link rel="stylesheet" href="Agda.css"></head><body><pre class="Agda"><a id="1" class="Comment">-- | Cryptographic primitives types and functions used to implement /Peras/ protocol.</a>
<a id="87" class="Comment">--</a>
<a id="90" class="Comment">-- We don&#39;t use real cryptography here, just a bunch of newtypes and</a>
<a id="159" class="Comment">-- simple functions that represent various cryptographic operations</a>
<a id="227" class="Comment">-- one can do when running the protocol</a>
<a id="267" class="Keyword">module</a> <a id="274" href="Peras.Crypto.html" class="Module">Peras.Crypto</a> <a id="287" class="Keyword">where</a>

<a id="294" class="Keyword">open</a> <a id="299" class="Keyword">import</a> <a id="306" href="Data.Bool.html" class="Module">Data.Bool</a> <a id="316" class="Keyword">using</a> <a id="322" class="Symbol">(</a><a id="323" href="Agda.Builtin.Bool.html#173" class="Datatype">Bool</a><a id="327" class="Symbol">)</a>
<a id="329" class="Keyword">open</a> <a id="334" class="Keyword">import</a> <a id="341" href="Haskell.Prelude.html" class="Module">Haskell.Prelude</a> <a id="357" class="Keyword">using</a> <a id="363" class="Symbol">(</a><a id="364" href="Haskell.Prim.Eq.html#401" class="Record">Eq</a><a id="366" class="Symbol">;</a> <a id="368" href="Haskell.Prim.Int.html#367" class="Datatype">Int</a><a id="371" class="Symbol">;</a> <a id="373" href="Haskell.Prim.Eq.html#453" class="Field Operator">_==_</a><a id="377" class="Symbol">;</a> <a id="379" href="Haskell.Prim.Ord.html#1003" class="Record">Ord</a><a id="382" class="Symbol">;</a> <a id="384" href="Haskell.Prim.Ord.html#1041" class="Field">compare</a> <a id="392" class="Symbol">;</a> <a id="394" href="Haskell.Prim.Ord.html#466" class="Datatype">Ordering</a> <a id="403" class="Symbol">;</a> <a id="405" href="Haskell.Prim.Ord.html#1332" class="Function">ordFromCompare</a><a id="419" class="Symbol">)</a>
<a id="421" class="Keyword">open</a> <a id="426" class="Keyword">import</a> <a id="433" href="Relation.Binary.html" class="Module">Relation.Binary</a> <a id="449" class="Keyword">using</a> <a id="455" class="Symbol">(</a><a id="456" href="Relation.Binary.Definitions.html#6469" class="Function">DecidableEquality</a><a id="473" class="Symbol">)</a>
<a id="475" class="Keyword">open</a> <a id="480" class="Keyword">import</a> <a id="487" href="Relation.Binary.html" class="Module">Relation.Binary</a> <a id="503" class="Keyword">using</a> <a id="509" class="Symbol">(</a><a id="510" href="Relation.Binary.Bundles.html#8031" class="Record">StrictTotalOrder</a><a id="526" class="Symbol">)</a>

<a id="529" class="Comment">-- The following implementations are supplied in Haskell.</a>
<a id="587" class="Keyword">postulate</a>
  <a id="ByteString"></a><a id="599" href="Peras.Crypto.html#599" class="Postulate">ByteString</a> <a id="610" class="Symbol">:</a> <a id="612" href="Agda.Primitive.html#388" class="Primitive">Set</a>
  <a id="emptyBS"></a><a id="618" href="Peras.Crypto.html#618" class="Postulate">emptyBS</a> <a id="626" class="Symbol">:</a> <a id="628" href="Peras.Crypto.html#599" class="Postulate">ByteString</a>
  <a id="eqBS"></a><a id="641" href="Peras.Crypto.html#641" class="Postulate">eqBS</a> <a id="646" class="Symbol">:</a> <a id="648" href="Peras.Crypto.html#599" class="Postulate">ByteString</a> <a id="659" class="Symbol">→</a> <a id="661" href="Peras.Crypto.html#599" class="Postulate">ByteString</a> <a id="672" class="Symbol">→</a> <a id="674" href="Agda.Builtin.Bool.html#173" class="Datatype">Bool</a>
  <a id="_isInfixOf_"></a><a id="681" href="Peras.Crypto.html#681" class="Postulate Operator">_isInfixOf_</a> <a id="693" class="Symbol">:</a> <a id="695" href="Peras.Crypto.html#599" class="Postulate">ByteString</a> <a id="706" class="Symbol">→</a> <a id="708" href="Peras.Crypto.html#599" class="Postulate">ByteString</a> <a id="719" class="Symbol">→</a> <a id="721" href="Agda.Builtin.Bool.html#173" class="Datatype">Bool</a>
  <a id="replicateBS"></a><a id="728" href="Peras.Crypto.html#728" class="Postulate">replicateBS</a> <a id="740" class="Symbol">:</a> <a id="742" href="Haskell.Prim.Int.html#367" class="Datatype">Int</a> <a id="746" class="Symbol">→</a> <a id="748" href="Haskell.Prim.Int.html#367" class="Datatype">Int</a> <a id="752" class="Symbol">→</a> <a id="754" href="Peras.Crypto.html#599" class="Postulate">ByteString</a>
  <a id="_≟-BS_"></a><a id="767" href="Peras.Crypto.html#767" class="Postulate Operator">_≟-BS_</a> <a id="774" class="Symbol">:</a> <a id="776" href="Relation.Binary.Definitions.html#6469" class="Function">DecidableEquality</a> <a id="794" href="Peras.Crypto.html#599" class="Postulate">ByteString</a>
  <a id="compare-BS"></a><a id="807" href="Peras.Crypto.html#807" class="Postulate">compare-BS</a> <a id="818" class="Symbol">:</a> <a id="820" href="Peras.Crypto.html#599" class="Postulate">ByteString</a> <a id="831" class="Symbol">→</a> <a id="833" href="Peras.Crypto.html#599" class="Postulate">ByteString</a> <a id="844" class="Symbol">→</a> <a id="846" href="Haskell.Prim.Ord.html#466" class="Datatype">Ordering</a>


<a id="857" class="Symbol">{-#</a> <a id="861" class="Keyword">FOREIGN</a> <a id="869" class="Pragma">AGDA2HS</a>
<a id="877" class="Symbol">{-#</a> <a id="881" class="Pragma">LANGUAGE</a> <a id="890" class="Pragma">DeriveGeneric</a> <a id="904" class="Symbol">#-}</a>
<a id="908" class="Pragma">import</a> <a id="915" class="Pragma">Data.ByteString</a> <a id="931" class="Pragma">as</a> <a id="934" class="Pragma">BS</a>
<a id="937" class="Pragma">import</a> <a id="944" class="Pragma">Data.Word</a> <a id="954" class="Pragma">(Word8)</a>
<a id="962" class="Pragma">import</a> <a id="969" class="Pragma">GHC.Generics</a> <a id="982" class="Pragma">(Generic)</a>
<a id="992" class="Pragma">eqBS</a> <a id="997" class="Pragma">::</a> <a id="1000" class="Pragma">ByteString</a> <a id="1011" class="Pragma">-&gt;</a> <a id="1014" class="Pragma">ByteString</a> <a id="1025" class="Pragma">-&gt;</a> <a id="1028" class="Pragma">Bool</a>
<a id="1033" class="Pragma">eqBS</a> <a id="1038" class="Pragma">=</a> <a id="1040" class="Pragma">(==)</a>
<a id="1045" class="Pragma">replicateBS</a> <a id="1057" class="Pragma">::</a> <a id="1060" class="Pragma">Int</a> <a id="1064" class="Pragma">-&gt;</a> <a id="1067" class="Pragma">Word8</a> <a id="1073" class="Pragma">-&gt;</a> <a id="1076" class="Pragma">ByteString</a>
<a id="1087" class="Pragma">replicateBS</a> <a id="1099" class="Pragma">=</a> <a id="1101" class="Pragma">BS.replicate</a>
<a id="1114" class="Pragma">emptyBS</a> <a id="1122" class="Pragma">::</a> <a id="1125" class="Pragma">ByteString</a>
<a id="1136" class="Pragma">emptyBS</a> <a id="1144" class="Pragma">=</a> <a id="1146" class="Pragma">mempty</a>
<a id="1153" class="Symbol">#-}</a>

<a id="1158" class="Symbol">{-#</a> <a id="1162" class="Keyword">FOREIGN</a> <a id="1170" class="Pragma">GHC</a>
<a id="1174" class="Pragma">import</a> <a id="1181" class="Pragma">qualified</a> <a id="1191" class="Pragma">Data.ByteString</a> <a id="1207" class="Pragma">as</a> <a id="1210" class="Pragma">BS</a>
<a id="1213" class="Pragma">import</a> <a id="1220" class="Pragma">qualified</a> <a id="1230" class="Pragma">Peras.Crypto</a> <a id="1243" class="Pragma">as</a> <a id="1246" class="Pragma">G</a>
<a id="1248" class="Symbol">#-}</a>

<a id="1253" class="Symbol">{-#</a> <a id="1257" class="Keyword">COMPILE</a> <a id="1265" class="Keyword">GHC</a> <a id="1269" href="Peras.Crypto.html#599" class="Postulate">ByteString</a> <a id="1280" class="Pragma">=</a> <a id="1282" class="Pragma">type</a> <a id="1287" class="Pragma">BS.ByteString</a> <a id="1301" class="Symbol">#-}</a>
<a id="1305" class="Symbol">{-#</a> <a id="1309" class="Keyword">COMPILE</a> <a id="1317" class="Keyword">GHC</a> <a id="1321" href="Peras.Crypto.html#618" class="Postulate">emptyBS</a> <a id="1329" class="Pragma">=</a> <a id="1331" class="Pragma">BS.empty</a> <a id="1340" class="Symbol">#-}</a>
<a id="1344" class="Symbol">{-#</a> <a id="1348" class="Keyword">COMPILE</a> <a id="1356" class="Keyword">GHC</a> <a id="1360" href="Peras.Crypto.html#641" class="Postulate">eqBS</a> <a id="1365" class="Pragma">=</a> <a id="1367" class="Pragma">(==)</a> <a id="1372" class="Symbol">#-}</a>
<a id="1376" class="Symbol">{-#</a> <a id="1380" class="Keyword">COMPILE</a> <a id="1388" class="Keyword">GHC</a> <a id="1392" href="Peras.Crypto.html#681" class="Postulate Operator">_isInfixOf_</a> <a id="1404" class="Pragma">=</a> <a id="1406" class="Pragma">BS.isInfixOf</a> <a id="1419" class="Symbol">#-}</a>

<a id="1424" class="Keyword">record</a> <a id="Hash"></a><a id="1431" href="Peras.Crypto.html#1431" class="Record">Hash</a> <a id="1436" class="Symbol">(</a><a id="1437" href="Peras.Crypto.html#1437" class="Bound">a</a> <a id="1439" class="Symbol">:</a> <a id="1441" href="Agda.Primitive.html#388" class="Primitive">Set</a><a id="1444" class="Symbol">)</a> <a id="1446" class="Symbol">:</a> <a id="1448" href="Agda.Primitive.html#388" class="Primitive">Set</a> <a id="1452" class="Keyword">where</a>
  <a id="1460" class="Keyword">constructor</a> <a id="MkHash"></a><a id="1472" href="Peras.Crypto.html#1472" class="InductiveConstructor">MkHash</a>
  <a id="1481" class="Keyword">field</a> <a id="Hash.hashBytes"></a><a id="1487" href="Peras.Crypto.html#1487" class="Field">hashBytes</a> <a id="1497" class="Symbol">:</a> <a id="1499" href="Peras.Crypto.html#599" class="Postulate">ByteString</a>

<a id="1511" class="Keyword">open</a> <a id="1516" href="Peras.Crypto.html#1431" class="Module">Hash</a> <a id="1521" class="Keyword">public</a>

<a id="1529" class="Symbol">{-#</a> <a id="1533" class="Keyword">COMPILE</a> <a id="1541" class="Keyword">AGDA2HS</a> <a id="1549" href="Peras.Crypto.html#1431" class="Record">Hash</a> <a id="1554" class="Pragma">newtype</a> <a id="1562" class="Pragma">deriving</a> <a id="1571" class="Pragma">(Generic)</a> <a id="1581" class="Symbol">#-}</a>
<a id="1585" class="Symbol">{-#</a> <a id="1589" class="Keyword">COMPILE</a> <a id="1597" class="Keyword">GHC</a> <a id="1601" href="Peras.Crypto.html#1431" class="Record">Hash</a> <a id="1606" class="Pragma">=</a> <a id="1608" class="Pragma">data</a> <a id="1613" class="Pragma">G.Hash</a> <a id="1620" class="Pragma">(G.MkHash)</a> <a id="1631" class="Symbol">#-}</a>

<a id="1636" class="Keyword">instance</a>
  <a id="iHashEq"></a><a id="1647" href="Peras.Crypto.html#1647" class="Function">iHashEq</a> <a id="1655" class="Symbol">:</a> <a id="1657" class="Symbol">{</a><a id="1658" href="Peras.Crypto.html#1658" class="Bound">a</a> <a id="1660" class="Symbol">:</a> <a id="1662" href="Agda.Primitive.html#388" class="Primitive">Set</a><a id="1665" class="Symbol">}</a> <a id="1667" class="Symbol">→</a> <a id="1669" href="Haskell.Prim.Eq.html#401" class="Record">Eq</a> <a id="1672" class="Symbol">(</a><a id="1673" href="Peras.Crypto.html#1431" class="Record">Hash</a> <a id="1678" href="Peras.Crypto.html#1658" class="Bound">a</a><a id="1679" class="Symbol">)</a>
  <a id="1683" href="Peras.Crypto.html#1647" class="Function">iHashEq</a> <a id="1691" class="Symbol">.</a><a id="1692" href="Haskell.Prim.Eq.html#453" class="Field Operator">_==_</a> <a id="1697" href="Peras.Crypto.html#1697" class="Bound">x</a> <a id="1699" href="Peras.Crypto.html#1699" class="Bound">y</a> <a id="1701" class="Symbol">=</a> <a id="1703" href="Peras.Crypto.html#641" class="Postulate">eqBS</a> <a id="1708" class="Symbol">(</a><a id="1709" href="Peras.Crypto.html#1487" class="Field">hashBytes</a> <a id="1719" href="Peras.Crypto.html#1697" class="Bound">x</a><a id="1720" class="Symbol">)</a> <a id="1722" class="Symbol">(</a><a id="1723" href="Peras.Crypto.html#1487" class="Field">hashBytes</a> <a id="1733" href="Peras.Crypto.html#1699" class="Bound">y</a><a id="1734" class="Symbol">)</a>

<a id="1737" class="Symbol">{-#</a> <a id="1741" class="Keyword">COMPILE</a> <a id="1749" class="Keyword">AGDA2HS</a> <a id="1757" href="Peras.Crypto.html#1647" class="Function">iHashEq</a> <a id="1765" class="Symbol">#-}</a>

<a id="1770" class="Keyword">record</a> <a id="Hashable"></a><a id="1777" href="Peras.Crypto.html#1777" class="Record">Hashable</a> <a id="1786" class="Symbol">(</a><a id="1787" href="Peras.Crypto.html#1787" class="Bound">a</a> <a id="1789" class="Symbol">:</a> <a id="1791" href="Agda.Primitive.html#388" class="Primitive">Set</a><a id="1794" class="Symbol">)</a> <a id="1796" class="Symbol">:</a> <a id="1798" href="Agda.Primitive.html#388" class="Primitive">Set</a> <a id="1802" class="Keyword">where</a>
  <a id="1810" class="Keyword">field</a> <a id="Hashable.hash"></a><a id="1816" href="Peras.Crypto.html#1816" class="Field">hash</a> <a id="1821" class="Symbol">:</a> <a id="1823" href="Peras.Crypto.html#1787" class="Bound">a</a> <a id="1825" class="Symbol">→</a> <a id="1827" href="Peras.Crypto.html#1431" class="Record">Hash</a> <a id="1832" href="Peras.Crypto.html#1787" class="Bound">a</a>

<a id="1835" class="Symbol">{-#</a> <a id="1839" class="Keyword">COMPILE</a> <a id="1847" class="Keyword">AGDA2HS</a> <a id="1855" href="Peras.Crypto.html#1777" class="Record">Hashable</a> <a id="1864" class="Pragma">class</a> <a id="1870" class="Symbol">#-}</a>

<a id="1875" class="Comment">-- should use normal VRF algorithm like leadership membership</a>
<a id="1937" class="Keyword">record</a> <a id="MembershipProof"></a><a id="1944" href="Peras.Crypto.html#1944" class="Record">MembershipProof</a> <a id="1960" class="Symbol">:</a> <a id="1962" href="Agda.Primitive.html#388" class="Primitive">Set</a> <a id="1966" class="Keyword">where</a>
  <a id="1974" class="Keyword">constructor</a> <a id="MkMembershipProof"></a><a id="1986" href="Peras.Crypto.html#1986" class="InductiveConstructor">MkMembershipProof</a>
  <a id="2006" class="Keyword">field</a> <a id="MembershipProof.proofM"></a><a id="2012" href="Peras.Crypto.html#2012" class="Field">proofM</a> <a id="2019" class="Symbol">:</a> <a id="2021" href="Peras.Crypto.html#599" class="Postulate">ByteString</a>

<a id="2033" class="Keyword">open</a> <a id="2038" href="Peras.Crypto.html#1944" class="Module">MembershipProof</a> <a id="2054" class="Keyword">public</a>

<a id="2062" class="Symbol">{-#</a> <a id="2066" class="Keyword">COMPILE</a> <a id="2074" class="Keyword">AGDA2HS</a> <a id="2082" href="Peras.Crypto.html#1944" class="Record">MembershipProof</a> <a id="2098" class="Pragma">newtype</a> <a id="2106" class="Pragma">deriving</a> <a id="2115" class="Pragma">(Generic)</a> <a id="2125" class="Symbol">#-}</a>
<a id="2129" class="Symbol">{-#</a> <a id="2133" class="Keyword">COMPILE</a> <a id="2141" class="Keyword">GHC</a> <a id="2145" href="Peras.Crypto.html#1944" class="Record">MembershipProof</a> <a id="2161" class="Pragma">=</a> <a id="2163" class="Pragma">data</a> <a id="2168" class="Pragma">G.MembershipProof</a> <a id="2186" class="Pragma">(G.MkMembershipProof)</a> <a id="2208" class="Symbol">#-}</a>

<a id="2213" class="Keyword">instance</a>
  <a id="iMembershipProofEq"></a><a id="2224" href="Peras.Crypto.html#2224" class="Function">iMembershipProofEq</a> <a id="2243" class="Symbol">:</a> <a id="2245" href="Haskell.Prim.Eq.html#401" class="Record">Eq</a> <a id="2248" href="Peras.Crypto.html#1944" class="Record">MembershipProof</a>
  <a id="2266" href="Peras.Crypto.html#2224" class="Function">iMembershipProofEq</a> <a id="2285" class="Symbol">.</a><a id="2286" href="Haskell.Prim.Eq.html#453" class="Field Operator">_==_</a> <a id="2291" href="Peras.Crypto.html#2291" class="Bound">x</a> <a id="2293" href="Peras.Crypto.html#2293" class="Bound">y</a> <a id="2295" class="Symbol">=</a> <a id="2297" href="Peras.Crypto.html#641" class="Postulate">eqBS</a> <a id="2302" class="Symbol">(</a><a id="2303" href="Peras.Crypto.html#2012" class="Field">proofM</a> <a id="2310" href="Peras.Crypto.html#2291" class="Bound">x</a><a id="2311" class="Symbol">)</a> <a id="2313" class="Symbol">(</a><a id="2314" href="Peras.Crypto.html#2012" class="Field">proofM</a> <a id="2321" href="Peras.Crypto.html#2293" class="Bound">y</a><a id="2322" class="Symbol">)</a>

<a id="2325" class="Symbol">{-#</a> <a id="2329" class="Keyword">COMPILE</a> <a id="2337" class="Keyword">AGDA2HS</a> <a id="2345" href="Peras.Crypto.html#2224" class="Function">iMembershipProofEq</a> <a id="2364" class="Symbol">#-}</a>

<a id="2369" class="Keyword">record</a> <a id="LeadershipProof"></a><a id="2376" href="Peras.Crypto.html#2376" class="Record">LeadershipProof</a> <a id="2392" class="Symbol">:</a> <a id="2394" href="Agda.Primitive.html#388" class="Primitive">Set</a> <a id="2398" class="Keyword">where</a>
  <a id="2406" class="Keyword">constructor</a> <a id="MkLeadershipProof"></a><a id="2418" href="Peras.Crypto.html#2418" class="InductiveConstructor">MkLeadershipProof</a>
  <a id="2438" class="Keyword">field</a> <a id="LeadershipProof.proofL"></a><a id="2444" href="Peras.Crypto.html#2444" class="Field">proofL</a> <a id="2451" class="Symbol">:</a> <a id="2453" href="Peras.Crypto.html#599" class="Postulate">ByteString</a>

<a id="2465" class="Keyword">open</a> <a id="2470" href="Peras.Crypto.html#2376" class="Module">LeadershipProof</a> <a id="2486" class="Keyword">public</a>

<a id="2494" class="Symbol">{-#</a> <a id="2498" class="Keyword">COMPILE</a> <a id="2506" class="Keyword">AGDA2HS</a> <a id="2514" href="Peras.Crypto.html#2376" class="Record">LeadershipProof</a> <a id="2530" class="Pragma">newtype</a> <a id="2538" class="Pragma">deriving</a> <a id="2547" class="Pragma">(Generic)</a> <a id="2557" class="Symbol">#-}</a>
<a id="2561" class="Symbol">{-#</a> <a id="2565" class="Keyword">COMPILE</a> <a id="2573" class="Keyword">GHC</a> <a id="2577" href="Peras.Crypto.html#2376" class="Record">LeadershipProof</a> <a id="2593" class="Pragma">=</a> <a id="2595" class="Pragma">data</a> <a id="2600" class="Pragma">G.LeadershipProof</a> <a id="2618" class="Pragma">(G.MkLeadershipProof)</a> <a id="2640" class="Symbol">#-}</a>

<a id="2645" class="Keyword">instance</a>
  <a id="iLeadershipProofEq"></a><a id="2656" href="Peras.Crypto.html#2656" class="Function">iLeadershipProofEq</a> <a id="2675" class="Symbol">:</a> <a id="2677" href="Haskell.Prim.Eq.html#401" class="Record">Eq</a> <a id="2680" href="Peras.Crypto.html#2376" class="Record">LeadershipProof</a>
  <a id="2698" href="Peras.Crypto.html#2656" class="Function">iLeadershipProofEq</a> <a id="2717" class="Symbol">.</a><a id="2718" href="Haskell.Prim.Eq.html#453" class="Field Operator">_==_</a> <a id="2723" href="Peras.Crypto.html#2723" class="Bound">x</a> <a id="2725" href="Peras.Crypto.html#2725" class="Bound">y</a> <a id="2727" class="Symbol">=</a> <a id="2729" href="Peras.Crypto.html#641" class="Postulate">eqBS</a> <a id="2734" class="Symbol">(</a><a id="2735" href="Peras.Crypto.html#2444" class="Field">proofL</a> <a id="2742" href="Peras.Crypto.html#2723" class="Bound">x</a><a id="2743" class="Symbol">)</a> <a id="2745" class="Symbol">(</a><a id="2746" href="Peras.Crypto.html#2444" class="Field">proofL</a> <a id="2753" href="Peras.Crypto.html#2725" class="Bound">y</a><a id="2754" class="Symbol">)</a>

<a id="2757" class="Symbol">{-#</a> <a id="2761" class="Keyword">COMPILE</a> <a id="2769" class="Keyword">AGDA2HS</a> <a id="2777" href="Peras.Crypto.html#2656" class="Function">iLeadershipProofEq</a> <a id="2796" class="Symbol">#-}</a>

<a id="2801" class="Comment">{-
-- use KES-based signatures which weighs about 600 bytes (could be
-- down to 400)
-}</a>

<a id="2891" class="Keyword">record</a> <a id="Signature"></a><a id="2898" href="Peras.Crypto.html#2898" class="Record">Signature</a> <a id="2908" class="Symbol">:</a> <a id="2910" href="Agda.Primitive.html#388" class="Primitive">Set</a> <a id="2914" class="Keyword">where</a>
  <a id="2922" class="Keyword">constructor</a> <a id="MkSignature"></a><a id="2934" href="Peras.Crypto.html#2934" class="InductiveConstructor">MkSignature</a>
  <a id="2948" class="Keyword">field</a> <a id="Signature.bytesS"></a><a id="2954" href="Peras.Crypto.html#2954" class="Field">bytesS</a> <a id="2961" class="Symbol">:</a> <a id="2963" href="Peras.Crypto.html#599" class="Postulate">ByteString</a>

<a id="2975" class="Keyword">open</a> <a id="2980" href="Peras.Crypto.html#2898" class="Module">Signature</a> <a id="2990" class="Keyword">public</a>

<a id="2998" class="Symbol">{-#</a> <a id="3002" class="Keyword">COMPILE</a> <a id="3010" class="Keyword">AGDA2HS</a> <a id="3018" href="Peras.Crypto.html#2898" class="Record">Signature</a> <a id="3028" class="Pragma">newtype</a> <a id="3036" class="Pragma">deriving</a> <a id="3045" class="Pragma">(Generic)</a> <a id="3055" class="Symbol">#-}</a>
<a id="3059" class="Symbol">{-#</a> <a id="3063" class="Keyword">COMPILE</a> <a id="3071" class="Keyword">GHC</a> <a id="3075" href="Peras.Crypto.html#2898" class="Record">Signature</a> <a id="3085" class="Pragma">=</a> <a id="3087" class="Pragma">data</a> <a id="3092" class="Pragma">G.Signature</a> <a id="3104" class="Pragma">(G.MkSignature)</a> <a id="3120" class="Symbol">#-}</a>

<a id="compareSignature"></a><a id="3125" href="Peras.Crypto.html#3125" class="Function">compareSignature</a> <a id="3142" class="Symbol">:</a> <a id="3144" href="Peras.Crypto.html#2898" class="Record">Signature</a> <a id="3154" class="Symbol">-&gt;</a> <a id="3157" href="Peras.Crypto.html#2898" class="Record">Signature</a> <a id="3167" class="Symbol">-&gt;</a> <a id="3170" href="Haskell.Prim.Ord.html#466" class="Datatype">Ordering</a>
<a id="3179" href="Peras.Crypto.html#3125" class="Function">compareSignature</a> <a id="3196" href="Peras.Crypto.html#3196" class="Bound">x</a> <a id="3198" href="Peras.Crypto.html#3198" class="Bound">y</a> <a id="3200" class="Symbol">=</a> <a id="3202" href="Peras.Crypto.html#807" class="Postulate">compare-BS</a> <a id="3213" class="Symbol">(</a><a id="3214" href="Peras.Crypto.html#2954" class="Field">bytesS</a> <a id="3221" href="Peras.Crypto.html#3196" class="Bound">x</a><a id="3222" class="Symbol">)</a> <a id="3224" class="Symbol">(</a><a id="3225" href="Peras.Crypto.html#2954" class="Field">bytesS</a> <a id="3232" href="Peras.Crypto.html#3198" class="Bound">y</a><a id="3233" class="Symbol">)</a>

<a id="3236" class="Keyword">instance</a>
  <a id="iSignatureEq"></a><a id="3247" href="Peras.Crypto.html#3247" class="Function">iSignatureEq</a> <a id="3260" class="Symbol">:</a> <a id="3262" href="Haskell.Prim.Eq.html#401" class="Record">Eq</a> <a id="3265" href="Peras.Crypto.html#2898" class="Record">Signature</a>
  <a id="3277" href="Peras.Crypto.html#3247" class="Function">iSignatureEq</a> <a id="3290" class="Symbol">.</a><a id="3291" href="Haskell.Prim.Eq.html#453" class="Field Operator">_==_</a> <a id="3296" href="Peras.Crypto.html#3296" class="Bound">x</a> <a id="3298" href="Peras.Crypto.html#3298" class="Bound">y</a> <a id="3300" class="Symbol">=</a> <a id="3302" href="Peras.Crypto.html#641" class="Postulate">eqBS</a> <a id="3307" class="Symbol">(</a><a id="3308" href="Peras.Crypto.html#2954" class="Field">bytesS</a> <a id="3315" href="Peras.Crypto.html#3296" class="Bound">x</a><a id="3316" class="Symbol">)</a> <a id="3318" class="Symbol">(</a><a id="3319" href="Peras.Crypto.html#2954" class="Field">bytesS</a> <a id="3326" href="Peras.Crypto.html#3298" class="Bound">y</a><a id="3327" class="Symbol">)</a>

  <a id="iSignatureOrd"></a><a id="3332" href="Peras.Crypto.html#3332" class="Function">iSignatureOrd</a> <a id="3346" class="Symbol">:</a> <a id="3348" href="Haskell.Prim.Ord.html#1003" class="Record">Ord</a> <a id="3352" href="Peras.Crypto.html#2898" class="Record">Signature</a>
  <a id="3364" href="Peras.Crypto.html#3332" class="Function">iSignatureOrd</a> <a id="3378" class="Symbol">=</a> <a id="3380" href="Haskell.Prim.Ord.html#1332" class="Function">ordFromCompare</a> <a id="3395" href="Peras.Crypto.html#3125" class="Function">compareSignature</a>

<a id="3413" class="Symbol">{-#</a> <a id="3417" class="Keyword">COMPILE</a> <a id="3425" class="Keyword">AGDA2HS</a> <a id="3433" href="Peras.Crypto.html#3247" class="Function">iSignatureEq</a> <a id="3446" class="Symbol">#-}</a>

<a id="3451" class="Keyword">record</a> <a id="VerificationKey"></a><a id="3458" href="Peras.Crypto.html#3458" class="Record">VerificationKey</a> <a id="3474" class="Symbol">:</a> <a id="3476" href="Agda.Primitive.html#388" class="Primitive">Set</a> <a id="3480" class="Keyword">where</a>
  <a id="3488" class="Keyword">constructor</a> <a id="MkVerificationKey"></a><a id="3500" href="Peras.Crypto.html#3500" class="InductiveConstructor">MkVerificationKey</a>
  <a id="3520" class="Keyword">field</a> <a id="VerificationKey.keyV"></a><a id="3526" href="Peras.Crypto.html#3526" class="Field">keyV</a> <a id="3531" class="Symbol">:</a> <a id="3533" href="Peras.Crypto.html#599" class="Postulate">ByteString</a>

<a id="3545" class="Keyword">open</a> <a id="3550" href="Peras.Crypto.html#3458" class="Module">VerificationKey</a> <a id="3566" class="Keyword">public</a>

<a id="3574" class="Symbol">{-#</a> <a id="3578" class="Keyword">COMPILE</a> <a id="3586" class="Keyword">AGDA2HS</a> <a id="3594" href="Peras.Crypto.html#3458" class="Record">VerificationKey</a> <a id="3610" class="Pragma">newtype</a> <a id="3618" class="Pragma">deriving</a> <a id="3627" class="Pragma">(Generic)</a> <a id="3637" class="Symbol">#-}</a>
<a id="3641" class="Symbol">{-#</a> <a id="3645" class="Keyword">COMPILE</a> <a id="3653" class="Keyword">GHC</a> <a id="3657" href="Peras.Crypto.html#3458" class="Record">VerificationKey</a> <a id="3673" class="Pragma">=</a> <a id="3675" class="Pragma">data</a> <a id="3680" class="Pragma">G.VerificationKey</a> <a id="3698" class="Pragma">(G.MkVerificationKey)</a> <a id="3720" class="Symbol">#-}</a>

<a id="3725" class="Keyword">instance</a>
  <a id="iVerificationKeyEq"></a><a id="3736" href="Peras.Crypto.html#3736" class="Function">iVerificationKeyEq</a> <a id="3755" class="Symbol">:</a> <a id="3757" href="Haskell.Prim.Eq.html#401" class="Record">Eq</a> <a id="3760" href="Peras.Crypto.html#3458" class="Record">VerificationKey</a>
  <a id="3778" href="Peras.Crypto.html#3736" class="Function">iVerificationKeyEq</a> <a id="3797" class="Symbol">.</a><a id="3798" href="Haskell.Prim.Eq.html#453" class="Field Operator">_==_</a> <a id="3803" href="Peras.Crypto.html#3803" class="Bound">x</a> <a id="3805" href="Peras.Crypto.html#3805" class="Bound">y</a> <a id="3807" class="Symbol">=</a> <a id="3809" href="Peras.Crypto.html#641" class="Postulate">eqBS</a> <a id="3814" class="Symbol">(</a><a id="3815" href="Peras.Crypto.html#3526" class="Field">keyV</a> <a id="3820" href="Peras.Crypto.html#3803" class="Bound">x</a><a id="3821" class="Symbol">)</a> <a id="3823" class="Symbol">(</a><a id="3824" href="Peras.Crypto.html#3526" class="Field">keyV</a> <a id="3829" href="Peras.Crypto.html#3805" class="Bound">y</a><a id="3830" class="Symbol">)</a>

<a id="3833" class="Symbol">{-#</a> <a id="3837" class="Keyword">COMPILE</a> <a id="3845" class="Keyword">AGDA2HS</a> <a id="3853" href="Peras.Crypto.html#3736" class="Function">iVerificationKeyEq</a> <a id="3872" class="Symbol">#-}</a>

<a id="3877" class="Comment">-- | a fake membership &quot;proof&quot; is simply a concatenation of all the</a>
<a id="3945" class="Comment">-- members&#39; verification keys.</a>
<a id="isCommitteeMember"></a><a id="3976" href="Peras.Crypto.html#3976" class="Function">isCommitteeMember</a> <a id="3994" class="Symbol">:</a> <a id="3996" href="Peras.Crypto.html#3458" class="Record">VerificationKey</a> <a id="4012" class="Symbol">-&gt;</a> <a id="4015" href="Peras.Crypto.html#1944" class="Record">MembershipProof</a> <a id="4031" class="Symbol">-&gt;</a> <a id="4034" href="Agda.Builtin.Bool.html#173" class="Datatype">Bool</a>
<a id="4039" href="Peras.Crypto.html#3976" class="Function">isCommitteeMember</a> <a id="4057" class="Symbol">(</a><a id="4058" class="Keyword">record</a> <a id="4065" class="Symbol">{</a><a id="4066" href="Peras.Crypto.html#3526" class="Field">keyV</a> <a id="4071" class="Symbol">=</a> <a id="4073" href="Peras.Crypto.html#4073" class="Bound">verKey</a><a id="4079" class="Symbol">})</a> <a id="4082" class="Symbol">(</a><a id="4083" class="Keyword">record</a> <a id="4090" class="Symbol">{</a> <a id="4092" href="Peras.Crypto.html#2012" class="Field">proofM</a> <a id="4099" class="Symbol">=</a> <a id="4101" href="Peras.Crypto.html#4101" class="Bound">proof</a> <a id="4107" class="Symbol">})</a> <a id="4110" class="Symbol">=</a>
  <a id="4114" href="Peras.Crypto.html#4073" class="Bound">verKey</a> <a id="4121" href="Peras.Crypto.html#681" class="Postulate Operator">isInfixOf</a> <a id="4131" href="Peras.Crypto.html#4101" class="Bound">proof</a>

<a id="4138" class="Keyword">postulate</a> <a id="verify"></a><a id="4148" href="Peras.Crypto.html#4148" class="Postulate">verify</a> <a id="4155" class="Symbol">:</a> <a id="4157" href="Peras.Crypto.html#3458" class="Record">VerificationKey</a> <a id="4173" class="Symbol">-&gt;</a> <a id="4176" href="Peras.Crypto.html#2898" class="Record">Signature</a> <a id="4186" class="Symbol">-&gt;</a> <a id="4189" href="Peras.Crypto.html#599" class="Postulate">ByteString</a> <a id="4200" class="Symbol">-&gt;</a> <a id="4203" href="Agda.Builtin.Bool.html#173" class="Datatype">Bool</a>
</pre></body></html>