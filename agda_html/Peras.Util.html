<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Peras.Util</title><link rel="stylesheet" href="Agda.css"></head><body><pre class="Agda"><a id="1" class="Comment">-- | Utility functions</a>
<a id="24" class="Keyword">module</a> <a id="31" href="Peras.Util.html" class="Module">Peras.Util</a> <a id="42" class="Keyword">where</a>

<a id="49" class="Keyword">open</a> <a id="54" class="Keyword">import</a> <a id="61" href="Haskell.Prelude.html" class="Module">Haskell.Prelude</a>
<a id="77" class="Keyword">open</a> <a id="82" class="Keyword">import</a> <a id="89" href="Data.Nat.html" class="Module">Data.Nat</a> <a id="98" class="Keyword">using</a> <a id="104" class="Symbol">(</a><a id="105" href="Data.Nat.Base.html#3260" class="Record">NonZero</a><a id="112" class="Symbol">)</a>

<a id="uneraseNonZero"></a><a id="115" href="Peras.Util.html#115" class="Function">uneraseNonZero</a> <a id="130" class="Symbol">:</a> <a id="132" class="Symbol">∀</a> <a id="134" class="Symbol">{</a><a id="135" href="Peras.Util.html#135" class="Bound">n</a><a id="136" class="Symbol">}</a> <a id="138" class="Symbol">→</a> <a id="140" class="Symbol">@</a><a id="141" class="Symbol">0</a> <a id="143" href="Data.Nat.Base.html#3260" class="Record">NonZero</a> <a id="151" href="Peras.Util.html#135" class="Bound">n</a> <a id="153" class="Symbol">→</a> <a id="155" href="Data.Nat.Base.html#3260" class="Record">NonZero</a> <a id="163" href="Peras.Util.html#135" class="Bound">n</a>
<a id="165" href="Peras.Util.html#115" class="Function">uneraseNonZero</a> <a id="180" class="Symbol">{</a><a id="181" href="Agda.Builtin.Nat.html#221" class="InductiveConstructor">zero</a><a id="185" class="Symbol">}</a> <a id="187" class="Symbol">()</a>
<a id="190" href="Peras.Util.html#115" class="Function">uneraseNonZero</a> <a id="205" class="Symbol">{</a><a id="206" href="Agda.Builtin.Nat.html#234" class="InductiveConstructor">suc</a> <a id="210" href="Peras.Util.html#210" class="Bound">n</a><a id="211" class="Symbol">}</a> <a id="213" class="Symbol">_</a> <a id="215" class="Symbol">=</a> <a id="217" class="Symbol">_</a>

<a id="isJust"></a><a id="220" href="Peras.Util.html#220" class="Function">isJust</a> <a id="227" class="Symbol">:</a> <a id="229" href="Haskell.Prim.Maybe.html#101" class="Datatype">Maybe</a> <a id="235" href="Haskell.Prim.html#1191" class="Generalizable">a</a> <a id="237" class="Symbol">→</a> <a id="239" href="Haskell.Prim.Maybe.html#101" class="Datatype">Maybe</a> <a id="245" href="Agda.Builtin.Bool.html#173" class="Datatype">Bool</a>
<a id="250" href="Peras.Util.html#220" class="Function">isJust</a> <a id="257" class="Symbol">=</a> <a id="259" href="Haskell.Prim.Applicative.html#483" class="Field">pure</a> <a id="264" href="Haskell.Prim.html#1330" class="Function Operator">∘</a> <a id="266" href="Haskell.Prim.Maybe.html#186" class="Function">maybe</a> <a id="272" href="Agda.Builtin.Bool.html#192" class="InductiveConstructor">False</a> <a id="278" class="Symbol">(</a><a id="279" href="Haskell.Prim.html#1434" class="Function">const</a> <a id="285" href="Agda.Builtin.Bool.html#198" class="InductiveConstructor">True</a><a id="289" class="Symbol">)</a>

<a id="292" class="Symbol">{-#</a> <a id="296" class="Keyword">COMPILE</a> <a id="304" class="Keyword">AGDA2HS</a> <a id="312" href="Peras.Util.html#220" class="Function">isJust</a> <a id="319" class="Symbol">#-}</a>

<a id="catMaybes"></a><a id="324" href="Peras.Util.html#324" class="Function">catMaybes</a> <a id="334" class="Symbol">:</a> <a id="336" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="341" class="Symbol">(</a><a id="342" href="Haskell.Prim.Maybe.html#101" class="Datatype">Maybe</a> <a id="348" href="Haskell.Prim.html#1191" class="Generalizable">a</a><a id="349" class="Symbol">)</a> <a id="351" class="Symbol">→</a> <a id="353" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="358" href="Haskell.Prim.html#1191" class="Generalizable">a</a>
<a id="360" href="Peras.Util.html#324" class="Function">catMaybes</a> <a id="370" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a> <a id="373" class="Symbol">=</a> <a id="375" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a>
<a id="378" href="Peras.Util.html#324" class="Function">catMaybes</a> <a id="388" class="Symbol">(</a><a id="389" href="Haskell.Prim.Maybe.html#142" class="InductiveConstructor">Nothing</a> <a id="397" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="399" href="Peras.Util.html#399" class="Bound">xs</a><a id="401" class="Symbol">)</a> <a id="403" class="Symbol">=</a> <a id="405" href="Peras.Util.html#324" class="Function">catMaybes</a> <a id="415" href="Peras.Util.html#399" class="Bound">xs</a>
<a id="418" href="Peras.Util.html#324" class="Function">catMaybes</a> <a id="428" class="Symbol">(</a><a id="429" href="Haskell.Prim.Maybe.html#162" class="InductiveConstructor">Just</a> <a id="434" href="Peras.Util.html#434" class="Bound">x</a> <a id="436" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="438" href="Peras.Util.html#438" class="Bound">xs</a><a id="440" class="Symbol">)</a> <a id="442" class="Symbol">=</a> <a id="444" href="Peras.Util.html#434" class="Bound">x</a> <a id="446" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="448" href="Peras.Util.html#324" class="Function">catMaybes</a> <a id="458" href="Peras.Util.html#438" class="Bound">xs</a>

<a id="462" class="Symbol">{-#</a> <a id="466" class="Keyword">COMPILE</a> <a id="474" class="Keyword">AGDA2HS</a> <a id="482" href="Peras.Util.html#324" class="Function">catMaybes</a> <a id="492" class="Symbol">#-}</a>

<a id="maybeToList"></a><a id="497" href="Peras.Util.html#497" class="Function">maybeToList</a> <a id="509" class="Symbol">:</a> <a id="511" href="Haskell.Prim.Maybe.html#101" class="Datatype">Maybe</a> <a id="517" href="Haskell.Prim.html#1191" class="Generalizable">a</a> <a id="519" class="Symbol">→</a> <a id="521" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="526" href="Haskell.Prim.html#1191" class="Generalizable">a</a>
<a id="528" href="Peras.Util.html#497" class="Function">maybeToList</a> <a id="540" href="Haskell.Prim.Maybe.html#142" class="InductiveConstructor">Nothing</a> <a id="548" class="Symbol">=</a> <a id="550" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a>
<a id="553" href="Peras.Util.html#497" class="Function">maybeToList</a> <a id="565" class="Symbol">(</a><a id="566" href="Haskell.Prim.Maybe.html#162" class="InductiveConstructor">Just</a> <a id="571" href="Peras.Util.html#571" class="Bound">x</a><a id="572" class="Symbol">)</a> <a id="574" class="Symbol">=</a> <a id="576" href="Peras.Util.html#571" class="Bound">x</a> <a id="578" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="580" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a>

<a id="584" class="Symbol">{-#</a> <a id="588" class="Keyword">COMPILE</a> <a id="596" class="Keyword">AGDA2HS</a> <a id="604" href="Peras.Util.html#497" class="Function">maybeToList</a> <a id="616" class="Symbol">#-}</a>

<a id="listToMaybe"></a><a id="621" href="Peras.Util.html#621" class="Function">listToMaybe</a> <a id="633" class="Symbol">:</a> <a id="635" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="640" href="Haskell.Prim.html#1191" class="Generalizable">a</a> <a id="642" class="Symbol">→</a> <a id="644" href="Haskell.Prim.Maybe.html#101" class="Datatype">Maybe</a> <a id="650" href="Haskell.Prim.html#1191" class="Generalizable">a</a>
<a id="652" href="Peras.Util.html#621" class="Function">listToMaybe</a> <a id="664" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a> <a id="667" class="Symbol">=</a> <a id="669" href="Haskell.Prim.Maybe.html#142" class="InductiveConstructor">Nothing</a>
<a id="677" href="Peras.Util.html#621" class="Function">listToMaybe</a> <a id="689" class="Symbol">(</a><a id="690" href="Peras.Util.html#690" class="Bound">x</a> <a id="692" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="694" class="Symbol">_)</a> <a id="697" class="Symbol">=</a> <a id="699" href="Haskell.Prim.Maybe.html#162" class="InductiveConstructor">Just</a> <a id="704" href="Peras.Util.html#690" class="Bound">x</a>

<a id="707" class="Symbol">{-#</a> <a id="711" class="Keyword">COMPILE</a> <a id="719" class="Keyword">AGDA2HS</a> <a id="727" href="Peras.Util.html#621" class="Function">listToMaybe</a> <a id="739" class="Symbol">#-}</a>

<a id="maximumBy"></a><a id="744" href="Peras.Util.html#744" class="Function">maximumBy</a> <a id="754" class="Symbol">:</a> <a id="756" class="Symbol">{</a><a id="757" href="Peras.Util.html#757" class="Bound">a</a> <a id="759" class="Symbol">:</a> <a id="761" href="Agda.Primitive.html#388" class="Primitive">Set</a><a id="764" class="Symbol">}</a> <a id="766" class="Symbol">→</a> <a id="768" href="Peras.Util.html#757" class="Bound">a</a> <a id="770" class="Symbol">→</a> <a id="772" class="Symbol">(</a><a id="773" href="Peras.Util.html#757" class="Bound">a</a> <a id="775" class="Symbol">→</a> <a id="777" href="Peras.Util.html#757" class="Bound">a</a> <a id="779" class="Symbol">→</a> <a id="781" href="Haskell.Prim.Ord.html#466" class="Datatype">Ordering</a><a id="789" class="Symbol">)</a> <a id="791" class="Symbol">→</a> <a id="793" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="798" href="Peras.Util.html#757" class="Bound">a</a> <a id="800" class="Symbol">→</a> <a id="802" href="Peras.Util.html#757" class="Bound">a</a>
<a id="804" href="Peras.Util.html#744" class="Function">maximumBy</a> <a id="814" href="Peras.Util.html#814" class="Bound">candidate</a> <a id="824" class="Symbol">_</a> <a id="826" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a> <a id="829" class="Symbol">=</a> <a id="831" href="Peras.Util.html#814" class="Bound">candidate</a>
<a id="841" href="Peras.Util.html#744" class="Function">maximumBy</a> <a id="851" class="Symbol">{</a><a id="852" href="Peras.Util.html#852" class="Bound">a</a><a id="853" class="Symbol">}</a> <a id="855" href="Peras.Util.html#855" class="Bound">candidate</a> <a id="865" href="Peras.Util.html#865" class="Bound">f</a> <a id="867" class="Symbol">(</a><a id="868" href="Peras.Util.html#868" class="Bound">x</a> <a id="870" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="872" href="Peras.Util.html#872" class="Bound">xs</a><a id="874" class="Symbol">)</a> <a id="876" class="Symbol">=</a>
  <a id="880" href="Haskell.Prim.html#1609" class="Function Operator">case</a> <a id="885" href="Peras.Util.html#865" class="Bound">f</a> <a id="887" href="Peras.Util.html#855" class="Bound">candidate</a> <a id="897" href="Peras.Util.html#868" class="Bound">x</a> <a id="899" href="Haskell.Prim.html#1609" class="Function Operator">of</a> <a id="902" class="Symbol">λ</a> <a id="904" class="Keyword">where</a>
    <a id="914" href="Haskell.Prim.Ord.html#495" class="InductiveConstructor">GT</a> <a id="917" class="Symbol">→</a> <a id="919" href="Peras.Util.html#744" class="Function">maximumBy</a> <a id="929" href="Peras.Util.html#855" class="Bound">candidate</a> <a id="939" href="Peras.Util.html#865" class="Bound">f</a> <a id="941" href="Peras.Util.html#872" class="Bound">xs</a>
    <a id="948" class="CatchallClause Symbol">_</a> <a id="950" class="Symbol">→</a> <a id="952" href="Peras.Util.html#744" class="Function">maximumBy</a> <a id="962" href="Peras.Util.html#868" class="Bound">x</a> <a id="964" href="Peras.Util.html#865" class="Bound">f</a> <a id="966" href="Peras.Util.html#872" class="Bound">xs</a>
<a id="969" class="Symbol">{-#</a> <a id="973" class="Keyword">COMPILE</a> <a id="981" class="Keyword">AGDA2HS</a> <a id="989" href="Peras.Util.html#744" class="Function">maximumBy</a> <a id="999" class="Symbol">#-}</a>

<a id="comparing"></a><a id="1004" href="Peras.Util.html#1004" class="Function">comparing</a> <a id="1014" class="Symbol">:</a> <a id="1016" class="Symbol">⦃</a> <a id="1018" href="Haskell.Prim.Ord.html#1003" class="Record">Ord</a> <a id="1022" href="Haskell.Prim.html#1193" class="Generalizable">b</a> <a id="1024" class="Symbol">⦄</a> <a id="1026" class="Symbol">→</a> <a id="1028" class="Symbol">(</a><a id="1029" href="Haskell.Prim.html#1191" class="Generalizable">a</a> <a id="1031" class="Symbol">→</a> <a id="1033" href="Haskell.Prim.html#1193" class="Generalizable">b</a><a id="1034" class="Symbol">)</a> <a id="1036" class="Symbol">→</a> <a id="1038" href="Haskell.Prim.html#1191" class="Generalizable">a</a> <a id="1040" class="Symbol">→</a> <a id="1042" href="Haskell.Prim.html#1191" class="Generalizable">a</a> <a id="1044" class="Symbol">→</a> <a id="1046" href="Haskell.Prim.Ord.html#466" class="Datatype">Ordering</a>
<a id="1055" href="Peras.Util.html#1004" class="Function">comparing</a> <a id="1065" href="Peras.Util.html#1065" class="Bound">f</a> <a id="1067" href="Peras.Util.html#1067" class="Bound">x</a> <a id="1069" href="Peras.Util.html#1069" class="Bound">y</a> <a id="1071" class="Symbol">=</a> <a id="1073" href="Haskell.Prim.Ord.html#1041" class="Field">compare</a> <a id="1081" class="Symbol">(</a><a id="1082" href="Peras.Util.html#1065" class="Bound">f</a> <a id="1084" href="Peras.Util.html#1067" class="Bound">x</a><a id="1085" class="Symbol">)</a> <a id="1087" class="Symbol">(</a><a id="1088" href="Peras.Util.html#1065" class="Bound">f</a> <a id="1090" href="Peras.Util.html#1069" class="Bound">y</a><a id="1091" class="Symbol">)</a>
<a id="1093" class="Symbol">{-#</a> <a id="1097" class="Keyword">COMPILE</a> <a id="1105" class="Keyword">AGDA2HS</a> <a id="1113" href="Peras.Util.html#1004" class="Function">comparing</a> <a id="1123" class="Symbol">#-}</a>
</pre></body></html>