<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>Peras.Block</title>
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    /* The extra [class] is a hack that increases specificity enough to
       override a similar rule in reveal.js */
    ul.task-list[class]{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      font-size: inherit;
      width: 0.8em;
      margin: 0 0.8em 0.2em -1.6em;
      vertical-align: middle;
    }
    .display.math{display: block; text-align: center; margin: 0.5rem auto;}
  </style>
  <link rel="stylesheet" href="Agda.css" />
  <!--[if lt IE 9]>
    <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
  <![endif]-->
</head>
<body>
<pre class="Agda"><a id="9" class="Keyword">module</a> <a id="16" href="Peras.Block.html" class="Module">Peras.Block</a> <a id="28" class="Keyword">where</a>
</pre>
<!--
<pre class="Agda"><a id="52" class="Keyword">open</a> <a id="57" class="Keyword">import</a> <a id="64" href="Haskell.Prelude.html" class="Module">Haskell.Prelude</a>

<a id="81" class="Keyword">open</a> <a id="86" class="Keyword">import</a> <a id="93" href="Data.Product.html" class="Module">Data.Product</a> <a id="106" class="Keyword">using</a> <a id="112" class="Symbol">(</a><a id="113" href="Data.Product.Base.html#852" class="Function">∃</a><a id="114" class="Symbol">;</a> <a id="116" href="Data.Product.Base.html#1371" class="Function">∃-syntax</a><a id="124" class="Symbol">)</a>

<a id="127" class="Keyword">open</a> <a id="132" class="Keyword">import</a> <a id="139" href="Peras.Crypto.html" class="Module">Peras.Crypto</a>
<a id="152" class="Keyword">open</a> <a id="157" class="Keyword">import</a> <a id="164" href="Peras.Numbering.html" class="Module">Peras.Numbering</a>
<a id="180" class="Keyword">open</a> <a id="185" class="Keyword">import</a> <a id="192" href="Peras.Util.html" class="Module">Peras.Util</a>

<a id="204" class="Symbol">{-#</a> <a id="208" class="Keyword">FOREIGN</a> <a id="216" class="Pragma">AGDA2HS</a>
<a id="224" class="Symbol">{-#</a> <a id="228" class="Pragma">LANGUAGE</a> <a id="237" class="Pragma">DeriveGeneric</a> <a id="251" class="Symbol">#-}</a>
<a id="255" class="Symbol">{-#</a> <a id="259" class="Pragma">OPTIONS_GHC</a> <a id="271" class="Pragma">-fno-warn-missing-pattern-synonym-signatures</a> <a id="316" class="Symbol">#-}</a>
<a id="320" class="Symbol">{-#</a> <a id="324" class="Pragma">OPTIONS_GHC</a> <a id="336" class="Pragma">-fno-warn-missing-signatures</a> <a id="365" class="Symbol">#-}</a>
<a id="369" class="Symbol">{-#</a> <a id="373" class="Pragma">OPTIONS_GHC</a> <a id="385" class="Pragma">-fno-warn-name-shadowing</a> <a id="410" class="Symbol">#-}</a>
<a id="414" class="Symbol">{-#</a> <a id="418" class="Pragma">OPTIONS_GHC</a> <a id="430" class="Pragma">-fno-warn-type-defaults</a> <a id="454" class="Symbol">#-}</a>
<a id="458" class="Symbol">{-#</a> <a id="462" class="Pragma">OPTIONS_GHC</a> <a id="474" class="Pragma">-fno-warn-unused-imports</a> <a id="499" class="Symbol">#-}</a>
<a id="503" class="Symbol">{-#</a> <a id="507" class="Pragma">OPTIONS_GHC</a> <a id="519" class="Pragma">-fno-warn-unused-matches</a> <a id="544" class="Symbol">#-}</a>
<a id="548" class="Pragma">import</a> <a id="555" class="Pragma">GHC.Generics</a> <a id="568" class="Pragma">(Generic)</a>
<a id="578" class="Pragma">import</a> <a id="585" class="Pragma">Peras.Crypto</a> <a id="598" class="Pragma">(Hash</a> <a id="604" class="Pragma">(..),</a> <a id="610" class="Pragma">Hashable</a> <a id="619" class="Pragma">(..))</a>
<a id="625" class="Pragma">import</a> <a id="632" class="Pragma">Prelude</a> <a id="640" class="Pragma">hiding</a> <a id="647" class="Pragma">(round)</a>
<a id="655" class="Symbol">#-}</a>

<a id="660" class="Symbol">{-#</a> <a id="664" class="Keyword">FOREIGN</a> <a id="672" class="Pragma">GHC</a>
<a id="676" class="Pragma">import</a> <a id="683" class="Pragma">qualified</a> <a id="693" class="Pragma">Peras.Block</a> <a id="705" class="Pragma">as</a> <a id="708" class="Pragma">G</a>
<a id="710" class="Symbol">#-}</a>
</pre>-->
<h2 id="partyid">PartyId</h2>
<pre class="Agda"><a id="PartyId"></a><a id="743" href="Peras.Block.html#743" class="Function">PartyId</a> <a id="751" class="Symbol">=</a> <a id="753" href="Agda.Builtin.Nat.html#203" class="Datatype">Nat</a>
</pre>
<!--
<pre class="Agda"><a id="775" class="Symbol">{-#</a> <a id="779" class="Keyword">FOREIGN</a> <a id="787" class="Pragma">AGDA2HS</a>
<a id="795" class="Pragma">--</a> <a id="798" class="Pragma">Use</a> <a id="802" class="Pragma">`Integer`</a> <a id="812" class="Pragma">for</a> <a id="816" class="Pragma">compatibility</a> <a id="830" class="Pragma">with</a> <a id="835" class="Pragma">`MAlonzo`.</a>
<a id="846" class="Pragma">type</a> <a id="851" class="Pragma">PartyId</a> <a id="859" class="Pragma">=</a> <a id="861" class="Pragma">Integer</a>
<a id="869" class="Symbol">#-}</a>
</pre>-->
<h2 id="party">Party</h2>
<pre class="Agda"><a id="900" class="Keyword">record</a> <a id="Party"></a><a id="907" href="Peras.Block.html#907" class="Record">Party</a> <a id="913" class="Symbol">:</a> <a id="915" href="Agda.Primitive.html#388" class="Primitive">Set</a> <a id="919" class="Keyword">where</a>
  <a id="927" class="Keyword">constructor</a> <a id="MkParty"></a><a id="939" href="Peras.Block.html#939" class="InductiveConstructor">MkParty</a>
  <a id="949" class="Keyword">field</a> <a id="Party.pid"></a><a id="955" href="Peras.Block.html#955" class="Field">pid</a> <a id="959" class="Symbol">:</a> <a id="961" href="Peras.Block.html#743" class="Function">PartyId</a>
        <a id="Party.pkey"></a><a id="977" href="Peras.Block.html#977" class="Field">pkey</a> <a id="982" class="Symbol">:</a> <a id="984" href="Peras.Crypto.html#3968" class="Record">VerificationKey</a>

<a id="1001" class="Keyword">open</a> <a id="1006" href="Peras.Block.html#907" class="Module">Party</a> <a id="1012" class="Keyword">public</a>

<a id="1020" class="Keyword">instance</a>
  <a id="iPartyEq"></a><a id="1031" href="Peras.Block.html#1031" class="Function">iPartyEq</a> <a id="1040" class="Symbol">:</a> <a id="1042" href="Haskell.Prim.Eq.html#401" class="Record">Eq</a> <a id="1045" href="Peras.Block.html#907" class="Record">Party</a>
  <a id="1053" href="Peras.Block.html#1031" class="Function">iPartyEq</a> <a id="1062" class="Symbol">.</a><a id="1063" href="Haskell.Prim.Eq.html#453" class="Field Operator">_==_</a> <a id="1068" href="Peras.Block.html#1068" class="Bound">x</a> <a id="1070" href="Peras.Block.html#1070" class="Bound">y</a> <a id="1072" class="Symbol">=</a> <a id="1074" href="Peras.Block.html#955" class="Field">pid</a> <a id="1078" href="Peras.Block.html#1068" class="Bound">x</a> <a id="1080" href="Haskell.Prim.Eq.html#453" class="Field Operator">==</a> <a id="1083" href="Peras.Block.html#955" class="Field">pid</a> <a id="1087" href="Peras.Block.html#1070" class="Bound">y</a> <a id="1089" href="Haskell.Prim.Bool.html#138" class="Function Operator">&amp;&amp;</a> <a id="1092" href="Peras.Block.html#977" class="Field">pkey</a> <a id="1097" href="Peras.Block.html#1068" class="Bound">x</a> <a id="1099" href="Haskell.Prim.Eq.html#453" class="Field Operator">==</a> <a id="1102" href="Peras.Block.html#977" class="Field">pkey</a> <a id="1107" href="Peras.Block.html#1070" class="Bound">y</a>
</pre>
<!--
<pre class="Agda"><a id="1127" class="Symbol">{-#</a> <a id="1131" class="Keyword">COMPILE</a> <a id="1139" class="Keyword">AGDA2HS</a> <a id="1147" href="Peras.Block.html#907" class="Record">Party</a> <a id="1153" class="Pragma">deriving</a> <a id="1162" class="Pragma">(Generic)</a> <a id="1172" class="Symbol">#-}</a>
<a id="1176" class="Symbol">{-#</a> <a id="1180" class="Keyword">COMPILE</a> <a id="1188" class="Keyword">GHC</a> <a id="1192" href="Peras.Block.html#907" class="Record">Party</a> <a id="1198" class="Pragma">=</a> <a id="1200" class="Pragma">data</a> <a id="1205" class="Pragma">G.Party</a> <a id="1213" class="Pragma">(G.MkParty)</a> <a id="1225" class="Symbol">#-}</a>
<a id="1229" class="Symbol">{-#</a> <a id="1233" class="Keyword">COMPILE</a> <a id="1241" class="Keyword">AGDA2HS</a> <a id="1249" href="Peras.Block.html#1031" class="Function">iPartyEq</a> <a id="1258" class="Symbol">#-}</a>
</pre>-->
<h2 id="honesty-of-a-party">Honesty of a party</h2>
<pre class="Agda"><a id="1302" class="Keyword">data</a> <a id="Honesty"></a><a id="1307" href="Peras.Block.html#1307" class="Datatype">Honesty</a> <a id="1315" class="Symbol">:</a> <a id="1317" href="Peras.Block.html#743" class="Function">PartyId</a> <a id="1325" class="Symbol">→</a> <a id="1327" href="Agda.Primitive.html#388" class="Primitive">Set</a> <a id="1331" class="Keyword">where</a>

  <a id="Honesty.Honest"></a><a id="1340" href="Peras.Block.html#1340" class="InductiveConstructor">Honest</a> <a id="1347" class="Symbol">:</a> <a id="1349" class="Symbol">∀</a> <a id="1351" class="Symbol">{</a><a id="1352" href="Peras.Block.html#1352" class="Bound">p</a> <a id="1354" class="Symbol">:</a> <a id="1356" href="Peras.Block.html#743" class="Function">PartyId</a><a id="1363" class="Symbol">}</a>
    <a id="1369" class="Symbol">→</a> <a id="1371" href="Peras.Block.html#1307" class="Datatype">Honesty</a> <a id="1379" href="Peras.Block.html#1352" class="Bound">p</a>

  <a id="Honesty.Corrupt"></a><a id="1384" href="Peras.Block.html#1384" class="InductiveConstructor">Corrupt</a> <a id="1392" class="Symbol">:</a> <a id="1394" class="Symbol">∀</a> <a id="1396" class="Symbol">{</a><a id="1397" href="Peras.Block.html#1397" class="Bound">p</a> <a id="1399" class="Symbol">:</a> <a id="1401" href="Peras.Block.html#743" class="Function">PartyId</a><a id="1408" class="Symbol">}</a>
    <a id="1414" class="Symbol">→</a> <a id="1416" href="Peras.Block.html#1307" class="Datatype">Honesty</a> <a id="1424" href="Peras.Block.html#1397" class="Bound">p</a>
</pre>
<pre class="Agda"><a id="PartyTup"></a><a id="1439" href="Peras.Block.html#1439" class="Function">PartyTup</a> <a id="1448" class="Symbol">=</a> <a id="1450" href="Data.Product.Base.html#1371" class="Function">∃[</a> <a id="1453" href="Peras.Block.html#1453" class="Bound">p</a> <a id="1455" href="Data.Product.Base.html#1371" class="Function">]</a> <a id="1457" class="Symbol">(</a><a id="1458" href="Peras.Block.html#1307" class="Datatype">Honesty</a> <a id="1466" href="Peras.Block.html#1453" class="Bound">p</a><a id="1467" class="Symbol">)</a>
<a id="Parties"></a><a id="1469" href="Peras.Block.html#1469" class="Function">Parties</a> <a id="1477" class="Symbol">=</a> <a id="1479" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="1484" href="Peras.Block.html#1439" class="Function">PartyTup</a>
</pre>
<h2 id="transactions">Transactions</h2>
<pre class="Agda"><a id="Tx"></a><a id="1523" href="Peras.Block.html#1523" class="Function">Tx</a> <a id="1526" class="Symbol">=</a> <a id="1528" href="Agda.Builtin.Unit.html#175" class="Record">⊤</a>
</pre>
<!--
<pre class="Agda"><a id="1548" class="Symbol">{-#</a> <a id="1552" class="Keyword">COMPILE</a> <a id="1560" class="Keyword">AGDA2HS</a> <a id="1568" href="Peras.Block.html#1523" class="Function">Tx</a> <a id="1571" class="Symbol">#-}</a>
</pre>-->
<h2 id="block-and-certificate">Block and Certificate</h2>
<p>In addition to a Praos block, there is an optional field for the
included certificate. <strong>Note</strong>: What we name
<code>Block</code> is actually a block <em>Header</em>, we use
<code>BlockBody</code> to contain the payload.</p>
<p>A Peras Certificate represents an aggregated quorum of votes for a
specific block at a specific round. Such a certificate is supposed to be
self-contained and verifiable by any node.</p>
<pre class="Agda"><a id="1994" class="Keyword">record</a> <a id="Block"></a><a id="2001" href="Peras.Block.html#2001" class="Record">Block</a> <a id="2007" class="Symbol">:</a> <a id="2009" href="Agda.Primitive.html#388" class="Primitive">Set</a>
<a id="2013" class="Keyword">record</a> <a id="BlockBody"></a><a id="2020" href="Peras.Block.html#2020" class="Record">BlockBody</a> <a id="2030" class="Symbol">:</a> <a id="2032" href="Agda.Primitive.html#388" class="Primitive">Set</a>
<a id="2036" class="Keyword">record</a> <a id="Certificate"></a><a id="2043" href="Peras.Block.html#2043" class="Record">Certificate</a> <a id="2055" class="Symbol">:</a> <a id="2057" href="Agda.Primitive.html#388" class="Primitive">Set</a>

<a id="Payload"></a><a id="2062" href="Peras.Block.html#2062" class="Function">Payload</a> <a id="2070" class="Symbol">=</a> <a id="2072" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="2077" href="Peras.Block.html#1523" class="Function">Tx</a>

<a id="2081" class="Keyword">record</a> <a id="2088" href="Peras.Block.html#2043" class="Record">Certificate</a> <a id="2100" class="Keyword">where</a>
  <a id="2108" class="Keyword">constructor</a> <a id="MkCertificate"></a><a id="2120" href="Peras.Block.html#2120" class="InductiveConstructor">MkCertificate</a>
  <a id="2136" class="Keyword">pattern</a>
  <a id="2146" class="Keyword">field</a> <a id="Certificate.round"></a><a id="2152" href="Peras.Block.html#2152" class="Field">round</a> <a id="2158" class="Symbol">:</a> <a id="2160" href="Peras.Numbering.html#1962" class="Record">RoundNumber</a>
        <a id="Certificate.blockRef"></a><a id="2180" href="Peras.Block.html#2180" class="Field">blockRef</a> <a id="2189" class="Symbol">:</a> <a id="2191" href="Peras.Crypto.html#1835" class="Record">Hash</a> <a id="2196" href="Peras.Block.html#2001" class="Record">Block</a>

  <a id="Certificate.roundNumber"></a><a id="2205" href="Peras.Block.html#2205" class="Function">roundNumber</a> <a id="2217" class="Symbol">:</a> <a id="2219" href="Agda.Builtin.Nat.html#203" class="Datatype">Nat</a>
  <a id="2225" href="Peras.Block.html#2205" class="Function">roundNumber</a> <a id="2237" class="Symbol">=</a> <a id="2239" href="Peras.Numbering.html#2022" class="Field">getRoundNumber</a> <a id="2254" href="Peras.Block.html#2152" class="Field">round</a>

<a id="2261" class="Keyword">open</a> <a id="2266" href="Peras.Block.html#2043" class="Module">Certificate</a> <a id="2278" class="Keyword">public</a>

<a id="latestCert"></a><a id="2286" href="Peras.Block.html#2286" class="Function">latestCert</a> <a id="2297" class="Symbol">:</a> <a id="2299" href="Peras.Block.html#2043" class="Record">Certificate</a> <a id="2311" class="Symbol">→</a> <a id="2313" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="2318" href="Peras.Block.html#2043" class="Record">Certificate</a> <a id="2330" class="Symbol">→</a> <a id="2332" href="Peras.Block.html#2043" class="Record">Certificate</a>
<a id="2344" href="Peras.Block.html#2286" class="Function">latestCert</a> <a id="2355" href="Peras.Block.html#2355" class="Bound">c</a> <a id="2357" class="Symbol">=</a> <a id="2359" href="Peras.Util.html#1032" class="Function">maximumBy</a> <a id="2369" href="Peras.Block.html#2355" class="Bound">c</a> <a id="2371" class="Symbol">(</a><a id="2372" href="Peras.Util.html#1292" class="Function">comparing</a> <a id="2382" href="Peras.Block.html#2152" class="Field">round</a><a id="2387" class="Symbol">)</a>

<a id="2390" class="Keyword">record</a> <a id="2397" href="Peras.Block.html#2001" class="Record">Block</a> <a id="2403" class="Keyword">where</a>
  <a id="2411" class="Keyword">constructor</a> <a id="MkBlock"></a><a id="2423" href="Peras.Block.html#2423" class="InductiveConstructor">MkBlock</a>
  <a id="2433" class="Keyword">field</a> <a id="Block.slotNumber"></a><a id="2439" href="Peras.Block.html#2439" class="Field">slotNumber</a> <a id="2450" class="Symbol">:</a> <a id="2452" href="Peras.Numbering.html#1035" class="Record">SlotNumber</a>
        <a id="Block.creatorId"></a><a id="2471" href="Peras.Block.html#2471" class="Field">creatorId</a> <a id="2481" class="Symbol">:</a> <a id="2483" href="Peras.Block.html#743" class="Function">PartyId</a>
        <a id="Block.parentBlock"></a><a id="2499" href="Peras.Block.html#2499" class="Field">parentBlock</a> <a id="2511" class="Symbol">:</a> <a id="2513" href="Peras.Crypto.html#1835" class="Record">Hash</a> <a id="2518" href="Peras.Block.html#2001" class="Record">Block</a>
        <a id="Block.certificate"></a><a id="2532" href="Peras.Block.html#2532" class="Field">certificate</a> <a id="2544" class="Symbol">:</a> <a id="2546" href="Haskell.Prim.Maybe.html#101" class="Datatype">Maybe</a> <a id="2552" href="Peras.Block.html#2043" class="Record">Certificate</a>
        <a id="Block.leadershipProof"></a><a id="2572" href="Peras.Block.html#2572" class="Field">leadershipProof</a> <a id="2588" class="Symbol">:</a> <a id="2590" href="Peras.Crypto.html#2886" class="Record">LeadershipProof</a>
        <a id="Block.signature"></a><a id="2614" href="Peras.Block.html#2614" class="Field">signature</a> <a id="2624" class="Symbol">:</a> <a id="2626" href="Peras.Crypto.html#3408" class="Record">Signature</a>
        <a id="Block.bodyHash"></a><a id="2644" href="Peras.Block.html#2644" class="Field">bodyHash</a> <a id="2653" class="Symbol">:</a> <a id="2655" href="Peras.Crypto.html#1835" class="Record">Hash</a> <a id="2660" href="Peras.Block.html#2062" class="Function">Payload</a>

  <a id="Block.slotNumber&#39;"></a><a id="2671" href="Peras.Block.html#2671" class="Function">slotNumber&#39;</a> <a id="2683" class="Symbol">:</a> <a id="2685" href="Agda.Builtin.Nat.html#203" class="Datatype">Nat</a>
  <a id="2691" href="Peras.Block.html#2671" class="Function">slotNumber&#39;</a> <a id="2703" class="Symbol">=</a> <a id="2705" href="Peras.Numbering.html#1093" class="Field">getSlotNumber</a> <a id="2719" href="Peras.Block.html#2439" class="Field">slotNumber</a>

<a id="2731" class="Keyword">open</a> <a id="2736" href="Peras.Block.html#2001" class="Module">Block</a> <a id="2742" class="Keyword">public</a>

<a id="2750" class="Keyword">record</a> <a id="2757" href="Peras.Block.html#2020" class="Record">BlockBody</a> <a id="2767" class="Keyword">where</a>
  <a id="2775" class="Keyword">constructor</a> <a id="MkBlockBody"></a><a id="2787" href="Peras.Block.html#2787" class="InductiveConstructor">MkBlockBody</a>
  <a id="2801" class="Keyword">field</a> <a id="BlockBody.blockHash"></a><a id="2807" href="Peras.Block.html#2807" class="Field">blockHash</a> <a id="2817" class="Symbol">:</a> <a id="2819" href="Peras.Crypto.html#1835" class="Record">Hash</a> <a id="2824" href="Peras.Block.html#2062" class="Function">Payload</a>
        <a id="BlockBody.payload"></a><a id="2840" href="Peras.Block.html#2840" class="Field">payload</a> <a id="2848" class="Symbol">:</a> <a id="2850" href="Peras.Block.html#2062" class="Function">Payload</a>

<a id="2859" class="Keyword">open</a> <a id="2864" href="Peras.Block.html#2020" class="Module">BlockBody</a> <a id="2874" class="Keyword">public</a>
</pre>
<!--
<pre class="Agda"><a id="2898" class="Symbol">{-#</a> <a id="2902" class="Keyword">COMPILE</a> <a id="2910" class="Keyword">AGDA2HS</a> <a id="2918" href="Peras.Block.html#2062" class="Function">Payload</a> <a id="2926" class="Symbol">#-}</a>
<a id="2930" class="Symbol">{-#</a> <a id="2934" class="Keyword">COMPILE</a> <a id="2942" class="Keyword">AGDA2HS</a> <a id="2950" href="Peras.Block.html#2001" class="Record">Block</a> <a id="2956" class="Pragma">deriving</a> <a id="2965" class="Pragma">(Generic)</a> <a id="2975" class="Symbol">#-}</a>
<a id="2979" class="Symbol">{-#</a> <a id="2983" class="Keyword">COMPILE</a> <a id="2991" class="Keyword">GHC</a> <a id="2995" href="Peras.Block.html#2001" class="Record">Block</a> <a id="3001" class="Pragma">=</a> <a id="3003" class="Pragma">data</a> <a id="3008" class="Pragma">G.Block</a> <a id="3016" class="Pragma">(G.MkBlock)</a> <a id="3028" class="Symbol">#-}</a>
<a id="3032" class="Symbol">{-#</a> <a id="3036" class="Keyword">COMPILE</a> <a id="3044" class="Keyword">AGDA2HS</a> <a id="3052" href="Peras.Block.html#2020" class="Record">BlockBody</a> <a id="3062" class="Pragma">deriving</a> <a id="3071" class="Pragma">(Generic)</a> <a id="3081" class="Symbol">#-}</a>
<a id="3085" class="Symbol">{-#</a> <a id="3089" class="Keyword">COMPILE</a> <a id="3097" class="Keyword">GHC</a> <a id="3101" href="Peras.Block.html#2020" class="Record">BlockBody</a> <a id="3111" class="Pragma">=</a> <a id="3113" class="Pragma">data</a> <a id="3118" class="Pragma">G.BlockBody</a> <a id="3130" class="Pragma">(G.MkBlockBody)</a> <a id="3146" class="Symbol">#-}</a>
<a id="3150" class="Symbol">{-#</a> <a id="3154" class="Keyword">COMPILE</a> <a id="3162" class="Keyword">AGDA2HS</a> <a id="3170" href="Peras.Block.html#2043" class="Record">Certificate</a> <a id="3182" class="Pragma">deriving</a> <a id="3191" class="Pragma">(Generic)</a> <a id="3201" class="Symbol">#-}</a>
<a id="3205" class="Symbol">{-#</a> <a id="3209" class="Keyword">COMPILE</a> <a id="3217" class="Keyword">GHC</a> <a id="3221" href="Peras.Block.html#2043" class="Record">Certificate</a> <a id="3233" class="Pragma">=</a> <a id="3235" class="Pragma">data</a> <a id="3240" class="Pragma">G.Certificate</a> <a id="3254" class="Pragma">(G.MkCertificate)</a> <a id="3272" class="Symbol">#-}</a>
</pre>-->
<pre class="Agda"><a id="3293" class="Keyword">instance</a>
  <a id="iCertificateEq"></a><a id="3304" href="Peras.Block.html#3304" class="Function">iCertificateEq</a> <a id="3319" class="Symbol">:</a> <a id="3321" href="Haskell.Prim.Eq.html#401" class="Record">Eq</a> <a id="3324" href="Peras.Block.html#2043" class="Record">Certificate</a>
  <a id="3338" href="Peras.Block.html#3304" class="Function">iCertificateEq</a> <a id="3353" class="Symbol">.</a><a id="3354" href="Haskell.Prim.Eq.html#453" class="Field Operator">_==_</a> <a id="3359" href="Peras.Block.html#3359" class="Bound">x</a> <a id="3361" href="Peras.Block.html#3361" class="Bound">y</a> <a id="3363" class="Symbol">=</a> <a id="3365" href="Peras.Block.html#2152" class="Field">round</a> <a id="3371" href="Peras.Block.html#3359" class="Bound">x</a> <a id="3373" href="Haskell.Prim.Eq.html#453" class="Field Operator">==</a> <a id="3376" href="Peras.Block.html#2152" class="Field">round</a> <a id="3382" href="Peras.Block.html#3361" class="Bound">y</a> <a id="3384" href="Haskell.Prim.Bool.html#138" class="Function Operator">&amp;&amp;</a> <a id="3387" href="Peras.Block.html#2180" class="Field">blockRef</a> <a id="3396" href="Peras.Block.html#3359" class="Bound">x</a> <a id="3398" href="Haskell.Prim.Eq.html#453" class="Field Operator">==</a> <a id="3401" href="Peras.Block.html#2180" class="Field">blockRef</a> <a id="3410" href="Peras.Block.html#3361" class="Bound">y</a>

<a id="3413" class="Keyword">instance</a>
  <a id="iBlockEq"></a><a id="3424" href="Peras.Block.html#3424" class="Function">iBlockEq</a> <a id="3433" class="Symbol">:</a> <a id="3435" href="Haskell.Prim.Eq.html#401" class="Record">Eq</a> <a id="3438" href="Peras.Block.html#2001" class="Record">Block</a>
  <a id="3446" href="Peras.Block.html#3424" class="Function">iBlockEq</a> <a id="3455" class="Symbol">.</a><a id="3456" href="Haskell.Prim.Eq.html#453" class="Field Operator">_==_</a> <a id="3461" href="Peras.Block.html#3461" class="Bound">x</a> <a id="3463" href="Peras.Block.html#3463" class="Bound">y</a> <a id="3465" class="Symbol">=</a> <a id="3467" href="Peras.Block.html#2439" class="Field">slotNumber</a> <a id="3478" href="Peras.Block.html#3461" class="Bound">x</a> <a id="3480" href="Haskell.Prim.Eq.html#453" class="Field Operator">==</a> <a id="3483" href="Peras.Block.html#2439" class="Field">slotNumber</a> <a id="3494" href="Peras.Block.html#3463" class="Bound">y</a>
                         <a id="3521" href="Haskell.Prim.Bool.html#138" class="Function Operator">&amp;&amp;</a> <a id="3524" href="Peras.Block.html#2471" class="Field">creatorId</a> <a id="3534" href="Peras.Block.html#3461" class="Bound">x</a> <a id="3536" href="Haskell.Prim.Eq.html#453" class="Field Operator">==</a> <a id="3539" href="Peras.Block.html#2471" class="Field">creatorId</a> <a id="3549" href="Peras.Block.html#3463" class="Bound">y</a>
                         <a id="3576" href="Haskell.Prim.Bool.html#138" class="Function Operator">&amp;&amp;</a> <a id="3579" href="Peras.Block.html#2499" class="Field">parentBlock</a> <a id="3591" href="Peras.Block.html#3461" class="Bound">x</a> <a id="3593" href="Haskell.Prim.Eq.html#453" class="Field Operator">==</a> <a id="3596" href="Peras.Block.html#2499" class="Field">parentBlock</a> <a id="3608" href="Peras.Block.html#3463" class="Bound">y</a>
                         <a id="3635" href="Haskell.Prim.Bool.html#138" class="Function Operator">&amp;&amp;</a> <a id="3638" href="Peras.Block.html#2572" class="Field">leadershipProof</a> <a id="3654" href="Peras.Block.html#3461" class="Bound">x</a> <a id="3656" href="Haskell.Prim.Eq.html#453" class="Field Operator">==</a> <a id="3659" href="Peras.Block.html#2572" class="Field">leadershipProof</a> <a id="3675" href="Peras.Block.html#3463" class="Bound">y</a>
                         <a id="3702" href="Haskell.Prim.Bool.html#138" class="Function Operator">&amp;&amp;</a> <a id="3705" href="Peras.Block.html#2532" class="Field">certificate</a> <a id="3717" href="Peras.Block.html#3461" class="Bound">x</a> <a id="3719" href="Haskell.Prim.Eq.html#453" class="Field Operator">==</a> <a id="3722" href="Peras.Block.html#2532" class="Field">certificate</a> <a id="3734" href="Peras.Block.html#3463" class="Bound">y</a>
                         <a id="3761" href="Haskell.Prim.Bool.html#138" class="Function Operator">&amp;&amp;</a> <a id="3764" href="Peras.Block.html#2614" class="Field">signature</a> <a id="3774" href="Peras.Block.html#3461" class="Bound">x</a> <a id="3776" href="Haskell.Prim.Eq.html#453" class="Field Operator">==</a> <a id="3779" href="Peras.Block.html#2614" class="Field">signature</a> <a id="3789" href="Peras.Block.html#3463" class="Bound">y</a>
                         <a id="3816" href="Haskell.Prim.Bool.html#138" class="Function Operator">&amp;&amp;</a> <a id="3819" href="Peras.Block.html#2644" class="Field">bodyHash</a> <a id="3828" href="Peras.Block.html#3461" class="Bound">x</a> <a id="3830" href="Haskell.Prim.Eq.html#453" class="Field Operator">==</a> <a id="3833" href="Peras.Block.html#2644" class="Field">bodyHash</a> <a id="3842" href="Peras.Block.html#3463" class="Bound">y</a>
                         <a id="3869" class="Comment">-- FIXME: In principle, we only need to check equality of the signatures.</a>

<a id="3944" class="Keyword">instance</a>
  <a id="iBlockBodyEq"></a><a id="3955" href="Peras.Block.html#3955" class="Function">iBlockBodyEq</a> <a id="3968" class="Symbol">:</a> <a id="3970" href="Haskell.Prim.Eq.html#401" class="Record">Eq</a> <a id="3973" href="Peras.Block.html#2020" class="Record">BlockBody</a>
  <a id="3985" href="Peras.Block.html#3955" class="Function">iBlockBodyEq</a> <a id="3998" class="Symbol">.</a><a id="3999" href="Haskell.Prim.Eq.html#453" class="Field Operator">_==_</a> <a id="4004" href="Peras.Block.html#4004" class="Bound">x</a> <a id="4006" href="Peras.Block.html#4006" class="Bound">y</a> <a id="4008" class="Symbol">=</a> <a id="4010" href="Peras.Block.html#2807" class="Field">blockHash</a> <a id="4020" href="Peras.Block.html#4004" class="Bound">x</a> <a id="4022" href="Haskell.Prim.Eq.html#453" class="Field Operator">==</a> <a id="4025" href="Peras.Block.html#2807" class="Field">blockHash</a> <a id="4035" href="Peras.Block.html#4006" class="Bound">y</a> <a id="4037" href="Haskell.Prim.Bool.html#138" class="Function Operator">&amp;&amp;</a> <a id="4040" href="Peras.Block.html#2840" class="Field">payload</a> <a id="4048" href="Peras.Block.html#4004" class="Bound">x</a> <a id="4050" href="Haskell.Prim.Eq.html#453" class="Field Operator">==</a> <a id="4053" href="Peras.Block.html#2840" class="Field">payload</a> <a id="4061" href="Peras.Block.html#4006" class="Bound">y</a>

<a id="4064" class="Keyword">module</a> <a id="4071" href="Peras.Block.html#4071" class="Module">_</a> <a id="4073" class="Symbol">{</a><a id="4074" href="Peras.Block.html#4074" class="Bound">a</a> <a id="4076" class="Symbol">:</a> <a id="4078" href="Agda.Primitive.html#388" class="Primitive">Set</a><a id="4081" class="Symbol">}</a> <a id="4083" class="Symbol">⦃</a> <a id="4085" href="Peras.Block.html#4085" class="Bound">_</a> <a id="4087" class="Symbol">:</a> <a id="4089" href="Peras.Crypto.html#2287" class="Record">Hashable</a> <a id="4098" href="Peras.Block.html#4074" class="Bound">a</a> <a id="4100" class="Symbol">⦄</a>
  <a id="4104" class="Keyword">where</a>

  <a id="4113" class="Keyword">open</a> <a id="4118" href="Peras.Crypto.html#2287" class="Module">Hashable</a> <a id="4127" class="Symbol">⦃...⦄</a>

  <a id="4136" href="Peras.Block.html#4136" class="Function">tipHash</a> <a id="4144" class="Symbol">:</a> <a id="4146" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="4151" href="Peras.Block.html#4074" class="Bound">a</a> <a id="4153" class="Symbol">→</a> <a id="4155" href="Peras.Crypto.html#1835" class="Record">Hash</a> <a id="4160" href="Peras.Block.html#4074" class="Bound">a</a>
  <a id="4164" href="Peras.Block.html#4136" class="Function">tipHash</a> <a id="4172" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a> <a id="4175" class="Symbol">=</a> <a id="4177" href="Peras.Crypto.html#1876" class="InductiveConstructor">MkHash</a> <a id="4184" href="Peras.Crypto.html#676" class="Postulate">emptyBS</a>
  <a id="4194" href="Peras.Block.html#4136" class="Function">tipHash</a> <a id="4202" class="Symbol">(</a><a id="4203" href="Peras.Block.html#4203" class="Bound">x</a> <a id="4205" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="4207" class="Symbol">_)</a> <a id="4210" class="Symbol">=</a> <a id="4212" href="Peras.Crypto.html#2326" class="Field">hash</a> <a id="4217" href="Peras.Block.html#4203" class="Bound">x</a>

<a id="4220" class="Keyword">private</a>
  <a id="4230" class="Keyword">open</a> <a id="4235" href="Peras.Crypto.html#2287" class="Module">Hashable</a>
  <a id="4246" class="Keyword">instance</a>
    <a id="hashBlock"></a><a id="4259" href="Peras.Block.html#4259" class="Function">hashBlock</a> <a id="4269" class="Symbol">:</a> <a id="4271" href="Peras.Crypto.html#2287" class="Record">Hashable</a> <a id="4280" href="Peras.Block.html#2001" class="Record">Block</a>
    <a id="4290" href="Peras.Block.html#4259" class="Function">hashBlock</a> <a id="4300" class="Symbol">.</a><a id="4301" href="Peras.Crypto.html#2326" class="Field">hash</a> <a id="4306" class="Symbol">=</a> <a id="4308" href="Peras.Crypto.html#1876" class="InductiveConstructor">MkHash</a> <a id="4315" href="Haskell.Prim.html#1330" class="Function Operator">∘</a> <a id="4317" href="Peras.Crypto.html#3464" class="Field">bytesS</a> <a id="4324" href="Haskell.Prim.html#1330" class="Function Operator">∘</a> <a id="4326" href="Peras.Block.html#2614" class="Field">signature</a>

<a id="4337" class="Symbol">{-#</a> <a id="4341" class="Keyword">COMPILE</a> <a id="4349" class="Keyword">AGDA2HS</a> <a id="4357" href="Peras.Block.html#4136" class="Function">tipHash</a> <a id="4365" class="Symbol">#-}</a>
<a id="4369" class="Symbol">{-#</a> <a id="4373" class="Keyword">COMPILE</a> <a id="4381" class="Keyword">AGDA2HS</a> <a id="4389" href="Peras.Block.html#3304" class="Function">iCertificateEq</a> <a id="4404" class="Symbol">#-}</a>
<a id="4408" class="Symbol">{-#</a> <a id="4412" class="Keyword">COMPILE</a> <a id="4420" class="Keyword">AGDA2HS</a> <a id="4428" href="Peras.Block.html#3424" class="Function">iBlockEq</a> <a id="4437" class="Symbol">#-}</a>
<a id="4441" class="Symbol">{-#</a> <a id="4445" class="Keyword">COMPILE</a> <a id="4453" class="Keyword">AGDA2HS</a> <a id="4461" href="Peras.Block.html#3955" class="Function">iBlockBodyEq</a> <a id="4474" class="Symbol">#-}</a>
<a id="4478" class="Symbol">{-#</a> <a id="4482" class="Keyword">COMPILE</a> <a id="4490" class="Keyword">AGDA2HS</a> <a id="4498" href="Peras.Block.html#4259" class="Function">hashBlock</a> <a id="4508" class="Symbol">#-}</a>
</pre>
</body>
</html>
