<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>Peras.Block</title>
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    /* The extra [class] is a hack that increases specificity enough to
       override a similar rule in reveal.js */
    ul.task-list[class]{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      font-size: inherit;
      width: 0.8em;
      margin: 0 0.8em 0.2em -1.6em;
      vertical-align: middle;
    }
    .display.math{display: block; text-align: center; margin: 0.5rem auto;}
  </style>
  <link rel="stylesheet" href="Agda.css" />
  <!--[if lt IE 9]>
    <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
  <![endif]-->
</head>
<body>
<pre class="Agda"><a id="9" class="Keyword">module</a> <a id="16" href="Peras.Block.html" class="Module">Peras.Block</a> <a id="28" class="Keyword">where</a>
</pre>
<!--
<pre class="Agda"><a id="52" class="Keyword">open</a> <a id="57" class="Keyword">import</a> <a id="64" href="Data.Bool.html" class="Module">Data.Bool</a> <a id="74" class="Keyword">using</a> <a id="80" class="Symbol">(</a><a id="81" href="Agda.Builtin.Bool.html#173" class="Datatype">Bool</a><a id="85" class="Symbol">;</a> <a id="87" href="Agda.Builtin.Bool.html#198" class="InductiveConstructor">true</a><a id="91" class="Symbol">;</a> <a id="93" href="Agda.Builtin.Bool.html#192" class="InductiveConstructor">false</a><a id="98" class="Symbol">)</a>
<a id="100" class="Keyword">open</a> <a id="105" class="Keyword">import</a> <a id="112" href="Data.List.html" class="Module">Data.List</a> <a id="122" class="Keyword">using</a> <a id="128" class="Symbol">(</a><a id="129" href="Agda.Builtin.List.html#147" class="Datatype">List</a><a id="133" class="Symbol">;</a> <a id="135" href="Data.List.Base.html#4742" class="Function">null</a><a id="139" class="Symbol">;</a> <a id="141" href="Data.List.Base.html#8635" class="Function">head</a><a id="145" class="Symbol">;</a> <a id="147" href="Data.List.Base.html#10878" class="Function">filter</a><a id="153" class="Symbol">)</a>
<a id="155" class="Keyword">open</a> <a id="160" class="Keyword">import</a> <a id="167" href="Data.List.Membership.Propositional.html" class="Module">Data.List.Membership.Propositional</a> <a id="202" class="Keyword">using</a> <a id="208" class="Symbol">(</a><a id="209" href="Data.List.Membership.Setoid.html#950" class="Function Operator">_∈_</a><a id="212" class="Symbol">;</a> <a id="214" href="Data.List.Membership.Setoid.html#999" class="Function Operator">_∉_</a><a id="217" class="Symbol">)</a>
<a id="219" class="Keyword">open</a> <a id="224" class="Keyword">import</a> <a id="231" href="Data.Maybe.html" class="Module">Data.Maybe</a> <a id="242" class="Keyword">using</a> <a id="248" class="Symbol">(</a><a id="249" href="Agda.Builtin.Maybe.html#135" class="Datatype">Maybe</a><a id="254" class="Symbol">;</a> <a id="256" href="Data.Maybe.Base.html#1583" class="Function">maybe′</a><a id="262" class="Symbol">)</a>
<a id="264" class="Keyword">open</a> <a id="269" class="Keyword">import</a> <a id="276" href="Data.Nat.html" class="Module">Data.Nat</a> <a id="285" class="Keyword">using</a> <a id="291" class="Symbol">(</a><a id="292" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a><a id="293" class="Symbol">)</a>
<a id="295" class="Keyword">open</a> <a id="300" class="Keyword">import</a> <a id="307" href="Data.Nat.Properties.html" class="Module">Data.Nat.Properties</a> <a id="327" class="Keyword">using</a> <a id="333" class="Symbol">(</a><a id="334" href="Data.Nat.Properties.html#11695" class="Function">&lt;-strictTotalOrder</a><a id="352" class="Symbol">)</a>
<a id="354" class="Keyword">open</a> <a id="359" class="Keyword">import</a> <a id="366" href="Data.Product.html" class="Module">Data.Product</a> <a id="379" class="Keyword">using</a> <a id="385" class="Symbol">(</a><a id="386" href="Agda.Builtin.Sigma.html#165" class="Record">Σ</a><a id="387" class="Symbol">;</a> <a id="389" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">_,_</a><a id="392" class="Symbol">;</a> <a id="394" href="Data.Product.Base.html#852" class="Function">∃</a><a id="395" class="Symbol">;</a> <a id="397" href="Data.Product.Base.html#1244" class="Function">Σ-syntax</a><a id="405" class="Symbol">;</a> <a id="407" href="Data.Product.Base.html#1371" class="Function">∃-syntax</a><a id="415" class="Symbol">;</a> <a id="417" href="Data.Product.Base.html#1618" class="Function Operator">_×_</a><a id="420" class="Symbol">;</a> <a id="422" href="Data.Product.Base.html#636" class="Field">proj₁</a><a id="427" class="Symbol">;</a> <a id="429" href="Data.Product.Base.html#650" class="Field">proj₂</a><a id="434" class="Symbol">)</a>
<a id="436" class="Keyword">open</a> <a id="441" class="Keyword">import</a> <a id="448" href="Data.Unit.html" class="Module">Data.Unit</a> <a id="458" class="Keyword">using</a> <a id="464" class="Symbol">(</a><a id="465" href="Agda.Builtin.Unit.html#175" class="Record">⊤</a><a id="466" class="Symbol">)</a>
<a id="468" class="Keyword">open</a> <a id="473" class="Keyword">import</a> <a id="480" href="Function.html" class="Module">Function</a> <a id="489" class="Keyword">using</a> <a id="495" class="Symbol">(</a><a id="496" href="Function.Base.html#1115" class="Function Operator">_∘_</a><a id="499" class="Symbol">)</a>
<a id="501" class="Keyword">open</a> <a id="506" class="Keyword">import</a> <a id="513" href="Haskell.Prelude.html" class="Module">Haskell.Prelude</a> <a id="529" class="Symbol">as</a> <a id="532" class="Module">Haskell</a> <a id="540" class="Keyword">using</a> <a id="546" class="Symbol">(</a><a id="547" href="Haskell.Prim.Eq.html#401" class="Record">Eq</a><a id="549" class="Symbol">;</a> <a id="551" href="Haskell.Prim.Eq.html#453" class="Field Operator">_==_</a><a id="555" class="Symbol">;</a> <a id="557" href="Agda.Builtin.Bool.html#198" class="InductiveConstructor">True</a><a id="561" class="Symbol">;</a> <a id="563" href="Agda.Builtin.Bool.html#192" class="InductiveConstructor">False</a><a id="568" class="Symbol">;</a> <a id="570" href="Haskell.Prim.Bool.html#138" class="Function Operator">_&amp;&amp;_</a><a id="574" class="Symbol">)</a>
<a id="576" class="Keyword">open</a> <a id="581" class="Keyword">import</a> <a id="588" href="Level.html" class="Module">Level</a> <a id="594" class="Keyword">using</a> <a id="600" class="Symbol">(</a><a id="601" href="Level.html#521" class="Function">0ℓ</a><a id="603" class="Symbol">)</a>
<a id="605" class="Keyword">open</a> <a id="610" class="Keyword">import</a> <a id="617" href="Relation.Binary.html" class="Module">Relation.Binary</a> <a id="633" class="Keyword">using</a> <a id="639" class="Symbol">(</a><a id="640" href="Relation.Binary.Bundles.html#8031" class="Record">StrictTotalOrder</a><a id="656" class="Symbol">;</a> <a id="658" href="Relation.Binary.Definitions.html#6469" class="Function">DecidableEquality</a><a id="675" class="Symbol">)</a>
<a id="677" class="Keyword">open</a> <a id="682" class="Keyword">import</a> <a id="689" href="Relation.Nullary.html" class="Module">Relation.Nullary</a> <a id="706" class="Keyword">using</a> <a id="712" class="Symbol">(</a><a id="713" href="Relation.Nullary.Decidable.Core.html#1618" class="InductiveConstructor">yes</a><a id="716" class="Symbol">;</a> <a id="718" href="Relation.Nullary.Decidable.Core.html#1655" class="InductiveConstructor">no</a><a id="720" class="Symbol">;</a> <a id="722" href="Relation.Nullary.Negation.Core.html#698" class="Function Operator">¬_</a><a id="724" class="Symbol">)</a>

<a id="727" class="Keyword">open</a> <a id="732" class="Keyword">import</a> <a id="739" href="Data.Nat.Properties.html" class="Module">Data.Nat.Properties</a> <a id="759" class="Keyword">using</a> <a id="765" class="Symbol">(</a><a id="766" href="Data.Nat.Properties.html#7413" class="Function">≤-totalOrder</a><a id="778" class="Symbol">)</a>
<a id="780" class="Keyword">open</a> <a id="785" class="Keyword">import</a> <a id="792" href="Data.List.Extrema.html" class="Module">Data.List.Extrema</a> <a id="810" class="Symbol">(</a><a id="811" href="Data.Nat.Properties.html#7413" class="Function">≤-totalOrder</a><a id="823" class="Symbol">)</a> <a id="825" class="Keyword">using</a> <a id="831" class="Symbol">(</a><a id="832" href="Data.List.Extrema.html#1840" class="Function">argmax</a><a id="838" class="Symbol">)</a>

<a id="841" class="Keyword">import</a> <a id="848" href="Relation.Binary.PropositionalEquality.html" class="Module">Relation.Binary.PropositionalEquality</a> <a id="886" class="Symbol">as</a> <a id="889" class="Module">Equ</a>
<a id="893" class="Keyword">open</a> <a id="898" href="Relation.Binary.PropositionalEquality.html" class="Module">Equ</a> <a id="902" class="Keyword">using</a> <a id="908" class="Symbol">(</a><a id="909" href="Agda.Builtin.Equality.html#150" class="Datatype Operator">_≡_</a><a id="912" class="Symbol">;</a> <a id="914" href="Relation.Binary.PropositionalEquality.Core.html#858" class="Function Operator">_≢_</a><a id="917" class="Symbol">;</a> <a id="919" href="Relation.Binary.PropositionalEquality.Core.html#1158" class="Function">cong</a><a id="923" class="Symbol">)</a>

<a id="926" class="Keyword">open</a> <a id="931" class="Keyword">import</a> <a id="938" href="Peras.Crypto.html" class="Module">Peras.Crypto</a>
<a id="951" class="Keyword">open</a> <a id="956" class="Keyword">import</a> <a id="963" href="Peras.Numbering.html" class="Module">Peras.Numbering</a>
<a id="979" class="Keyword">open</a> <a id="984" class="Keyword">import</a> <a id="991" href="Peras.Util.html" class="Module">Peras.Util</a>

<a id="1003" class="Symbol">{-#</a> <a id="1007" class="Keyword">FOREIGN</a> <a id="1015" class="Pragma">AGDA2HS</a>
<a id="1023" class="Symbol">{-#</a> <a id="1027" class="Pragma">LANGUAGE</a> <a id="1036" class="Pragma">DeriveGeneric</a> <a id="1050" class="Symbol">#-}</a>
<a id="1054" class="Pragma">import</a> <a id="1061" class="Pragma">GHC.Generics</a> <a id="1074" class="Pragma">(Generic)</a>
<a id="1084" class="Pragma">import</a> <a id="1091" class="Pragma">Peras.Crypto</a> <a id="1104" class="Pragma">(Hash</a> <a id="1110" class="Pragma">(..),</a> <a id="1116" class="Pragma">Hashable</a> <a id="1125" class="Pragma">(..))</a>
<a id="1131" class="Pragma">import</a> <a id="1138" class="Pragma">Prelude</a> <a id="1146" class="Pragma">hiding</a> <a id="1153" class="Pragma">(round)</a>
<a id="1161" class="Symbol">#-}</a>

<a id="1166" class="Symbol">{-#</a> <a id="1170" class="Keyword">FOREIGN</a> <a id="1178" class="Pragma">GHC</a>
<a id="1182" class="Pragma">import</a> <a id="1189" class="Pragma">qualified</a> <a id="1199" class="Pragma">Peras.Block</a> <a id="1211" class="Pragma">as</a> <a id="1214" class="Pragma">G</a>
<a id="1216" class="Symbol">#-}</a>
</pre>-->
<h2 id="partyid">PartyId</h2>
<pre class="Agda"><a id="PartyId"></a><a id="1249" href="Peras.Block.html#1249" class="Function">PartyId</a> <a id="1257" class="Symbol">=</a> <a id="1259" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a>  <a id="1262" class="Comment">-- FIXME: Data.Fin ?</a>
</pre>
<!--
<pre class="Agda"><a id="1301" class="Symbol">{-#</a> <a id="1305" class="Keyword">FOREIGN</a> <a id="1313" class="Pragma">AGDA2HS</a>
<a id="1321" class="Pragma">--</a> <a id="1324" class="Pragma">Use</a> <a id="1328" class="Pragma">`Integer`</a> <a id="1338" class="Pragma">for</a> <a id="1342" class="Pragma">compatibility</a> <a id="1356" class="Pragma">with</a> <a id="1361" class="Pragma">`MAlonzo`.</a>
<a id="1372" class="Pragma">type</a> <a id="1377" class="Pragma">PartyId</a> <a id="1385" class="Pragma">=</a> <a id="1387" class="Pragma">Integer</a>
<a id="1395" class="Symbol">#-}</a>
</pre>-->
<p>The party identifier needs to be strictly, totally ordered to be used
as key</p>
<pre class="Agda"><a id="PartyIdO"></a><a id="1494" href="Peras.Block.html#1494" class="Function">PartyIdO</a> <a id="1503" class="Symbol">:</a> <a id="1505" href="Relation.Binary.Bundles.html#8031" class="Record">StrictTotalOrder</a> <a id="1522" href="Level.html#521" class="Function">0ℓ</a> <a id="1525" href="Level.html#521" class="Function">0ℓ</a> <a id="1528" href="Level.html#521" class="Function">0ℓ</a>
<a id="1531" href="Peras.Block.html#1494" class="Function">PartyIdO</a> <a id="1540" class="Symbol">=</a> <a id="1542" href="Data.Nat.Properties.html#11695" class="Function">&lt;-strictTotalOrder</a>
</pre>
<h2 id="party">Party</h2>
<pre class="Agda"><a id="1584" class="Keyword">record</a> <a id="Party"></a><a id="1591" href="Peras.Block.html#1591" class="Record">Party</a> <a id="1597" class="Symbol">:</a> <a id="1599" href="Agda.Primitive.html#388" class="Primitive">Set</a> <a id="1603" class="Keyword">where</a>
  <a id="1611" class="Keyword">constructor</a> <a id="MkParty"></a><a id="1623" href="Peras.Block.html#1623" class="InductiveConstructor">MkParty</a>
  <a id="1633" class="Keyword">field</a> <a id="Party.pid"></a><a id="1639" href="Peras.Block.html#1639" class="Field">pid</a> <a id="1643" class="Symbol">:</a> <a id="1645" href="Peras.Block.html#1249" class="Function">PartyId</a>
        <a id="Party.pkey"></a><a id="1661" href="Peras.Block.html#1661" class="Field">pkey</a> <a id="1666" class="Symbol">:</a> <a id="1668" href="Peras.Crypto.html#3458" class="Record">VerificationKey</a>

<a id="1685" class="Keyword">open</a> <a id="1690" href="Peras.Block.html#1591" class="Module">Party</a> <a id="1696" class="Keyword">public</a>

<a id="1704" class="Keyword">instance</a>
  <a id="iPartyEq"></a><a id="1715" href="Peras.Block.html#1715" class="Function">iPartyEq</a> <a id="1724" class="Symbol">:</a> <a id="1726" href="Haskell.Prim.Eq.html#401" class="Record">Eq</a> <a id="1729" href="Peras.Block.html#1591" class="Record">Party</a>
  <a id="1737" href="Peras.Block.html#1715" class="Function">iPartyEq</a> <a id="1746" class="Symbol">.</a><a id="1747" href="Haskell.Prim.Eq.html#453" class="Field Operator">Haskell._==_</a> <a id="1760" href="Peras.Block.html#1760" class="Bound">x</a> <a id="1762" href="Peras.Block.html#1762" class="Bound">y</a> <a id="1764" class="Symbol">=</a> <a id="1766" href="Peras.Block.html#1639" class="Field">pid</a> <a id="1770" href="Peras.Block.html#1760" class="Bound">x</a> <a id="1772" href="Haskell.Prim.Eq.html#453" class="Field Operator">Haskell.==</a> <a id="1783" href="Peras.Block.html#1639" class="Field">pid</a> <a id="1787" href="Peras.Block.html#1762" class="Bound">y</a> <a id="1789" href="Haskell.Prim.Bool.html#138" class="Function Operator">&amp;&amp;</a> <a id="1792" href="Peras.Block.html#1661" class="Field">pkey</a> <a id="1797" href="Peras.Block.html#1760" class="Bound">x</a> <a id="1799" href="Haskell.Prim.Eq.html#453" class="Field Operator">Haskell.==</a> <a id="1810" href="Peras.Block.html#1661" class="Field">pkey</a> <a id="1815" href="Peras.Block.html#1762" class="Bound">y</a>
</pre>
<!--
<pre class="Agda"><a id="1835" class="Symbol">{-#</a> <a id="1839" class="Keyword">COMPILE</a> <a id="1847" class="Keyword">AGDA2HS</a> <a id="1855" href="Peras.Block.html#1591" class="Record">Party</a> <a id="1861" class="Pragma">deriving</a> <a id="1870" class="Pragma">(Generic)</a> <a id="1880" class="Symbol">#-}</a>
<a id="1884" class="Symbol">{-#</a> <a id="1888" class="Keyword">COMPILE</a> <a id="1896" class="Keyword">GHC</a> <a id="1900" href="Peras.Block.html#1591" class="Record">Party</a> <a id="1906" class="Pragma">=</a> <a id="1908" class="Pragma">data</a> <a id="1913" class="Pragma">G.Party</a> <a id="1921" class="Pragma">(G.MkParty)</a> <a id="1933" class="Symbol">#-}</a>
<a id="1937" class="Symbol">{-#</a> <a id="1941" class="Keyword">COMPILE</a> <a id="1949" class="Keyword">AGDA2HS</a> <a id="1957" href="Peras.Block.html#1715" class="Function">iPartyEq</a> <a id="1966" class="Symbol">#-}</a>
</pre>-->
<h2 id="honesty-of-a-party">Honesty of a party</h2>
<pre class="Agda"><a id="2010" class="Keyword">data</a> <a id="Honesty"></a><a id="2015" href="Peras.Block.html#2015" class="Datatype">Honesty</a> <a id="2023" class="Symbol">:</a> <a id="2025" href="Peras.Block.html#1249" class="Function">PartyId</a> <a id="2033" class="Symbol">→</a> <a id="2035" href="Agda.Primitive.html#388" class="Primitive">Set</a> <a id="2039" class="Keyword">where</a>

  <a id="Honesty.Honest"></a><a id="2048" href="Peras.Block.html#2048" class="InductiveConstructor">Honest</a> <a id="2055" class="Symbol">:</a> <a id="2057" class="Symbol">∀</a> <a id="2059" class="Symbol">{</a><a id="2060" href="Peras.Block.html#2060" class="Bound">p</a> <a id="2062" class="Symbol">:</a> <a id="2064" href="Peras.Block.html#1249" class="Function">PartyId</a><a id="2071" class="Symbol">}</a>
    <a id="2077" class="Symbol">→</a> <a id="2079" href="Peras.Block.html#2015" class="Datatype">Honesty</a> <a id="2087" href="Peras.Block.html#2060" class="Bound">p</a>

  <a id="Honesty.Corrupt"></a><a id="2092" href="Peras.Block.html#2092" class="InductiveConstructor">Corrupt</a> <a id="2100" class="Symbol">:</a> <a id="2102" class="Symbol">∀</a> <a id="2104" class="Symbol">{</a><a id="2105" href="Peras.Block.html#2105" class="Bound">p</a> <a id="2107" class="Symbol">:</a> <a id="2109" href="Peras.Block.html#1249" class="Function">PartyId</a><a id="2116" class="Symbol">}</a>
    <a id="2122" class="Symbol">→</a> <a id="2124" href="Peras.Block.html#2015" class="Datatype">Honesty</a> <a id="2132" href="Peras.Block.html#2105" class="Bound">p</a>
</pre>
<pre class="Agda"><a id="PartyTup"></a><a id="2146" href="Peras.Block.html#2146" class="Function">PartyTup</a> <a id="2155" class="Symbol">=</a> <a id="2157" href="Data.Product.Base.html#1371" class="Function">∃[</a> <a id="2160" href="Peras.Block.html#2160" class="Bound">p</a> <a id="2162" href="Data.Product.Base.html#1371" class="Function">]</a> <a id="2164" class="Symbol">(</a><a id="2165" href="Peras.Block.html#2015" class="Datatype">Honesty</a> <a id="2173" href="Peras.Block.html#2160" class="Bound">p</a><a id="2174" class="Symbol">)</a>
<a id="Parties"></a><a id="2176" href="Peras.Block.html#2176" class="Function">Parties</a> <a id="2184" class="Symbol">=</a> <a id="2186" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="2191" href="Peras.Block.html#2146" class="Function">PartyTup</a>
</pre>
<pre class="Agda"><a id="2213" class="Keyword">postulate</a>
  <a id="Honest≢Corrupt"></a><a id="2225" href="Peras.Block.html#2225" class="Postulate">Honest≢Corrupt</a> <a id="2240" class="Symbol">:</a> <a id="2242" class="Symbol">∀</a> <a id="2244" class="Symbol">{</a><a id="2245" href="Peras.Block.html#2245" class="Bound">p₁</a> <a id="2248" href="Peras.Block.html#2248" class="Bound">p₂</a><a id="2250" class="Symbol">}</a> <a id="2252" class="Symbol">{</a><a id="2253" href="Peras.Block.html#2253" class="Bound">h₁</a> <a id="2256" class="Symbol">:</a> <a id="2258" href="Peras.Block.html#2015" class="Datatype">Honesty</a> <a id="2266" href="Peras.Block.html#2245" class="Bound">p₁</a><a id="2268" class="Symbol">}</a> <a id="2270" class="Symbol">{</a><a id="2271" href="Peras.Block.html#2271" class="Bound">h₂</a> <a id="2274" class="Symbol">:</a> <a id="2276" href="Peras.Block.html#2015" class="Datatype">Honesty</a> <a id="2284" href="Peras.Block.html#2248" class="Bound">p₂</a><a id="2286" class="Symbol">}</a>
    <a id="2292" class="Symbol">→</a> <a id="2294" href="Peras.Block.html#2253" class="Bound">h₁</a> <a id="2297" href="Agda.Builtin.Equality.html#150" class="Datatype Operator">≡</a> <a id="2299" href="Peras.Block.html#2048" class="InductiveConstructor">Honest</a>
    <a id="2310" class="Symbol">→</a> <a id="2312" href="Peras.Block.html#2271" class="Bound">h₂</a> <a id="2315" href="Agda.Builtin.Equality.html#150" class="Datatype Operator">≡</a> <a id="2317" href="Peras.Block.html#2092" class="InductiveConstructor">Corrupt</a>
    <a id="2329" class="Symbol">→</a> <a id="2331" href="Peras.Block.html#2245" class="Bound">p₁</a> <a id="2334" href="Relation.Binary.PropositionalEquality.Core.html#858" class="Function Operator">≢</a> <a id="2336" href="Peras.Block.html#2248" class="Bound">p₂</a>

<a id="isHonest"></a><a id="2340" href="Peras.Block.html#2340" class="Function">isHonest</a> <a id="2349" class="Symbol">:</a> <a id="2351" class="Symbol">∀</a> <a id="2353" class="Symbol">{</a><a id="2354" href="Peras.Block.html#2354" class="Bound">p</a> <a id="2356" class="Symbol">:</a> <a id="2358" href="Peras.Block.html#1249" class="Function">PartyId</a><a id="2365" class="Symbol">}</a> <a id="2367" class="Symbol">→</a> <a id="2369" href="Peras.Block.html#2015" class="Datatype">Honesty</a> <a id="2377" href="Peras.Block.html#2354" class="Bound">p</a> <a id="2379" class="Symbol">→</a> <a id="2381" href="Agda.Builtin.Bool.html#173" class="Datatype">Bool</a>
<a id="2386" href="Peras.Block.html#2340" class="Function">isHonest</a> <a id="2395" class="Symbol">{</a><a id="2396" href="Peras.Block.html#2396" class="Bound">p</a><a id="2397" class="Symbol">}</a> <a id="2399" href="Peras.Block.html#2048" class="InductiveConstructor">Honest</a> <a id="2406" class="Symbol">=</a> <a id="2408" href="Agda.Builtin.Bool.html#198" class="InductiveConstructor">true</a>
<a id="2413" href="Peras.Block.html#2340" class="Function">isHonest</a> <a id="2422" class="Symbol">{</a><a id="2423" href="Peras.Block.html#2423" class="Bound">p</a><a id="2424" class="Symbol">}</a> <a id="2426" href="Peras.Block.html#2092" class="InductiveConstructor">Corrupt</a> <a id="2434" class="Symbol">=</a> <a id="2436" href="Agda.Builtin.Bool.html#192" class="InductiveConstructor">false</a>
</pre>
<h2 id="transactions">Transactions</h2>
<pre class="Agda"><a id="Tx"></a><a id="2472" href="Peras.Block.html#2472" class="Function">Tx</a> <a id="2475" class="Symbol">=</a> <a id="2477" href="Agda.Builtin.Unit.html#175" class="Record">⊤</a>
</pre>
<!--
<pre class="Agda"><a id="2497" class="Symbol">{-#</a> <a id="2501" class="Keyword">COMPILE</a> <a id="2509" class="Keyword">AGDA2HS</a> <a id="2517" href="Peras.Block.html#2472" class="Function">Tx</a> <a id="2520" class="Symbol">#-}</a>
</pre>-->
<h2 id="block-and-certificate">Block and Certificate</h2>
<p>In addition to a Praos block, there is an optional field for the
included certificate. <strong>Note</strong>: What we name
<code>Block</code> is actually a block <em>Header</em>, we use
<code>BlockBody</code> to contain the payload.</p>
<p>A Peras Certificate represents an aggregated quorum of votes for a
specific block at a specific round. Such a certificate is supposed to be
self-contained and verifiable by any node.</p>
<pre class="Agda"><a id="2943" class="Keyword">record</a> <a id="Block"></a><a id="2950" href="Peras.Block.html#2950" class="Record">Block</a> <a id="2956" class="Symbol">:</a> <a id="2958" href="Agda.Primitive.html#388" class="Primitive">Set</a>
<a id="2962" class="Keyword">record</a> <a id="BlockBody"></a><a id="2969" href="Peras.Block.html#2969" class="Record">BlockBody</a> <a id="2979" class="Symbol">:</a> <a id="2981" href="Agda.Primitive.html#388" class="Primitive">Set</a>
<a id="2985" class="Keyword">record</a> <a id="Certificate"></a><a id="2992" href="Peras.Block.html#2992" class="Record">Certificate</a> <a id="3004" class="Symbol">:</a> <a id="3006" href="Agda.Primitive.html#388" class="Primitive">Set</a>

<a id="Payload"></a><a id="3011" href="Peras.Block.html#3011" class="Function">Payload</a> <a id="3019" class="Symbol">=</a> <a id="3021" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="3026" href="Peras.Block.html#2472" class="Function">Tx</a>

<a id="3030" class="Keyword">record</a> <a id="3037" href="Peras.Block.html#2992" class="Record">Certificate</a> <a id="3049" class="Keyword">where</a>
  <a id="3057" class="Keyword">constructor</a> <a id="MkCertificate"></a><a id="3069" href="Peras.Block.html#3069" class="InductiveConstructor">MkCertificate</a>
  <a id="3085" class="Keyword">field</a> <a id="Certificate.round"></a><a id="3091" href="Peras.Block.html#3091" class="Field">round</a> <a id="3097" class="Symbol">:</a> <a id="3099" href="Peras.Numbering.html#1669" class="Record">RoundNumber</a>
        <a id="Certificate.blockRef"></a><a id="3119" href="Peras.Block.html#3119" class="Field">blockRef</a> <a id="3128" class="Symbol">:</a> <a id="3130" href="Peras.Crypto.html#1431" class="Record">Hash</a> <a id="3135" href="Peras.Block.html#2950" class="Record">Block</a>

  <a id="Certificate.roundNumber"></a><a id="3144" href="Peras.Block.html#3144" class="Function">roundNumber</a> <a id="3156" class="Symbol">:</a> <a id="3158" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a>
  <a id="3162" href="Peras.Block.html#3144" class="Function">roundNumber</a> <a id="3174" class="Symbol">=</a> <a id="3176" href="Peras.Numbering.html#1729" class="Field">getRoundNumber</a> <a id="3191" href="Peras.Block.html#3091" class="Field">round</a>
  
<a id="3200" class="Keyword">open</a> <a id="3205" href="Peras.Block.html#2992" class="Module">Certificate</a> <a id="3217" class="Keyword">public</a>

<a id="latestCert"></a><a id="3225" href="Peras.Block.html#3225" class="Function">latestCert</a> <a id="3236" class="Symbol">:</a> <a id="3238" href="Peras.Block.html#2992" class="Record">Certificate</a> <a id="3250" class="Symbol">→</a> <a id="3252" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="3257" href="Peras.Block.html#2992" class="Record">Certificate</a> <a id="3269" class="Symbol">→</a> <a id="3271" href="Peras.Block.html#2992" class="Record">Certificate</a>
<a id="3283" href="Peras.Block.html#3225" class="Function">latestCert</a> <a id="3294" href="Peras.Block.html#3294" class="Bound">c</a> <a id="3296" class="Symbol">=</a> <a id="3298" href="Peras.Util.html#744" class="Function">maximumBy</a> <a id="3308" href="Peras.Block.html#3294" class="Bound">c</a> <a id="3310" class="Symbol">(</a><a id="3311" href="Peras.Util.html#1004" class="Function">comparing</a> <a id="3321" href="Peras.Block.html#3091" class="Field">round</a><a id="3326" class="Symbol">)</a>

<a id="3329" class="Keyword">record</a> <a id="3336" href="Peras.Block.html#2950" class="Record">Block</a> <a id="3342" class="Keyword">where</a>
  <a id="3350" class="Keyword">constructor</a> <a id="MkBlock"></a><a id="3362" href="Peras.Block.html#3362" class="InductiveConstructor">MkBlock</a>
  <a id="3372" class="Keyword">field</a> <a id="Block.slotNumber"></a><a id="3378" href="Peras.Block.html#3378" class="Field">slotNumber</a> <a id="3389" class="Symbol">:</a> <a id="3391" href="Peras.Numbering.html#742" class="Record">SlotNumber</a>
        <a id="Block.creatorId"></a><a id="3410" href="Peras.Block.html#3410" class="Field">creatorId</a> <a id="3420" class="Symbol">:</a> <a id="3422" href="Peras.Block.html#1249" class="Function">PartyId</a>
        <a id="Block.parentBlock"></a><a id="3438" href="Peras.Block.html#3438" class="Field">parentBlock</a> <a id="3450" class="Symbol">:</a> <a id="3452" href="Peras.Crypto.html#1431" class="Record">Hash</a> <a id="3457" href="Peras.Block.html#2950" class="Record">Block</a>
        <a id="Block.certificate"></a><a id="3471" href="Peras.Block.html#3471" class="Field">certificate</a> <a id="3483" class="Symbol">:</a> <a id="3485" href="Agda.Builtin.Maybe.html#135" class="Datatype">Maybe</a> <a id="3491" href="Peras.Block.html#2992" class="Record">Certificate</a>
        <a id="Block.leadershipProof"></a><a id="3511" href="Peras.Block.html#3511" class="Field">leadershipProof</a> <a id="3527" class="Symbol">:</a> <a id="3529" href="Peras.Crypto.html#2376" class="Record">LeadershipProof</a>
        <a id="Block.signature"></a><a id="3553" href="Peras.Block.html#3553" class="Field">signature</a> <a id="3563" class="Symbol">:</a> <a id="3565" href="Peras.Crypto.html#2898" class="Record">Signature</a>
        <a id="Block.bodyHash"></a><a id="3583" href="Peras.Block.html#3583" class="Field">bodyHash</a> <a id="3592" class="Symbol">:</a> <a id="3594" href="Peras.Crypto.html#1431" class="Record">Hash</a> <a id="3599" href="Peras.Block.html#3011" class="Function">Payload</a>

  <a id="Block.slotNumber&#39;"></a><a id="3610" href="Peras.Block.html#3610" class="Function">slotNumber&#39;</a> <a id="3622" class="Symbol">:</a> <a id="3624" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a>
  <a id="3628" href="Peras.Block.html#3610" class="Function">slotNumber&#39;</a> <a id="3640" class="Symbol">=</a> <a id="3642" href="Peras.Numbering.html#800" class="Field">getSlotNumber</a> <a id="3656" href="Peras.Block.html#3378" class="Field">slotNumber</a>
  
<a id="3670" class="Keyword">open</a> <a id="3675" href="Peras.Block.html#2950" class="Module">Block</a> <a id="3681" class="Keyword">public</a>

<a id="_≟-BlockHash_"></a><a id="3689" href="Peras.Block.html#3689" class="Function Operator">_≟-BlockHash_</a> <a id="3703" class="Symbol">:</a> <a id="3705" href="Relation.Binary.Definitions.html#6469" class="Function">DecidableEquality</a> <a id="3723" class="Symbol">(</a><a id="3724" href="Peras.Crypto.html#1431" class="Record">Hash</a> <a id="3729" href="Peras.Block.html#2950" class="Record">Block</a><a id="3734" class="Symbol">)</a>
<a id="3736" class="Symbol">(</a><a id="3737" href="Peras.Crypto.html#1472" class="InductiveConstructor">MkHash</a> <a id="3744" href="Peras.Block.html#3744" class="Bound">b₁</a><a id="3746" class="Symbol">)</a> <a id="3748" href="Peras.Block.html#3689" class="Function Operator">≟-BlockHash</a> <a id="3760" class="Symbol">(</a><a id="3761" href="Peras.Crypto.html#1472" class="InductiveConstructor">MkHash</a> <a id="3768" href="Peras.Block.html#3768" class="Bound">b₂</a><a id="3770" class="Symbol">)</a> <a id="3772" class="Keyword">with</a> <a id="3777" href="Peras.Block.html#3744" class="Bound">b₁</a> <a id="3780" href="Peras.Crypto.html#767" class="Postulate Operator">≟-BS</a> <a id="3785" href="Peras.Block.html#3768" class="Bound">b₂</a>
<a id="3788" class="Symbol">...</a> <a id="3792" class="Symbol">|</a> <a id="3794" href="Relation.Nullary.Decidable.Core.html#1618" class="InductiveConstructor">yes</a> <a id="3798" href="Peras.Block.html#3798" class="Bound">p</a> <a id="3800" class="Symbol">=</a> <a id="3802" href="Relation.Nullary.Decidable.Core.html#1618" class="InductiveConstructor">yes</a> <a id="3806" class="Symbol">(</a><a id="3807" href="Relation.Binary.PropositionalEquality.Core.html#1158" class="Function">cong</a> <a id="3812" href="Peras.Crypto.html#1472" class="InductiveConstructor">MkHash</a> <a id="3819" href="Peras.Block.html#3798" class="Bound">p</a><a id="3820" class="Symbol">)</a>
<a id="3822" class="Symbol">...</a> <a id="3826" class="Symbol">|</a> <a id="3828" href="Relation.Nullary.Decidable.Core.html#1655" class="InductiveConstructor">no</a> <a id="3831" href="Peras.Block.html#3831" class="Bound">¬p</a> <a id="3834" class="Symbol">=</a>  <a id="3837" href="Relation.Nullary.Decidable.Core.html#1655" class="InductiveConstructor">no</a> <a id="3840" class="Symbol">(</a><a id="3841" href="Peras.Block.html#3831" class="Bound">¬p</a> <a id="3844" href="Function.Base.html#1115" class="Function Operator">∘</a> <a id="3846" href="Relation.Binary.PropositionalEquality.Core.html#1158" class="Function">cong</a> <a id="3851" href="Peras.Crypto.html#1487" class="Field">hashBytes</a><a id="3860" class="Symbol">)</a>

<a id="3863" class="Keyword">record</a> <a id="3870" href="Peras.Block.html#2969" class="Record">BlockBody</a> <a id="3880" class="Keyword">where</a>
  <a id="3888" class="Keyword">constructor</a> <a id="MkBlockBody"></a><a id="3900" href="Peras.Block.html#3900" class="InductiveConstructor">MkBlockBody</a>
  <a id="3914" class="Keyword">field</a> <a id="BlockBody.blockHash"></a><a id="3920" href="Peras.Block.html#3920" class="Field">blockHash</a> <a id="3930" class="Symbol">:</a> <a id="3932" href="Peras.Crypto.html#1431" class="Record">Hash</a> <a id="3937" href="Peras.Block.html#3011" class="Function">Payload</a>
        <a id="BlockBody.payload"></a><a id="3953" href="Peras.Block.html#3953" class="Field">payload</a> <a id="3961" class="Symbol">:</a> <a id="3963" href="Peras.Block.html#3011" class="Function">Payload</a>

<a id="3972" class="Keyword">open</a> <a id="3977" href="Peras.Block.html#2969" class="Module">BlockBody</a> <a id="3987" class="Keyword">public</a>
</pre>
<pre class="Agda"><a id="4006" class="Keyword">data</a> <a id="HonestBlock"></a><a id="4011" href="Peras.Block.html#4011" class="Datatype">HonestBlock</a> <a id="4023" class="Symbol">:</a> <a id="4025" href="Peras.Block.html#2950" class="Record">Block</a> <a id="4031" class="Symbol">→</a> <a id="4033" href="Agda.Primitive.html#388" class="Primitive">Set</a> <a id="4037" class="Keyword">where</a>

  <a id="HonestBlock.HonestParty"></a><a id="4046" href="Peras.Block.html#4046" class="InductiveConstructor">HonestParty</a> <a id="4058" class="Symbol">:</a> <a id="4060" class="Symbol">∀</a> <a id="4062" class="Symbol">{</a><a id="4063" href="Peras.Block.html#4063" class="Bound">p</a> <a id="4065" class="Symbol">:</a> <a id="4067" href="Peras.Block.html#1249" class="Function">PartyId</a><a id="4074" class="Symbol">}</a> <a id="4076" class="Symbol">{</a><a id="4077" href="Peras.Block.html#4077" class="Bound">h</a> <a id="4079" class="Symbol">:</a> <a id="4081" href="Peras.Block.html#2015" class="Datatype">Honesty</a> <a id="4089" href="Peras.Block.html#4063" class="Bound">p</a><a id="4090" class="Symbol">}</a> <a id="4092" class="Symbol">{</a><a id="4093" href="Peras.Block.html#4093" class="Bound">b</a> <a id="4095" class="Symbol">:</a> <a id="4097" href="Peras.Block.html#2950" class="Record">Block</a><a id="4102" class="Symbol">}</a>
    <a id="4108" class="Symbol">→</a> <a id="4110" href="Peras.Block.html#3410" class="Field">creatorId</a> <a id="4120" href="Peras.Block.html#4093" class="Bound">b</a> <a id="4122" href="Agda.Builtin.Equality.html#150" class="Datatype Operator">≡</a> <a id="4124" href="Peras.Block.html#4063" class="Bound">p</a>
    <a id="4130" class="Symbol">→</a> <a id="4132" href="Peras.Block.html#4077" class="Bound">h</a> <a id="4134" href="Agda.Builtin.Equality.html#150" class="Datatype Operator">≡</a> <a id="4136" href="Peras.Block.html#2048" class="InductiveConstructor">Honest</a> <a id="4143" class="Symbol">{</a><a id="4144" href="Peras.Block.html#4063" class="Bound">p</a><a id="4145" class="Symbol">}</a>
    <a id="4151" class="Symbol">→</a> <a id="4153" href="Peras.Block.html#4011" class="Datatype">HonestBlock</a> <a id="4165" href="Peras.Block.html#4093" class="Bound">b</a>
</pre>
<!--
<pre class="Agda"><a id="4184" class="Symbol">{-#</a> <a id="4188" class="Keyword">COMPILE</a> <a id="4196" class="Keyword">AGDA2HS</a> <a id="4204" href="Peras.Block.html#3011" class="Function">Payload</a> <a id="4212" class="Symbol">#-}</a>
<a id="4216" class="Symbol">{-#</a> <a id="4220" class="Keyword">COMPILE</a> <a id="4228" class="Keyword">AGDA2HS</a> <a id="4236" href="Peras.Block.html#2950" class="Record">Block</a> <a id="4242" class="Pragma">deriving</a> <a id="4251" class="Pragma">(Generic)</a> <a id="4261" class="Symbol">#-}</a>
<a id="4265" class="Symbol">{-#</a> <a id="4269" class="Keyword">COMPILE</a> <a id="4277" class="Keyword">GHC</a> <a id="4281" href="Peras.Block.html#2950" class="Record">Block</a> <a id="4287" class="Pragma">=</a> <a id="4289" class="Pragma">data</a> <a id="4294" class="Pragma">G.Block</a> <a id="4302" class="Pragma">(G.MkBlock)</a> <a id="4314" class="Symbol">#-}</a>
<a id="4318" class="Symbol">{-#</a> <a id="4322" class="Keyword">COMPILE</a> <a id="4330" class="Keyword">AGDA2HS</a> <a id="4338" href="Peras.Block.html#2969" class="Record">BlockBody</a> <a id="4348" class="Pragma">deriving</a> <a id="4357" class="Pragma">(Generic)</a> <a id="4367" class="Symbol">#-}</a>
<a id="4371" class="Symbol">{-#</a> <a id="4375" class="Keyword">COMPILE</a> <a id="4383" class="Keyword">GHC</a> <a id="4387" href="Peras.Block.html#2969" class="Record">BlockBody</a> <a id="4397" class="Pragma">=</a> <a id="4399" class="Pragma">data</a> <a id="4404" class="Pragma">G.BlockBody</a> <a id="4416" class="Pragma">(G.MkBlockBody)</a> <a id="4432" class="Symbol">#-}</a>
<a id="4436" class="Symbol">{-#</a> <a id="4440" class="Keyword">COMPILE</a> <a id="4448" class="Keyword">AGDA2HS</a> <a id="4456" href="Peras.Block.html#2992" class="Record">Certificate</a> <a id="4468" class="Pragma">deriving</a> <a id="4477" class="Pragma">(Generic)</a> <a id="4487" class="Symbol">#-}</a>
<a id="4491" class="Symbol">{-#</a> <a id="4495" class="Keyword">COMPILE</a> <a id="4503" class="Keyword">GHC</a> <a id="4507" href="Peras.Block.html#2992" class="Record">Certificate</a> <a id="4519" class="Pragma">=</a> <a id="4521" class="Pragma">data</a> <a id="4526" class="Pragma">G.Certificate</a> <a id="4540" class="Pragma">(G.MkCertificate)</a> <a id="4558" class="Symbol">#-}</a>

<a id="4563" class="Keyword">instance</a>
  <a id="iMaybeEq"></a><a id="4574" href="Peras.Block.html#4574" class="Function">iMaybeEq</a> <a id="4583" class="Symbol">:</a> <a id="4585" class="Symbol">{</a><a id="4586" href="Peras.Block.html#4586" class="Bound">a</a> <a id="4588" class="Symbol">:</a> <a id="4590" href="Agda.Primitive.html#388" class="Primitive">Set</a><a id="4593" class="Symbol">}</a> <a id="4595" class="Symbol">→</a> <a id="4597" class="Symbol">⦃</a> <a id="4599" href="Peras.Block.html#4599" class="Bound">i</a> <a id="4601" class="Symbol">:</a> <a id="4603" href="Haskell.Prim.Eq.html#401" class="Record">Eq</a> <a id="4606" href="Peras.Block.html#4586" class="Bound">a</a> <a id="4608" class="Symbol">⦄</a> <a id="4610" class="Symbol">→</a> <a id="4612" href="Haskell.Prim.Eq.html#401" class="Record">Eq</a> <a id="4615" class="Symbol">(</a><a id="4616" href="Agda.Builtin.Maybe.html#135" class="Datatype">Maybe</a> <a id="4622" href="Peras.Block.html#4586" class="Bound">a</a><a id="4623" class="Symbol">)</a>
  <a id="4627" href="Peras.Block.html#4574" class="Function">iMaybeEq</a> <a id="4636" class="Symbol">{{</a><a id="4638" href="Peras.Block.html#4638" class="Bound">i</a><a id="4639" class="Symbol">}}</a> <a id="4642" class="Symbol">.</a><a id="4643" href="Haskell.Prim.Eq.html#453" class="Field Operator">_==_</a> <a id="4648" href="Peras.Block.html#4648" class="Bound">x</a> <a id="4650" href="Peras.Block.html#4650" class="Bound">y</a> <a id="4652" class="Symbol">=</a>
    <a id="4658" href="Data.Maybe.Base.html#1583" class="Function">maybe′</a>
      <a id="4671" class="Symbol">(λ</a> <a id="4674" href="Peras.Block.html#4674" class="Bound">x&#39;</a> <a id="4677" class="Symbol">→</a> <a id="4679" href="Data.Maybe.Base.html#1583" class="Function">maybe′</a> <a id="4686" class="Symbol">(λ</a> <a id="4689" href="Peras.Block.html#4689" class="Bound">y&#39;</a> <a id="4692" class="Symbol">→</a> <a id="4694" href="Peras.Block.html#4674" class="Bound">x&#39;</a> <a id="4697" href="Haskell.Prim.Eq.html#453" class="Field Operator">==</a> <a id="4700" href="Peras.Block.html#4689" class="Bound">y&#39;</a><a id="4702" class="Symbol">)</a> <a id="4704" href="Agda.Builtin.Bool.html#192" class="InductiveConstructor">False</a> <a id="4710" href="Peras.Block.html#4650" class="Bound">y</a><a id="4711" class="Symbol">)</a>
      <a id="4719" class="Symbol">(</a><a id="4720" href="Data.Maybe.Base.html#1583" class="Function">maybe′</a> <a id="4727" class="Symbol">(λ</a> <a id="4730" href="Peras.Block.html#4730" class="Bound">_</a> <a id="4732" class="Symbol">→</a> <a id="4734" href="Agda.Builtin.Bool.html#192" class="InductiveConstructor">False</a><a id="4739" class="Symbol">)</a> <a id="4741" href="Agda.Builtin.Bool.html#198" class="InductiveConstructor">True</a> <a id="4746" href="Peras.Block.html#4650" class="Bound">y</a><a id="4747" class="Symbol">)</a>
      <a id="4755" href="Peras.Block.html#4648" class="Bound">x</a>
</pre>-->
<pre class="Agda">
<a id="4775" class="Keyword">instance</a>
  <a id="iCertificateEq"></a><a id="4786" href="Peras.Block.html#4786" class="Function">iCertificateEq</a> <a id="4801" class="Symbol">:</a> <a id="4803" href="Haskell.Prim.Eq.html#401" class="Record">Eq</a> <a id="4806" href="Peras.Block.html#2992" class="Record">Certificate</a>
  <a id="4820" href="Peras.Block.html#4786" class="Function">iCertificateEq</a> <a id="4835" class="Symbol">.</a><a id="4836" href="Haskell.Prim.Eq.html#453" class="Field Operator">_==_</a> <a id="4841" href="Peras.Block.html#4841" class="Bound">x</a> <a id="4843" href="Peras.Block.html#4843" class="Bound">y</a> <a id="4845" class="Symbol">=</a> <a id="4847" href="Peras.Block.html#3091" class="Field">round</a> <a id="4853" href="Peras.Block.html#4841" class="Bound">x</a> <a id="4855" href="Haskell.Prim.Eq.html#453" class="Field Operator">==</a> <a id="4858" href="Peras.Block.html#3091" class="Field">round</a> <a id="4864" href="Peras.Block.html#4843" class="Bound">y</a> <a id="4866" href="Haskell.Prim.Bool.html#138" class="Function Operator">&amp;&amp;</a> <a id="4869" href="Peras.Block.html#3119" class="Field">blockRef</a> <a id="4878" href="Peras.Block.html#4841" class="Bound">x</a> <a id="4880" href="Haskell.Prim.Eq.html#453" class="Field Operator">==</a> <a id="4883" href="Peras.Block.html#3119" class="Field">blockRef</a> <a id="4892" href="Peras.Block.html#4843" class="Bound">y</a>
  
<a id="4897" class="Keyword">instance</a>
  <a id="iBlockEq"></a><a id="4908" href="Peras.Block.html#4908" class="Function">iBlockEq</a> <a id="4917" class="Symbol">:</a> <a id="4919" href="Haskell.Prim.Eq.html#401" class="Record">Eq</a> <a id="4922" href="Peras.Block.html#2950" class="Record">Block</a>
  <a id="4930" href="Peras.Block.html#4908" class="Function">iBlockEq</a> <a id="4939" class="Symbol">.</a><a id="4940" href="Haskell.Prim.Eq.html#453" class="Field Operator">_==_</a> <a id="4945" href="Peras.Block.html#4945" class="Bound">x</a> <a id="4947" href="Peras.Block.html#4947" class="Bound">y</a> <a id="4949" class="Symbol">=</a> <a id="4951" href="Peras.Block.html#3378" class="Field">slotNumber</a> <a id="4962" href="Peras.Block.html#4945" class="Bound">x</a> <a id="4964" href="Haskell.Prim.Eq.html#453" class="Field Operator">==</a> <a id="4967" href="Peras.Block.html#3378" class="Field">slotNumber</a> <a id="4978" href="Peras.Block.html#4947" class="Bound">y</a>
                         <a id="5005" href="Haskell.Prim.Bool.html#138" class="Function Operator">&amp;&amp;</a> <a id="5008" href="Peras.Block.html#3410" class="Field">creatorId</a> <a id="5018" href="Peras.Block.html#4945" class="Bound">x</a> <a id="5020" href="Haskell.Prim.Eq.html#453" class="Field Operator">==</a> <a id="5023" href="Peras.Block.html#3410" class="Field">creatorId</a> <a id="5033" href="Peras.Block.html#4947" class="Bound">y</a>
                         <a id="5060" href="Haskell.Prim.Bool.html#138" class="Function Operator">&amp;&amp;</a> <a id="5063" href="Peras.Block.html#3438" class="Field">parentBlock</a> <a id="5075" href="Peras.Block.html#4945" class="Bound">x</a> <a id="5077" href="Haskell.Prim.Eq.html#453" class="Field Operator">==</a> <a id="5080" href="Peras.Block.html#3438" class="Field">parentBlock</a> <a id="5092" href="Peras.Block.html#4947" class="Bound">y</a>
                         <a id="5119" href="Haskell.Prim.Bool.html#138" class="Function Operator">&amp;&amp;</a> <a id="5122" href="Peras.Block.html#3511" class="Field">leadershipProof</a> <a id="5138" href="Peras.Block.html#4945" class="Bound">x</a> <a id="5140" href="Haskell.Prim.Eq.html#453" class="Field Operator">==</a> <a id="5143" href="Peras.Block.html#3511" class="Field">leadershipProof</a> <a id="5159" href="Peras.Block.html#4947" class="Bound">y</a>
                         <a id="5186" href="Haskell.Prim.Bool.html#138" class="Function Operator">&amp;&amp;</a> <a id="5189" href="Peras.Block.html#3471" class="Field">certificate</a> <a id="5201" href="Peras.Block.html#4945" class="Bound">x</a> <a id="5203" href="Haskell.Prim.Eq.html#453" class="Field Operator">==</a> <a id="5206" href="Peras.Block.html#3471" class="Field">certificate</a> <a id="5218" href="Peras.Block.html#4947" class="Bound">y</a>
                         <a id="5245" href="Haskell.Prim.Bool.html#138" class="Function Operator">&amp;&amp;</a> <a id="5248" href="Peras.Block.html#3553" class="Field">signature</a> <a id="5258" href="Peras.Block.html#4945" class="Bound">x</a> <a id="5260" href="Haskell.Prim.Eq.html#453" class="Field Operator">==</a> <a id="5263" href="Peras.Block.html#3553" class="Field">signature</a> <a id="5273" href="Peras.Block.html#4947" class="Bound">y</a>
                         <a id="5300" href="Haskell.Prim.Bool.html#138" class="Function Operator">&amp;&amp;</a> <a id="5303" href="Peras.Block.html#3583" class="Field">bodyHash</a> <a id="5312" href="Peras.Block.html#4945" class="Bound">x</a> <a id="5314" href="Haskell.Prim.Eq.html#453" class="Field Operator">==</a> <a id="5317" href="Peras.Block.html#3583" class="Field">bodyHash</a> <a id="5326" href="Peras.Block.html#4947" class="Bound">y</a>
                         <a id="5353" class="Comment">-- FIXME: In principle, we only need to check equality of the signatures.</a>

<a id="5428" class="Keyword">instance</a>
  <a id="iBlockBodyEq"></a><a id="5439" href="Peras.Block.html#5439" class="Function">iBlockBodyEq</a> <a id="5452" class="Symbol">:</a> <a id="5454" href="Haskell.Prim.Eq.html#401" class="Record">Eq</a> <a id="5457" href="Peras.Block.html#2969" class="Record">BlockBody</a>
  <a id="5469" href="Peras.Block.html#5439" class="Function">iBlockBodyEq</a> <a id="5482" class="Symbol">.</a><a id="5483" href="Haskell.Prim.Eq.html#453" class="Field Operator">_==_</a> <a id="5488" href="Peras.Block.html#5488" class="Bound">x</a> <a id="5490" href="Peras.Block.html#5490" class="Bound">y</a> <a id="5492" class="Symbol">=</a> <a id="5494" href="Peras.Block.html#3920" class="Field">blockHash</a> <a id="5504" href="Peras.Block.html#5488" class="Bound">x</a> <a id="5506" href="Haskell.Prim.Eq.html#453" class="Field Operator">==</a> <a id="5509" href="Peras.Block.html#3920" class="Field">blockHash</a> <a id="5519" href="Peras.Block.html#5490" class="Bound">y</a> <a id="5521" href="Haskell.Prim.Bool.html#138" class="Function Operator">&amp;&amp;</a> <a id="5524" href="Peras.Block.html#3953" class="Field">payload</a> <a id="5532" href="Peras.Block.html#5488" class="Bound">x</a> <a id="5534" href="Haskell.Prim.Eq.html#453" class="Field Operator">==</a> <a id="5537" href="Peras.Block.html#3953" class="Field">payload</a> <a id="5545" href="Peras.Block.html#5490" class="Bound">y</a>
 
<a id="5549" class="Keyword">open</a> <a id="5554" href="Peras.Crypto.html#1777" class="Module">Hashable</a>

<a id="5564" class="Keyword">private</a>
  <a id="5574" class="Keyword">instance</a>
    <a id="hashBlock"></a><a id="5587" href="Peras.Block.html#5587" class="Function">hashBlock</a> <a id="5597" class="Symbol">:</a> <a id="5599" href="Peras.Crypto.html#1777" class="Record">Hashable</a> <a id="5608" href="Peras.Block.html#2950" class="Record">Block</a>
    <a id="5618" href="Peras.Block.html#5587" class="Function">hashBlock</a> <a id="5628" class="Symbol">.</a><a id="5629" href="Peras.Crypto.html#1816" class="Field">hash</a> <a id="5634" class="Symbol">=</a> <a id="5636" href="Peras.Crypto.html#1472" class="InductiveConstructor">MkHash</a> <a id="5643" href="Function.Base.html#1115" class="Function Operator">∘</a> <a id="5645" href="Peras.Crypto.html#2954" class="Field">bytesS</a> <a id="5652" href="Function.Base.html#1115" class="Function Operator">∘</a> <a id="5654" href="Peras.Block.html#3553" class="Field">signature</a>
</pre>
<!--
<pre class="Agda"><a id="5682" class="Symbol">{-#</a> <a id="5686" class="Keyword">COMPILE</a> <a id="5694" class="Keyword">AGDA2HS</a> <a id="5702" href="Peras.Block.html#4786" class="Function">iCertificateEq</a> <a id="5717" class="Symbol">#-}</a>
<a id="5721" class="Symbol">{-#</a> <a id="5725" class="Keyword">COMPILE</a> <a id="5733" class="Keyword">AGDA2HS</a> <a id="5741" href="Peras.Block.html#4908" class="Function">iBlockEq</a> <a id="5750" class="Symbol">#-}</a>
<a id="5754" class="Symbol">{-#</a> <a id="5758" class="Keyword">COMPILE</a> <a id="5766" class="Keyword">AGDA2HS</a> <a id="5774" href="Peras.Block.html#5439" class="Function">iBlockBodyEq</a> <a id="5787" class="Symbol">#-}</a>

<a id="5792" class="Symbol">{-#</a> <a id="5796" class="Keyword">COMPILE</a> <a id="5804" class="Keyword">AGDA2HS</a> <a id="5812" href="Peras.Block.html#5587" class="Function">hashBlock</a> <a id="5822" class="Symbol">#-}</a>
</pre>-->
</body>
</html>
