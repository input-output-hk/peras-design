<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>Peras.Block</title>
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    /* The extra [class] is a hack that increases specificity enough to
       override a similar rule in reveal.js */
    ul.task-list[class]{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      font-size: inherit;
      width: 0.8em;
      margin: 0 0.8em 0.2em -1.6em;
      vertical-align: middle;
    }
    .display.math{display: block; text-align: center; margin: 0.5rem auto;}
  </style>
  <link rel="stylesheet" href="Agda.css" />
  <!--[if lt IE 9]>
    <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
  <![endif]-->
</head>
<body>
<pre class="Agda"><a id="9" class="Keyword">module</a> <a id="16" href="Peras.Block.html" class="Module">Peras.Block</a> <a id="28" class="Keyword">where</a>
</pre>
<!--
<pre class="Agda"><a id="52" class="Keyword">open</a> <a id="57" class="Keyword">import</a> <a id="64" href="Data.Bool.html" class="Module">Data.Bool</a> <a id="74" class="Keyword">using</a> <a id="80" class="Symbol">(</a><a id="81" href="Agda.Builtin.Bool.html#173" class="Datatype">Bool</a><a id="85" class="Symbol">;</a> <a id="87" href="Agda.Builtin.Bool.html#198" class="InductiveConstructor">true</a><a id="91" class="Symbol">;</a> <a id="93" href="Agda.Builtin.Bool.html#192" class="InductiveConstructor">false</a><a id="98" class="Symbol">)</a>
<a id="100" class="Keyword">open</a> <a id="105" class="Keyword">import</a> <a id="112" href="Data.List.html" class="Module">Data.List</a> <a id="122" class="Keyword">using</a> <a id="128" class="Symbol">(</a><a id="129" href="Agda.Builtin.List.html#147" class="Datatype">List</a><a id="133" class="Symbol">;</a> <a id="135" href="Data.List.Base.html#4742" class="Function">null</a><a id="139" class="Symbol">;</a> <a id="141" href="Data.List.Base.html#8635" class="Function">head</a><a id="145" class="Symbol">;</a> <a id="147" href="Data.List.Base.html#10878" class="Function">filter</a><a id="153" class="Symbol">)</a>
<a id="155" class="Keyword">open</a> <a id="160" class="Keyword">import</a> <a id="167" href="Data.List.Membership.Propositional.html" class="Module">Data.List.Membership.Propositional</a> <a id="202" class="Keyword">using</a> <a id="208" class="Symbol">(</a><a id="209" href="Data.List.Membership.Setoid.html#950" class="Function Operator">_∈_</a><a id="212" class="Symbol">;</a> <a id="214" href="Data.List.Membership.Setoid.html#999" class="Function Operator">_∉_</a><a id="217" class="Symbol">)</a>
<a id="219" class="Keyword">open</a> <a id="224" class="Keyword">import</a> <a id="231" href="Data.Maybe.html" class="Module">Data.Maybe</a> <a id="242" class="Keyword">using</a> <a id="248" class="Symbol">(</a><a id="249" href="Agda.Builtin.Maybe.html#135" class="Datatype">Maybe</a><a id="254" class="Symbol">;</a> <a id="256" href="Data.Maybe.Base.html#1583" class="Function">maybe′</a><a id="262" class="Symbol">;</a> <a id="264" href="Agda.Builtin.Maybe.html#173" class="InductiveConstructor">just</a><a id="268" class="Symbol">;</a> <a id="270" href="Agda.Builtin.Maybe.html#194" class="InductiveConstructor">nothing</a><a id="277" class="Symbol">)</a>
<a id="279" class="Keyword">open</a> <a id="284" class="Keyword">import</a> <a id="291" href="Data.Nat.html" class="Module">Data.Nat</a> <a id="300" class="Keyword">using</a> <a id="306" class="Symbol">(</a><a id="307" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a><a id="308" class="Symbol">)</a>
<a id="310" class="Keyword">open</a> <a id="315" class="Keyword">import</a> <a id="322" href="Data.Nat.Properties.html" class="Module">Data.Nat.Properties</a> <a id="342" class="Keyword">using</a> <a id="348" class="Symbol">(</a><a id="349" href="Data.Nat.Properties.html#11695" class="Function">&lt;-strictTotalOrder</a><a id="367" class="Symbol">)</a>
<a id="369" class="Keyword">open</a> <a id="374" class="Keyword">import</a> <a id="381" href="Data.Product.html" class="Module">Data.Product</a> <a id="394" class="Keyword">using</a> <a id="400" class="Symbol">(</a><a id="401" href="Agda.Builtin.Sigma.html#165" class="Record">Σ</a><a id="402" class="Symbol">;</a> <a id="404" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">_,_</a><a id="407" class="Symbol">;</a> <a id="409" href="Data.Product.Base.html#852" class="Function">∃</a><a id="410" class="Symbol">;</a> <a id="412" href="Data.Product.Base.html#1244" class="Function">Σ-syntax</a><a id="420" class="Symbol">;</a> <a id="422" href="Data.Product.Base.html#1371" class="Function">∃-syntax</a><a id="430" class="Symbol">;</a> <a id="432" href="Data.Product.Base.html#1618" class="Function Operator">_×_</a><a id="435" class="Symbol">;</a> <a id="437" href="Data.Product.Base.html#636" class="Field">proj₁</a><a id="442" class="Symbol">;</a> <a id="444" href="Data.Product.Base.html#650" class="Field">proj₂</a><a id="449" class="Symbol">)</a>
<a id="451" class="Keyword">open</a> <a id="456" class="Keyword">import</a> <a id="463" href="Data.Unit.html" class="Module">Data.Unit</a> <a id="473" class="Keyword">using</a> <a id="479" class="Symbol">(</a><a id="480" href="Agda.Builtin.Unit.html#175" class="Record">⊤</a><a id="481" class="Symbol">)</a>
<a id="483" class="Keyword">open</a> <a id="488" class="Keyword">import</a> <a id="495" href="Function.html" class="Module">Function</a> <a id="504" class="Keyword">using</a> <a id="510" class="Symbol">(</a><a id="511" href="Function.Base.html#1115" class="Function Operator">_∘_</a><a id="514" class="Symbol">)</a>
<a id="516" class="Keyword">open</a> <a id="521" class="Keyword">import</a> <a id="528" href="Haskell.Prelude.html" class="Module">Haskell.Prelude</a> <a id="544" class="Symbol">as</a> <a id="547" class="Module">Haskell</a> <a id="555" class="Keyword">using</a> <a id="561" class="Symbol">(</a><a id="562" href="Haskell.Prim.Eq.html#401" class="Record">Eq</a><a id="564" class="Symbol">;</a> <a id="566" href="Haskell.Prim.Eq.html#453" class="Field Operator">_==_</a><a id="570" class="Symbol">;</a> <a id="572" href="Agda.Builtin.Bool.html#198" class="InductiveConstructor">True</a><a id="576" class="Symbol">;</a> <a id="578" href="Agda.Builtin.Bool.html#192" class="InductiveConstructor">False</a><a id="583" class="Symbol">;</a> <a id="585" href="Haskell.Prim.Bool.html#138" class="Function Operator">_&amp;&amp;_</a><a id="589" class="Symbol">)</a>
<a id="591" class="Keyword">open</a> <a id="596" class="Keyword">import</a> <a id="603" href="Level.html" class="Module">Level</a> <a id="609" class="Keyword">using</a> <a id="615" class="Symbol">(</a><a id="616" href="Level.html#521" class="Function">0ℓ</a><a id="618" class="Symbol">)</a>
<a id="620" class="Keyword">open</a> <a id="625" class="Keyword">import</a> <a id="632" href="Relation.Binary.html" class="Module">Relation.Binary</a> <a id="648" class="Keyword">using</a> <a id="654" class="Symbol">(</a><a id="655" href="Relation.Binary.Bundles.html#8031" class="Record">StrictTotalOrder</a><a id="671" class="Symbol">;</a> <a id="673" href="Relation.Binary.Definitions.html#6469" class="Function">DecidableEquality</a><a id="690" class="Symbol">)</a>
<a id="692" class="Keyword">open</a> <a id="697" class="Keyword">import</a> <a id="704" href="Relation.Nullary.html" class="Module">Relation.Nullary</a> <a id="721" class="Keyword">using</a> <a id="727" class="Symbol">(</a><a id="728" href="Relation.Nullary.Decidable.Core.html#1618" class="InductiveConstructor">yes</a><a id="731" class="Symbol">;</a> <a id="733" href="Relation.Nullary.Decidable.Core.html#1655" class="InductiveConstructor">no</a><a id="735" class="Symbol">;</a> <a id="737" href="Relation.Nullary.Negation.Core.html#698" class="Function Operator">¬_</a><a id="739" class="Symbol">)</a>

<a id="742" class="Keyword">open</a> <a id="747" class="Keyword">import</a> <a id="754" href="Data.Nat.Properties.html" class="Module">Data.Nat.Properties</a> <a id="774" class="Keyword">using</a> <a id="780" class="Symbol">(</a><a id="781" href="Data.Nat.Properties.html#7413" class="Function">≤-totalOrder</a><a id="793" class="Symbol">)</a>
<a id="795" class="Keyword">open</a> <a id="800" class="Keyword">import</a> <a id="807" href="Data.List.Extrema.html" class="Module">Data.List.Extrema</a> <a id="825" class="Symbol">(</a><a id="826" href="Data.Nat.Properties.html#7413" class="Function">≤-totalOrder</a><a id="838" class="Symbol">)</a> <a id="840" class="Keyword">using</a> <a id="846" class="Symbol">(</a><a id="847" href="Data.List.Extrema.html#1840" class="Function">argmax</a><a id="853" class="Symbol">)</a>

<a id="856" class="Keyword">import</a> <a id="863" href="Relation.Binary.PropositionalEquality.html" class="Module">Relation.Binary.PropositionalEquality</a> <a id="901" class="Symbol">as</a> <a id="904" class="Module">Equ</a>
<a id="908" class="Keyword">open</a> <a id="913" href="Relation.Binary.PropositionalEquality.html" class="Module">Equ</a> <a id="917" class="Keyword">using</a> <a id="923" class="Symbol">(</a><a id="924" href="Agda.Builtin.Equality.html#150" class="Datatype Operator">_≡_</a><a id="927" class="Symbol">;</a> <a id="929" href="Relation.Binary.PropositionalEquality.Core.html#858" class="Function Operator">_≢_</a><a id="932" class="Symbol">;</a> <a id="934" href="Relation.Binary.PropositionalEquality.Core.html#1158" class="Function">cong</a><a id="938" class="Symbol">)</a>

<a id="941" class="Keyword">open</a> <a id="946" class="Keyword">import</a> <a id="953" href="Peras.Crypto.html" class="Module">Peras.Crypto</a>
<a id="966" class="Keyword">open</a> <a id="971" class="Keyword">import</a> <a id="978" href="Peras.Numbering.html" class="Module">Peras.Numbering</a>
<a id="994" class="Keyword">open</a> <a id="999" class="Keyword">import</a> <a id="1006" href="Peras.Util.html" class="Module">Peras.Util</a>

<a id="1018" class="Symbol">{-#</a> <a id="1022" class="Keyword">FOREIGN</a> <a id="1030" class="Pragma">AGDA2HS</a>
<a id="1038" class="Symbol">{-#</a> <a id="1042" class="Pragma">LANGUAGE</a> <a id="1051" class="Pragma">DeriveGeneric</a> <a id="1065" class="Symbol">#-}</a>
<a id="1069" class="Pragma">import</a> <a id="1076" class="Pragma">GHC.Generics</a> <a id="1089" class="Pragma">(Generic)</a>
<a id="1099" class="Pragma">import</a> <a id="1106" class="Pragma">Peras.Crypto</a> <a id="1119" class="Pragma">(Hash</a> <a id="1125" class="Pragma">(..),</a> <a id="1131" class="Pragma">Hashable</a> <a id="1140" class="Pragma">(..))</a>
<a id="1146" class="Pragma">import</a> <a id="1153" class="Pragma">Prelude</a> <a id="1161" class="Pragma">hiding</a> <a id="1168" class="Pragma">(round)</a>
<a id="1176" class="Symbol">#-}</a>

<a id="1181" class="Symbol">{-#</a> <a id="1185" class="Keyword">FOREIGN</a> <a id="1193" class="Pragma">GHC</a>
<a id="1197" class="Pragma">import</a> <a id="1204" class="Pragma">qualified</a> <a id="1214" class="Pragma">Peras.Block</a> <a id="1226" class="Pragma">as</a> <a id="1229" class="Pragma">G</a>
<a id="1231" class="Symbol">#-}</a>
</pre>-->
<h2 id="partyid">PartyId</h2>
<pre class="Agda"><a id="PartyId"></a><a id="1264" href="Peras.Block.html#1264" class="Function">PartyId</a> <a id="1272" class="Symbol">=</a> <a id="1274" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a>  <a id="1277" class="Comment">-- FIXME: Data.Fin ?</a>
</pre>
<!--
<pre class="Agda"><a id="1316" class="Symbol">{-#</a> <a id="1320" class="Keyword">FOREIGN</a> <a id="1328" class="Pragma">AGDA2HS</a>
<a id="1336" class="Pragma">--</a> <a id="1339" class="Pragma">Use</a> <a id="1343" class="Pragma">`Integer`</a> <a id="1353" class="Pragma">for</a> <a id="1357" class="Pragma">compatibility</a> <a id="1371" class="Pragma">with</a> <a id="1376" class="Pragma">`MAlonzo`.</a>
<a id="1387" class="Pragma">type</a> <a id="1392" class="Pragma">PartyId</a> <a id="1400" class="Pragma">=</a> <a id="1402" class="Pragma">Integer</a>
<a id="1410" class="Symbol">#-}</a>
</pre>-->
<p>The party identifier needs to be strictly, totally ordered to be used
as key</p>
<pre class="Agda"><a id="PartyIdO"></a><a id="1509" href="Peras.Block.html#1509" class="Function">PartyIdO</a> <a id="1518" class="Symbol">:</a> <a id="1520" href="Relation.Binary.Bundles.html#8031" class="Record">StrictTotalOrder</a> <a id="1537" href="Level.html#521" class="Function">0ℓ</a> <a id="1540" href="Level.html#521" class="Function">0ℓ</a> <a id="1543" href="Level.html#521" class="Function">0ℓ</a>
<a id="1546" href="Peras.Block.html#1509" class="Function">PartyIdO</a> <a id="1555" class="Symbol">=</a> <a id="1557" href="Data.Nat.Properties.html#11695" class="Function">&lt;-strictTotalOrder</a>
</pre>
<h2 id="party">Party</h2>
<pre class="Agda"><a id="1599" class="Keyword">record</a> <a id="Party"></a><a id="1606" href="Peras.Block.html#1606" class="Record">Party</a> <a id="1612" class="Symbol">:</a> <a id="1614" href="Agda.Primitive.html#388" class="Primitive">Set</a> <a id="1618" class="Keyword">where</a>
  <a id="1626" class="Keyword">constructor</a> <a id="MkParty"></a><a id="1638" href="Peras.Block.html#1638" class="InductiveConstructor">MkParty</a>
  <a id="1648" class="Keyword">field</a> <a id="Party.pid"></a><a id="1654" href="Peras.Block.html#1654" class="Field">pid</a> <a id="1658" class="Symbol">:</a> <a id="1660" href="Peras.Block.html#1264" class="Function">PartyId</a>
        <a id="Party.pkey"></a><a id="1676" href="Peras.Block.html#1676" class="Field">pkey</a> <a id="1681" class="Symbol">:</a> <a id="1683" href="Peras.Crypto.html#3675" class="Record">VerificationKey</a>

<a id="1700" class="Keyword">open</a> <a id="1705" href="Peras.Block.html#1606" class="Module">Party</a> <a id="1711" class="Keyword">public</a>

<a id="1719" class="Keyword">instance</a>
  <a id="iPartyEq"></a><a id="1730" href="Peras.Block.html#1730" class="Function">iPartyEq</a> <a id="1739" class="Symbol">:</a> <a id="1741" href="Haskell.Prim.Eq.html#401" class="Record">Eq</a> <a id="1744" href="Peras.Block.html#1606" class="Record">Party</a>
  <a id="1752" href="Peras.Block.html#1730" class="Function">iPartyEq</a> <a id="1761" class="Symbol">.</a><a id="1762" href="Haskell.Prim.Eq.html#453" class="Field Operator">Haskell._==_</a> <a id="1775" href="Peras.Block.html#1775" class="Bound">x</a> <a id="1777" href="Peras.Block.html#1777" class="Bound">y</a> <a id="1779" class="Symbol">=</a> <a id="1781" href="Peras.Block.html#1654" class="Field">pid</a> <a id="1785" href="Peras.Block.html#1775" class="Bound">x</a> <a id="1787" href="Haskell.Prim.Eq.html#453" class="Field Operator">Haskell.==</a> <a id="1798" href="Peras.Block.html#1654" class="Field">pid</a> <a id="1802" href="Peras.Block.html#1777" class="Bound">y</a> <a id="1804" href="Haskell.Prim.Bool.html#138" class="Function Operator">&amp;&amp;</a> <a id="1807" href="Peras.Block.html#1676" class="Field">pkey</a> <a id="1812" href="Peras.Block.html#1775" class="Bound">x</a> <a id="1814" href="Haskell.Prim.Eq.html#453" class="Field Operator">Haskell.==</a> <a id="1825" href="Peras.Block.html#1676" class="Field">pkey</a> <a id="1830" href="Peras.Block.html#1777" class="Bound">y</a>
</pre>
<!--
<pre class="Agda"><a id="1850" class="Symbol">{-#</a> <a id="1854" class="Keyword">COMPILE</a> <a id="1862" class="Keyword">AGDA2HS</a> <a id="1870" href="Peras.Block.html#1606" class="Record">Party</a> <a id="1876" class="Pragma">deriving</a> <a id="1885" class="Pragma">(Generic)</a> <a id="1895" class="Symbol">#-}</a>
<a id="1899" class="Symbol">{-#</a> <a id="1903" class="Keyword">COMPILE</a> <a id="1911" class="Keyword">GHC</a> <a id="1915" href="Peras.Block.html#1606" class="Record">Party</a> <a id="1921" class="Pragma">=</a> <a id="1923" class="Pragma">data</a> <a id="1928" class="Pragma">G.Party</a> <a id="1936" class="Pragma">(G.MkParty)</a> <a id="1948" class="Symbol">#-}</a>
<a id="1952" class="Symbol">{-#</a> <a id="1956" class="Keyword">COMPILE</a> <a id="1964" class="Keyword">AGDA2HS</a> <a id="1972" href="Peras.Block.html#1730" class="Function">iPartyEq</a> <a id="1981" class="Symbol">#-}</a>
</pre>-->
<h2 id="honesty-of-a-party">Honesty of a party</h2>
<pre class="Agda"><a id="2025" class="Keyword">data</a> <a id="Honesty"></a><a id="2030" href="Peras.Block.html#2030" class="Datatype">Honesty</a> <a id="2038" class="Symbol">:</a> <a id="2040" href="Peras.Block.html#1264" class="Function">PartyId</a> <a id="2048" class="Symbol">→</a> <a id="2050" href="Agda.Primitive.html#388" class="Primitive">Set</a> <a id="2054" class="Keyword">where</a>

  <a id="Honesty.Honest"></a><a id="2063" href="Peras.Block.html#2063" class="InductiveConstructor">Honest</a> <a id="2070" class="Symbol">:</a> <a id="2072" class="Symbol">∀</a> <a id="2074" class="Symbol">{</a><a id="2075" href="Peras.Block.html#2075" class="Bound">p</a> <a id="2077" class="Symbol">:</a> <a id="2079" href="Peras.Block.html#1264" class="Function">PartyId</a><a id="2086" class="Symbol">}</a>
    <a id="2092" class="Symbol">→</a> <a id="2094" href="Peras.Block.html#2030" class="Datatype">Honesty</a> <a id="2102" href="Peras.Block.html#2075" class="Bound">p</a>

  <a id="Honesty.Corrupt"></a><a id="2107" href="Peras.Block.html#2107" class="InductiveConstructor">Corrupt</a> <a id="2115" class="Symbol">:</a> <a id="2117" class="Symbol">∀</a> <a id="2119" class="Symbol">{</a><a id="2120" href="Peras.Block.html#2120" class="Bound">p</a> <a id="2122" class="Symbol">:</a> <a id="2124" href="Peras.Block.html#1264" class="Function">PartyId</a><a id="2131" class="Symbol">}</a>
    <a id="2137" class="Symbol">→</a> <a id="2139" href="Peras.Block.html#2030" class="Datatype">Honesty</a> <a id="2147" href="Peras.Block.html#2120" class="Bound">p</a>
</pre>
<pre class="Agda"><a id="PartyTup"></a><a id="2161" href="Peras.Block.html#2161" class="Function">PartyTup</a> <a id="2170" class="Symbol">=</a> <a id="2172" href="Data.Product.Base.html#1371" class="Function">∃[</a> <a id="2175" href="Peras.Block.html#2175" class="Bound">p</a> <a id="2177" href="Data.Product.Base.html#1371" class="Function">]</a> <a id="2179" class="Symbol">(</a><a id="2180" href="Peras.Block.html#2030" class="Datatype">Honesty</a> <a id="2188" href="Peras.Block.html#2175" class="Bound">p</a><a id="2189" class="Symbol">)</a>
<a id="Parties"></a><a id="2191" href="Peras.Block.html#2191" class="Function">Parties</a> <a id="2199" class="Symbol">=</a> <a id="2201" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="2206" href="Peras.Block.html#2161" class="Function">PartyTup</a>
</pre>
<pre class="Agda"><a id="2228" class="Keyword">postulate</a>
  <a id="Honest≢Corrupt"></a><a id="2240" href="Peras.Block.html#2240" class="Postulate">Honest≢Corrupt</a> <a id="2255" class="Symbol">:</a> <a id="2257" class="Symbol">∀</a> <a id="2259" class="Symbol">{</a><a id="2260" href="Peras.Block.html#2260" class="Bound">p₁</a> <a id="2263" href="Peras.Block.html#2263" class="Bound">p₂</a><a id="2265" class="Symbol">}</a> <a id="2267" class="Symbol">{</a><a id="2268" href="Peras.Block.html#2268" class="Bound">h₁</a> <a id="2271" class="Symbol">:</a> <a id="2273" href="Peras.Block.html#2030" class="Datatype">Honesty</a> <a id="2281" href="Peras.Block.html#2260" class="Bound">p₁</a><a id="2283" class="Symbol">}</a> <a id="2285" class="Symbol">{</a><a id="2286" href="Peras.Block.html#2286" class="Bound">h₂</a> <a id="2289" class="Symbol">:</a> <a id="2291" href="Peras.Block.html#2030" class="Datatype">Honesty</a> <a id="2299" href="Peras.Block.html#2263" class="Bound">p₂</a><a id="2301" class="Symbol">}</a>
    <a id="2307" class="Symbol">→</a> <a id="2309" href="Peras.Block.html#2268" class="Bound">h₁</a> <a id="2312" href="Agda.Builtin.Equality.html#150" class="Datatype Operator">≡</a> <a id="2314" href="Peras.Block.html#2063" class="InductiveConstructor">Honest</a>
    <a id="2325" class="Symbol">→</a> <a id="2327" href="Peras.Block.html#2286" class="Bound">h₂</a> <a id="2330" href="Agda.Builtin.Equality.html#150" class="Datatype Operator">≡</a> <a id="2332" href="Peras.Block.html#2107" class="InductiveConstructor">Corrupt</a>
    <a id="2344" class="Symbol">→</a> <a id="2346" href="Peras.Block.html#2260" class="Bound">p₁</a> <a id="2349" href="Relation.Binary.PropositionalEquality.Core.html#858" class="Function Operator">≢</a> <a id="2351" href="Peras.Block.html#2263" class="Bound">p₂</a>

<a id="isHonest"></a><a id="2355" href="Peras.Block.html#2355" class="Function">isHonest</a> <a id="2364" class="Symbol">:</a> <a id="2366" class="Symbol">∀</a> <a id="2368" class="Symbol">{</a><a id="2369" href="Peras.Block.html#2369" class="Bound">p</a> <a id="2371" class="Symbol">:</a> <a id="2373" href="Peras.Block.html#1264" class="Function">PartyId</a><a id="2380" class="Symbol">}</a> <a id="2382" class="Symbol">→</a> <a id="2384" href="Peras.Block.html#2030" class="Datatype">Honesty</a> <a id="2392" href="Peras.Block.html#2369" class="Bound">p</a> <a id="2394" class="Symbol">→</a> <a id="2396" href="Agda.Builtin.Bool.html#173" class="Datatype">Bool</a>
<a id="2401" href="Peras.Block.html#2355" class="Function">isHonest</a> <a id="2410" class="Symbol">{</a><a id="2411" href="Peras.Block.html#2411" class="Bound">p</a><a id="2412" class="Symbol">}</a> <a id="2414" href="Peras.Block.html#2063" class="InductiveConstructor">Honest</a> <a id="2421" class="Symbol">=</a> <a id="2423" href="Agda.Builtin.Bool.html#198" class="InductiveConstructor">true</a>
<a id="2428" href="Peras.Block.html#2355" class="Function">isHonest</a> <a id="2437" class="Symbol">{</a><a id="2438" href="Peras.Block.html#2438" class="Bound">p</a><a id="2439" class="Symbol">}</a> <a id="2441" href="Peras.Block.html#2107" class="InductiveConstructor">Corrupt</a> <a id="2449" class="Symbol">=</a> <a id="2451" href="Agda.Builtin.Bool.html#192" class="InductiveConstructor">false</a>
</pre>
<h2 id="transactions">Transactions</h2>
<pre class="Agda"><a id="Tx"></a><a id="2487" href="Peras.Block.html#2487" class="Function">Tx</a> <a id="2490" class="Symbol">=</a> <a id="2492" href="Agda.Builtin.Unit.html#175" class="Record">⊤</a>
</pre>
<!--
<pre class="Agda"><a id="2512" class="Symbol">{-#</a> <a id="2516" class="Keyword">COMPILE</a> <a id="2524" class="Keyword">AGDA2HS</a> <a id="2532" href="Peras.Block.html#2487" class="Function">Tx</a> <a id="2535" class="Symbol">#-}</a>
</pre>-->
<h2 id="block-and-certificate">Block and Certificate</h2>
<p>In addition to a Praos block, there is an optional field for the
included certificate. <strong>Note</strong>: What we name
<code>Block</code> is actually a block <em>Header</em>, we use
<code>BlockBody</code> to contain the payload.</p>
<p>A Peras Certificate represents an aggregated quorum of votes for a
specific block at a specific round. Such a certificate is supposed to be
self-contained and verifiable by any node.</p>
<pre class="Agda"><a id="2958" class="Keyword">record</a> <a id="Block"></a><a id="2965" href="Peras.Block.html#2965" class="Record">Block</a> <a id="2971" class="Symbol">:</a> <a id="2973" href="Agda.Primitive.html#388" class="Primitive">Set</a>
<a id="2977" class="Keyword">record</a> <a id="BlockBody"></a><a id="2984" href="Peras.Block.html#2984" class="Record">BlockBody</a> <a id="2994" class="Symbol">:</a> <a id="2996" href="Agda.Primitive.html#388" class="Primitive">Set</a>
<a id="3000" class="Keyword">record</a> <a id="Certificate"></a><a id="3007" href="Peras.Block.html#3007" class="Record">Certificate</a> <a id="3019" class="Symbol">:</a> <a id="3021" href="Agda.Primitive.html#388" class="Primitive">Set</a>

<a id="Payload"></a><a id="3026" href="Peras.Block.html#3026" class="Function">Payload</a> <a id="3034" class="Symbol">=</a> <a id="3036" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="3041" href="Peras.Block.html#2487" class="Function">Tx</a>

<a id="3045" class="Keyword">record</a> <a id="3052" href="Peras.Block.html#3007" class="Record">Certificate</a> <a id="3064" class="Keyword">where</a>
  <a id="3072" class="Keyword">constructor</a> <a id="MkCertificate"></a><a id="3084" href="Peras.Block.html#3084" class="InductiveConstructor">MkCertificate</a>
  <a id="3100" class="Keyword">field</a> <a id="Certificate.round"></a><a id="3106" href="Peras.Block.html#3106" class="Field">round</a> <a id="3112" class="Symbol">:</a> <a id="3114" href="Peras.Numbering.html#1669" class="Record">RoundNumber</a>
        <a id="Certificate.blockRef"></a><a id="3134" href="Peras.Block.html#3134" class="Field">blockRef</a> <a id="3143" class="Symbol">:</a> <a id="3145" href="Peras.Crypto.html#1542" class="Record">Hash</a> <a id="3150" href="Peras.Block.html#2965" class="Record">Block</a>

  <a id="Certificate.roundNumber"></a><a id="3159" href="Peras.Block.html#3159" class="Function">roundNumber</a> <a id="3171" class="Symbol">:</a> <a id="3173" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a>
  <a id="3177" href="Peras.Block.html#3159" class="Function">roundNumber</a> <a id="3189" class="Symbol">=</a> <a id="3191" href="Peras.Numbering.html#1729" class="Field">getRoundNumber</a> <a id="3206" href="Peras.Block.html#3106" class="Field">round</a>

<a id="3213" class="Keyword">open</a> <a id="3218" href="Peras.Block.html#3007" class="Module">Certificate</a> <a id="3230" class="Keyword">public</a>

<a id="latestCert"></a><a id="3238" href="Peras.Block.html#3238" class="Function">latestCert</a> <a id="3249" class="Symbol">:</a> <a id="3251" href="Peras.Block.html#3007" class="Record">Certificate</a> <a id="3263" class="Symbol">→</a> <a id="3265" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="3270" href="Peras.Block.html#3007" class="Record">Certificate</a> <a id="3282" class="Symbol">→</a> <a id="3284" href="Peras.Block.html#3007" class="Record">Certificate</a>
<a id="3296" href="Peras.Block.html#3238" class="Function">latestCert</a> <a id="3307" href="Peras.Block.html#3307" class="Bound">c</a> <a id="3309" class="Symbol">=</a> <a id="3311" href="Peras.Util.html#467" class="Function">maximumBy</a> <a id="3321" href="Peras.Block.html#3307" class="Bound">c</a> <a id="3323" class="Symbol">(</a><a id="3324" href="Peras.Util.html#727" class="Function">comparing</a> <a id="3334" href="Peras.Block.html#3106" class="Field">round</a><a id="3339" class="Symbol">)</a>

<a id="3342" class="Keyword">record</a> <a id="3349" href="Peras.Block.html#2965" class="Record">Block</a> <a id="3355" class="Keyword">where</a>
  <a id="3363" class="Keyword">constructor</a> <a id="MkBlock"></a><a id="3375" href="Peras.Block.html#3375" class="InductiveConstructor">MkBlock</a>
  <a id="3385" class="Keyword">field</a> <a id="Block.slotNumber"></a><a id="3391" href="Peras.Block.html#3391" class="Field">slotNumber</a> <a id="3402" class="Symbol">:</a> <a id="3404" href="Peras.Numbering.html#742" class="Record">SlotNumber</a>
        <a id="Block.creatorId"></a><a id="3423" href="Peras.Block.html#3423" class="Field">creatorId</a> <a id="3433" class="Symbol">:</a> <a id="3435" href="Peras.Block.html#1264" class="Function">PartyId</a>
        <a id="Block.parentBlock"></a><a id="3451" href="Peras.Block.html#3451" class="Field">parentBlock</a> <a id="3463" class="Symbol">:</a> <a id="3465" href="Peras.Crypto.html#1542" class="Record">Hash</a> <a id="3470" href="Peras.Block.html#2965" class="Record">Block</a>
        <a id="Block.certificate"></a><a id="3484" href="Peras.Block.html#3484" class="Field">certificate</a> <a id="3496" class="Symbol">:</a> <a id="3498" href="Agda.Builtin.Maybe.html#135" class="Datatype">Maybe</a> <a id="3504" href="Peras.Block.html#3007" class="Record">Certificate</a>
        <a id="Block.leadershipProof"></a><a id="3524" href="Peras.Block.html#3524" class="Field">leadershipProof</a> <a id="3540" class="Symbol">:</a> <a id="3542" href="Peras.Crypto.html#2593" class="Record">LeadershipProof</a>
        <a id="Block.signature"></a><a id="3566" href="Peras.Block.html#3566" class="Field">signature</a> <a id="3576" class="Symbol">:</a> <a id="3578" href="Peras.Crypto.html#3115" class="Record">Signature</a>
        <a id="Block.bodyHash"></a><a id="3596" href="Peras.Block.html#3596" class="Field">bodyHash</a> <a id="3605" class="Symbol">:</a> <a id="3607" href="Peras.Crypto.html#1542" class="Record">Hash</a> <a id="3612" href="Peras.Block.html#3026" class="Function">Payload</a>

  <a id="Block.slotNumber&#39;"></a><a id="3623" href="Peras.Block.html#3623" class="Function">slotNumber&#39;</a> <a id="3635" class="Symbol">:</a> <a id="3637" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a>
  <a id="3641" href="Peras.Block.html#3623" class="Function">slotNumber&#39;</a> <a id="3653" class="Symbol">=</a> <a id="3655" href="Peras.Numbering.html#800" class="Field">getSlotNumber</a> <a id="3669" href="Peras.Block.html#3391" class="Field">slotNumber</a>

<a id="3681" class="Keyword">open</a> <a id="3686" href="Peras.Block.html#2965" class="Module">Block</a> <a id="3692" class="Keyword">public</a>

<a id="_≟-BlockHash_"></a><a id="3700" href="Peras.Block.html#3700" class="Function Operator">_≟-BlockHash_</a> <a id="3714" class="Symbol">:</a> <a id="3716" href="Relation.Binary.Definitions.html#6469" class="Function">DecidableEquality</a> <a id="3734" class="Symbol">(</a><a id="3735" href="Peras.Crypto.html#1542" class="Record">Hash</a> <a id="3740" href="Peras.Block.html#2965" class="Record">Block</a><a id="3745" class="Symbol">)</a>
<a id="3747" class="Symbol">(</a><a id="3748" href="Peras.Crypto.html#1583" class="InductiveConstructor">MkHash</a> <a id="3755" href="Peras.Block.html#3755" class="Bound">b₁</a><a id="3757" class="Symbol">)</a> <a id="3759" href="Peras.Block.html#3700" class="Function Operator">≟-BlockHash</a> <a id="3771" class="Symbol">(</a><a id="3772" href="Peras.Crypto.html#1583" class="InductiveConstructor">MkHash</a> <a id="3779" href="Peras.Block.html#3779" class="Bound">b₂</a><a id="3781" class="Symbol">)</a> <a id="3783" class="Keyword">with</a> <a id="3788" href="Peras.Block.html#3755" class="Bound">b₁</a> <a id="3791" href="Peras.Crypto.html#825" class="Postulate Operator">≟-BS</a> <a id="3796" href="Peras.Block.html#3779" class="Bound">b₂</a>
<a id="3799" class="Symbol">...</a> <a id="3803" class="Symbol">|</a> <a id="3805" href="Relation.Nullary.Decidable.Core.html#1618" class="InductiveConstructor">yes</a> <a id="3809" href="Peras.Block.html#3809" class="Bound">p</a> <a id="3811" class="Symbol">=</a> <a id="3813" href="Relation.Nullary.Decidable.Core.html#1618" class="InductiveConstructor">yes</a> <a id="3817" class="Symbol">(</a><a id="3818" href="Relation.Binary.PropositionalEquality.Core.html#1158" class="Function">cong</a> <a id="3823" href="Peras.Crypto.html#1583" class="InductiveConstructor">MkHash</a> <a id="3830" href="Peras.Block.html#3809" class="Bound">p</a><a id="3831" class="Symbol">)</a>
<a id="3833" class="Symbol">...</a> <a id="3837" class="Symbol">|</a> <a id="3839" href="Relation.Nullary.Decidable.Core.html#1655" class="InductiveConstructor">no</a> <a id="3842" href="Peras.Block.html#3842" class="Bound">¬p</a> <a id="3845" class="Symbol">=</a>  <a id="3848" href="Relation.Nullary.Decidable.Core.html#1655" class="InductiveConstructor">no</a> <a id="3851" class="Symbol">(</a><a id="3852" href="Peras.Block.html#3842" class="Bound">¬p</a> <a id="3855" href="Function.Base.html#1115" class="Function Operator">∘</a> <a id="3857" href="Relation.Binary.PropositionalEquality.Core.html#1158" class="Function">cong</a> <a id="3862" href="Peras.Crypto.html#1598" class="Field">hashBytes</a><a id="3871" class="Symbol">)</a>

<a id="3874" class="Keyword">record</a> <a id="3881" href="Peras.Block.html#2984" class="Record">BlockBody</a> <a id="3891" class="Keyword">where</a>
  <a id="3899" class="Keyword">constructor</a> <a id="MkBlockBody"></a><a id="3911" href="Peras.Block.html#3911" class="InductiveConstructor">MkBlockBody</a>
  <a id="3925" class="Keyword">field</a> <a id="BlockBody.blockHash"></a><a id="3931" href="Peras.Block.html#3931" class="Field">blockHash</a> <a id="3941" class="Symbol">:</a> <a id="3943" href="Peras.Crypto.html#1542" class="Record">Hash</a> <a id="3948" href="Peras.Block.html#3026" class="Function">Payload</a>
        <a id="BlockBody.payload"></a><a id="3964" href="Peras.Block.html#3964" class="Field">payload</a> <a id="3972" class="Symbol">:</a> <a id="3974" href="Peras.Block.html#3026" class="Function">Payload</a>

<a id="3983" class="Keyword">open</a> <a id="3988" href="Peras.Block.html#2984" class="Module">BlockBody</a> <a id="3998" class="Keyword">public</a>
</pre>
<pre class="Agda"><a id="4017" class="Keyword">data</a> <a id="HonestBlock"></a><a id="4022" href="Peras.Block.html#4022" class="Datatype">HonestBlock</a> <a id="4034" class="Symbol">:</a> <a id="4036" href="Peras.Block.html#2965" class="Record">Block</a> <a id="4042" class="Symbol">→</a> <a id="4044" href="Agda.Primitive.html#388" class="Primitive">Set</a> <a id="4048" class="Keyword">where</a>

  <a id="HonestBlock.HonestParty"></a><a id="4057" href="Peras.Block.html#4057" class="InductiveConstructor">HonestParty</a> <a id="4069" class="Symbol">:</a> <a id="4071" class="Symbol">∀</a> <a id="4073" class="Symbol">{</a><a id="4074" href="Peras.Block.html#4074" class="Bound">p</a> <a id="4076" class="Symbol">:</a> <a id="4078" href="Peras.Block.html#1264" class="Function">PartyId</a><a id="4085" class="Symbol">}</a> <a id="4087" class="Symbol">{</a><a id="4088" href="Peras.Block.html#4088" class="Bound">h</a> <a id="4090" class="Symbol">:</a> <a id="4092" href="Peras.Block.html#2030" class="Datatype">Honesty</a> <a id="4100" href="Peras.Block.html#4074" class="Bound">p</a><a id="4101" class="Symbol">}</a> <a id="4103" class="Symbol">{</a><a id="4104" href="Peras.Block.html#4104" class="Bound">b</a> <a id="4106" class="Symbol">:</a> <a id="4108" href="Peras.Block.html#2965" class="Record">Block</a><a id="4113" class="Symbol">}</a>
    <a id="4119" class="Symbol">→</a> <a id="4121" href="Peras.Block.html#3423" class="Field">creatorId</a> <a id="4131" href="Peras.Block.html#4104" class="Bound">b</a> <a id="4133" href="Agda.Builtin.Equality.html#150" class="Datatype Operator">≡</a> <a id="4135" href="Peras.Block.html#4074" class="Bound">p</a>
    <a id="4141" class="Symbol">→</a> <a id="4143" href="Peras.Block.html#4088" class="Bound">h</a> <a id="4145" href="Agda.Builtin.Equality.html#150" class="Datatype Operator">≡</a> <a id="4147" href="Peras.Block.html#2063" class="InductiveConstructor">Honest</a> <a id="4154" class="Symbol">{</a><a id="4155" href="Peras.Block.html#4074" class="Bound">p</a><a id="4156" class="Symbol">}</a>
    <a id="4162" class="Symbol">→</a> <a id="4164" href="Peras.Block.html#4022" class="Datatype">HonestBlock</a> <a id="4176" href="Peras.Block.html#4104" class="Bound">b</a>
</pre>
<!--
<pre class="Agda"><a id="4195" class="Symbol">{-#</a> <a id="4199" class="Keyword">COMPILE</a> <a id="4207" class="Keyword">AGDA2HS</a> <a id="4215" href="Peras.Block.html#3026" class="Function">Payload</a> <a id="4223" class="Symbol">#-}</a>
<a id="4227" class="Symbol">{-#</a> <a id="4231" class="Keyword">COMPILE</a> <a id="4239" class="Keyword">AGDA2HS</a> <a id="4247" href="Peras.Block.html#2965" class="Record">Block</a> <a id="4253" class="Pragma">deriving</a> <a id="4262" class="Pragma">(Generic)</a> <a id="4272" class="Symbol">#-}</a>
<a id="4276" class="Symbol">{-#</a> <a id="4280" class="Keyword">COMPILE</a> <a id="4288" class="Keyword">GHC</a> <a id="4292" href="Peras.Block.html#2965" class="Record">Block</a> <a id="4298" class="Pragma">=</a> <a id="4300" class="Pragma">data</a> <a id="4305" class="Pragma">G.Block</a> <a id="4313" class="Pragma">(G.MkBlock)</a> <a id="4325" class="Symbol">#-}</a>
<a id="4329" class="Symbol">{-#</a> <a id="4333" class="Keyword">COMPILE</a> <a id="4341" class="Keyword">AGDA2HS</a> <a id="4349" href="Peras.Block.html#2984" class="Record">BlockBody</a> <a id="4359" class="Pragma">deriving</a> <a id="4368" class="Pragma">(Generic)</a> <a id="4378" class="Symbol">#-}</a>
<a id="4382" class="Symbol">{-#</a> <a id="4386" class="Keyword">COMPILE</a> <a id="4394" class="Keyword">GHC</a> <a id="4398" href="Peras.Block.html#2984" class="Record">BlockBody</a> <a id="4408" class="Pragma">=</a> <a id="4410" class="Pragma">data</a> <a id="4415" class="Pragma">G.BlockBody</a> <a id="4427" class="Pragma">(G.MkBlockBody)</a> <a id="4443" class="Symbol">#-}</a>
<a id="4447" class="Symbol">{-#</a> <a id="4451" class="Keyword">COMPILE</a> <a id="4459" class="Keyword">AGDA2HS</a> <a id="4467" href="Peras.Block.html#3007" class="Record">Certificate</a> <a id="4479" class="Pragma">deriving</a> <a id="4488" class="Pragma">(Generic)</a> <a id="4498" class="Symbol">#-}</a>
<a id="4502" class="Symbol">{-#</a> <a id="4506" class="Keyword">COMPILE</a> <a id="4514" class="Keyword">GHC</a> <a id="4518" href="Peras.Block.html#3007" class="Record">Certificate</a> <a id="4530" class="Pragma">=</a> <a id="4532" class="Pragma">data</a> <a id="4537" class="Pragma">G.Certificate</a> <a id="4551" class="Pragma">(G.MkCertificate)</a> <a id="4569" class="Symbol">#-}</a>

<a id="4574" class="Keyword">instance</a>
  <a id="iMaybeEq"></a><a id="4585" href="Peras.Block.html#4585" class="Function">iMaybeEq</a> <a id="4594" class="Symbol">:</a> <a id="4596" class="Symbol">{</a><a id="4597" href="Peras.Block.html#4597" class="Bound">a</a> <a id="4599" class="Symbol">:</a> <a id="4601" href="Agda.Primitive.html#388" class="Primitive">Set</a><a id="4604" class="Symbol">}</a> <a id="4606" class="Symbol">→</a> <a id="4608" class="Symbol">⦃</a> <a id="4610" href="Peras.Block.html#4610" class="Bound">i</a> <a id="4612" class="Symbol">:</a> <a id="4614" href="Haskell.Prim.Eq.html#401" class="Record">Eq</a> <a id="4617" href="Peras.Block.html#4597" class="Bound">a</a> <a id="4619" class="Symbol">⦄</a> <a id="4621" class="Symbol">→</a> <a id="4623" href="Haskell.Prim.Eq.html#401" class="Record">Eq</a> <a id="4626" class="Symbol">(</a><a id="4627" href="Agda.Builtin.Maybe.html#135" class="Datatype">Maybe</a> <a id="4633" href="Peras.Block.html#4597" class="Bound">a</a><a id="4634" class="Symbol">)</a>
  <a id="4638" href="Peras.Block.html#4585" class="Function">iMaybeEq</a> <a id="4647" class="Symbol">{{</a><a id="4649" href="Peras.Block.html#4649" class="Bound">i</a><a id="4650" class="Symbol">}}</a> <a id="4653" class="Symbol">.</a><a id="4654" href="Haskell.Prim.Eq.html#453" class="Field Operator">_==_</a> <a id="4659" href="Peras.Block.html#4659" class="Bound">x</a> <a id="4661" href="Peras.Block.html#4661" class="Bound">y</a> <a id="4663" class="Symbol">=</a>
    <a id="4669" href="Data.Maybe.Base.html#1583" class="Function">maybe′</a>
      <a id="4682" class="Symbol">(λ</a> <a id="4685" href="Peras.Block.html#4685" class="Bound">x&#39;</a> <a id="4688" class="Symbol">→</a> <a id="4690" href="Data.Maybe.Base.html#1583" class="Function">maybe′</a> <a id="4697" class="Symbol">(λ</a> <a id="4700" href="Peras.Block.html#4700" class="Bound">y&#39;</a> <a id="4703" class="Symbol">→</a> <a id="4705" href="Peras.Block.html#4685" class="Bound">x&#39;</a> <a id="4708" href="Haskell.Prim.Eq.html#453" class="Field Operator">==</a> <a id="4711" href="Peras.Block.html#4700" class="Bound">y&#39;</a><a id="4713" class="Symbol">)</a> <a id="4715" href="Agda.Builtin.Bool.html#192" class="InductiveConstructor">False</a> <a id="4721" href="Peras.Block.html#4661" class="Bound">y</a><a id="4722" class="Symbol">)</a>
      <a id="4730" class="Symbol">(</a><a id="4731" href="Data.Maybe.Base.html#1583" class="Function">maybe′</a> <a id="4738" class="Symbol">(λ</a> <a id="4741" href="Peras.Block.html#4741" class="Bound">_</a> <a id="4743" class="Symbol">→</a> <a id="4745" href="Agda.Builtin.Bool.html#192" class="InductiveConstructor">False</a><a id="4750" class="Symbol">)</a> <a id="4752" href="Agda.Builtin.Bool.html#198" class="InductiveConstructor">True</a> <a id="4757" href="Peras.Block.html#4661" class="Bound">y</a><a id="4758" class="Symbol">)</a>
      <a id="4766" href="Peras.Block.html#4659" class="Bound">x</a>
</pre>-->
<pre class="Agda">
<a id="4786" class="Keyword">instance</a>
  <a id="iCertificateEq"></a><a id="4797" href="Peras.Block.html#4797" class="Function">iCertificateEq</a> <a id="4812" class="Symbol">:</a> <a id="4814" href="Haskell.Prim.Eq.html#401" class="Record">Eq</a> <a id="4817" href="Peras.Block.html#3007" class="Record">Certificate</a>
  <a id="4831" href="Peras.Block.html#4797" class="Function">iCertificateEq</a> <a id="4846" class="Symbol">.</a><a id="4847" href="Haskell.Prim.Eq.html#453" class="Field Operator">_==_</a> <a id="4852" href="Peras.Block.html#4852" class="Bound">x</a> <a id="4854" href="Peras.Block.html#4854" class="Bound">y</a> <a id="4856" class="Symbol">=</a> <a id="4858" href="Peras.Block.html#3106" class="Field">round</a> <a id="4864" href="Peras.Block.html#4852" class="Bound">x</a> <a id="4866" href="Haskell.Prim.Eq.html#453" class="Field Operator">==</a> <a id="4869" href="Peras.Block.html#3106" class="Field">round</a> <a id="4875" href="Peras.Block.html#4854" class="Bound">y</a> <a id="4877" href="Haskell.Prim.Bool.html#138" class="Function Operator">&amp;&amp;</a> <a id="4880" href="Peras.Block.html#3134" class="Field">blockRef</a> <a id="4889" href="Peras.Block.html#4852" class="Bound">x</a> <a id="4891" href="Haskell.Prim.Eq.html#453" class="Field Operator">==</a> <a id="4894" href="Peras.Block.html#3134" class="Field">blockRef</a> <a id="4903" href="Peras.Block.html#4854" class="Bound">y</a>

<a id="4906" class="Keyword">instance</a>
  <a id="iBlockEq"></a><a id="4917" href="Peras.Block.html#4917" class="Function">iBlockEq</a> <a id="4926" class="Symbol">:</a> <a id="4928" href="Haskell.Prim.Eq.html#401" class="Record">Eq</a> <a id="4931" href="Peras.Block.html#2965" class="Record">Block</a>
  <a id="4939" href="Peras.Block.html#4917" class="Function">iBlockEq</a> <a id="4948" class="Symbol">.</a><a id="4949" href="Haskell.Prim.Eq.html#453" class="Field Operator">_==_</a> <a id="4954" href="Peras.Block.html#4954" class="Bound">x</a> <a id="4956" href="Peras.Block.html#4956" class="Bound">y</a> <a id="4958" class="Symbol">=</a> <a id="4960" href="Peras.Block.html#3391" class="Field">slotNumber</a> <a id="4971" href="Peras.Block.html#4954" class="Bound">x</a> <a id="4973" href="Haskell.Prim.Eq.html#453" class="Field Operator">==</a> <a id="4976" href="Peras.Block.html#3391" class="Field">slotNumber</a> <a id="4987" href="Peras.Block.html#4956" class="Bound">y</a>
                         <a id="5014" href="Haskell.Prim.Bool.html#138" class="Function Operator">&amp;&amp;</a> <a id="5017" href="Peras.Block.html#3423" class="Field">creatorId</a> <a id="5027" href="Peras.Block.html#4954" class="Bound">x</a> <a id="5029" href="Haskell.Prim.Eq.html#453" class="Field Operator">==</a> <a id="5032" href="Peras.Block.html#3423" class="Field">creatorId</a> <a id="5042" href="Peras.Block.html#4956" class="Bound">y</a>
                         <a id="5069" href="Haskell.Prim.Bool.html#138" class="Function Operator">&amp;&amp;</a> <a id="5072" href="Peras.Block.html#3451" class="Field">parentBlock</a> <a id="5084" href="Peras.Block.html#4954" class="Bound">x</a> <a id="5086" href="Haskell.Prim.Eq.html#453" class="Field Operator">==</a> <a id="5089" href="Peras.Block.html#3451" class="Field">parentBlock</a> <a id="5101" href="Peras.Block.html#4956" class="Bound">y</a>
                         <a id="5128" href="Haskell.Prim.Bool.html#138" class="Function Operator">&amp;&amp;</a> <a id="5131" href="Peras.Block.html#3524" class="Field">leadershipProof</a> <a id="5147" href="Peras.Block.html#4954" class="Bound">x</a> <a id="5149" href="Haskell.Prim.Eq.html#453" class="Field Operator">==</a> <a id="5152" href="Peras.Block.html#3524" class="Field">leadershipProof</a> <a id="5168" href="Peras.Block.html#4956" class="Bound">y</a>
                         <a id="5195" href="Haskell.Prim.Bool.html#138" class="Function Operator">&amp;&amp;</a> <a id="5198" href="Peras.Block.html#3484" class="Field">certificate</a> <a id="5210" href="Peras.Block.html#4954" class="Bound">x</a> <a id="5212" href="Haskell.Prim.Eq.html#453" class="Field Operator">==</a> <a id="5215" href="Peras.Block.html#3484" class="Field">certificate</a> <a id="5227" href="Peras.Block.html#4956" class="Bound">y</a>
                         <a id="5254" href="Haskell.Prim.Bool.html#138" class="Function Operator">&amp;&amp;</a> <a id="5257" href="Peras.Block.html#3566" class="Field">signature</a> <a id="5267" href="Peras.Block.html#4954" class="Bound">x</a> <a id="5269" href="Haskell.Prim.Eq.html#453" class="Field Operator">==</a> <a id="5272" href="Peras.Block.html#3566" class="Field">signature</a> <a id="5282" href="Peras.Block.html#4956" class="Bound">y</a>
                         <a id="5309" href="Haskell.Prim.Bool.html#138" class="Function Operator">&amp;&amp;</a> <a id="5312" href="Peras.Block.html#3596" class="Field">bodyHash</a> <a id="5321" href="Peras.Block.html#4954" class="Bound">x</a> <a id="5323" href="Haskell.Prim.Eq.html#453" class="Field Operator">==</a> <a id="5326" href="Peras.Block.html#3596" class="Field">bodyHash</a> <a id="5335" href="Peras.Block.html#4956" class="Bound">y</a>
                         <a id="5362" class="Comment">-- FIXME: In principle, we only need to check equality of the signatures.</a>

<a id="5437" class="Keyword">instance</a>
  <a id="iBlockBodyEq"></a><a id="5448" href="Peras.Block.html#5448" class="Function">iBlockBodyEq</a> <a id="5461" class="Symbol">:</a> <a id="5463" href="Haskell.Prim.Eq.html#401" class="Record">Eq</a> <a id="5466" href="Peras.Block.html#2984" class="Record">BlockBody</a>
  <a id="5478" href="Peras.Block.html#5448" class="Function">iBlockBodyEq</a> <a id="5491" class="Symbol">.</a><a id="5492" href="Haskell.Prim.Eq.html#453" class="Field Operator">_==_</a> <a id="5497" href="Peras.Block.html#5497" class="Bound">x</a> <a id="5499" href="Peras.Block.html#5499" class="Bound">y</a> <a id="5501" class="Symbol">=</a> <a id="5503" href="Peras.Block.html#3931" class="Field">blockHash</a> <a id="5513" href="Peras.Block.html#5497" class="Bound">x</a> <a id="5515" href="Haskell.Prim.Eq.html#453" class="Field Operator">==</a> <a id="5518" href="Peras.Block.html#3931" class="Field">blockHash</a> <a id="5528" href="Peras.Block.html#5499" class="Bound">y</a> <a id="5530" href="Haskell.Prim.Bool.html#138" class="Function Operator">&amp;&amp;</a> <a id="5533" href="Peras.Block.html#3964" class="Field">payload</a> <a id="5541" href="Peras.Block.html#5497" class="Bound">x</a> <a id="5543" href="Haskell.Prim.Eq.html#453" class="Field Operator">==</a> <a id="5546" href="Peras.Block.html#3964" class="Field">payload</a> <a id="5554" href="Peras.Block.html#5499" class="Bound">y</a>

<a id="5557" class="Keyword">module</a> <a id="5564" href="Peras.Block.html#5564" class="Module">_</a> <a id="5566" class="Symbol">{</a><a id="5567" href="Peras.Block.html#5567" class="Bound">a</a> <a id="5569" class="Symbol">:</a> <a id="5571" href="Agda.Primitive.html#388" class="Primitive">Set</a><a id="5574" class="Symbol">}</a> <a id="5576" class="Symbol">⦃</a> <a id="5578" href="Peras.Block.html#5578" class="Bound">_</a> <a id="5580" class="Symbol">:</a> <a id="5582" href="Peras.Crypto.html#1994" class="Record">Hashable</a> <a id="5591" href="Peras.Block.html#5567" class="Bound">a</a> <a id="5593" class="Symbol">⦄</a>
  <a id="5597" class="Keyword">where</a>

  <a id="5606" class="Keyword">open</a> <a id="5611" href="Peras.Crypto.html#1994" class="Module">Hashable</a> <a id="5620" class="Symbol">⦃...⦄</a>

  <a id="5629" href="Peras.Block.html#5629" class="Function">hashHead</a> <a id="5638" class="Symbol">:</a> <a id="5640" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="5645" href="Peras.Block.html#5567" class="Bound">a</a> <a id="5647" class="Symbol">→</a> <a id="5649" href="Peras.Crypto.html#1542" class="Record">Hash</a> <a id="5654" href="Peras.Block.html#5567" class="Bound">a</a>
  <a id="5658" href="Peras.Block.html#5629" class="Function">hashHead</a> <a id="5667" href="Agda.Builtin.List.html#184" class="InductiveConstructor">Data.List.[]</a> <a id="5680" class="Symbol">=</a> <a id="5682" href="Peras.Crypto.html#1583" class="InductiveConstructor">MkHash</a> <a id="5689" href="Peras.Crypto.html#676" class="Postulate">emptyBS</a>
  <a id="5699" href="Peras.Block.html#5629" class="Function">hashHead</a> <a id="5708" class="Symbol">(</a><a id="5709" href="Peras.Block.html#5709" class="Bound">x</a> <a id="5711" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">Data.List.∷</a> <a id="5723" class="Symbol">_)</a> <a id="5726" class="Symbol">=</a> <a id="5728" href="Peras.Crypto.html#2033" class="Field">hash</a> <a id="5733" href="Peras.Block.html#5709" class="Bound">x</a>

<a id="5736" class="Symbol">{-#</a> <a id="5740" class="Keyword">COMPILE</a> <a id="5748" class="Keyword">AGDA2HS</a> <a id="5756" href="Peras.Block.html#5629" class="Function">hashHead</a> <a id="5765" class="Symbol">#-}</a>

<a id="5770" class="Keyword">private</a>
  <a id="5780" class="Keyword">open</a> <a id="5785" href="Peras.Crypto.html#1994" class="Module">Hashable</a>

  <a id="5797" class="Keyword">instance</a>
    <a id="hashBlock"></a><a id="5810" href="Peras.Block.html#5810" class="Function">hashBlock</a> <a id="5820" class="Symbol">:</a> <a id="5822" href="Peras.Crypto.html#1994" class="Record">Hashable</a> <a id="5831" href="Peras.Block.html#2965" class="Record">Block</a>
    <a id="5841" href="Peras.Block.html#5810" class="Function">hashBlock</a> <a id="5851" class="Symbol">.</a><a id="5852" href="Peras.Crypto.html#2033" class="Field">hash</a> <a id="5857" class="Symbol">=</a> <a id="5859" href="Peras.Crypto.html#1583" class="InductiveConstructor">MkHash</a> <a id="5866" href="Function.Base.html#1115" class="Function Operator">∘</a> <a id="5868" href="Peras.Crypto.html#3171" class="Field">bytesS</a> <a id="5875" href="Function.Base.html#1115" class="Function Operator">∘</a> <a id="5877" href="Peras.Block.html#3566" class="Field">signature</a>
</pre>
<!--
<pre class="Agda"><a id="5905" class="Symbol">{-#</a> <a id="5909" class="Keyword">COMPILE</a> <a id="5917" class="Keyword">AGDA2HS</a> <a id="5925" href="Peras.Block.html#4797" class="Function">iCertificateEq</a> <a id="5940" class="Symbol">#-}</a>
<a id="5944" class="Symbol">{-#</a> <a id="5948" class="Keyword">COMPILE</a> <a id="5956" class="Keyword">AGDA2HS</a> <a id="5964" href="Peras.Block.html#4917" class="Function">iBlockEq</a> <a id="5973" class="Symbol">#-}</a>
<a id="5977" class="Symbol">{-#</a> <a id="5981" class="Keyword">COMPILE</a> <a id="5989" class="Keyword">AGDA2HS</a> <a id="5997" href="Peras.Block.html#5448" class="Function">iBlockBodyEq</a> <a id="6010" class="Symbol">#-}</a>

<a id="6015" class="Symbol">{-#</a> <a id="6019" class="Keyword">COMPILE</a> <a id="6027" class="Keyword">AGDA2HS</a> <a id="6035" href="Peras.Block.html#5810" class="Function">hashBlock</a> <a id="6045" class="Symbol">#-}</a>
</pre>-->
</body>
</html>
